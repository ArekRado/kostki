(self.webpackChunkkostki=self.webpackChunkkostki||[]).push([[179],{91:(t,e,n)=>{"use strict";n.d(e,{$z:()=>Wt,Ah:()=>$t});var r,a,o=n(385),i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},u=function(t,e){return e.find((function(e){return e.name===t}))};(a=r||(r={})).box="box",a.ai="ai",a.game="game";var c,s=function(t){var e,n,r=t.state,a=t.data,o=i(i({},r),{component:i(i({},r.component),(e={},e[a.name]=i(i({},r.component[a.name]),(n={},n[a.entity]=a,n)),e))}),c=u(a.name,r.system);return void 0===c||void 0!==r.component[a.name]&&void 0!==r.component[a.name][a.entity]?o:c.create({state:o,component:a})},f=function(t){var e=t.state,n=t.name,r=l({state:e,name:n});return r?Object.keys(r).reduce((function(t,e){return function(t){var e,n=t.name,r=t.entity,a=t.state,o=a.component[n],c=r,s=(o[c],function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]])}return n}(o,["symbol"==typeof c?c:c+""])),f=i(i({},a),{component:i(i({},a.component),(e={},e[n]=s,e))}),l=p({name:n,state:a,entity:r}),d=u(n,f.system);return d&&l?d.remove({state:f,component:l}):f}({name:n,entity:e,state:t})}),e):e},p=function(t){var e=t.name,n=t.entity,r=t.state.component[e];return r?r[n]:void 0},l=function(t){var e=t.name;return t.state.component[e]},d=function(){return(d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},y=function(t,e){for(var n=0,r=e.length,a=t.length;n<r;n++,a++)t[a]=e[n];return t};!function(t){t[t.last=3]="last",t[t.time=3]="time",t[t.io=2]="io",t[t.transform=1]="transform",t[t.zero=0]="zero",t[t.sprite=-1]="sprite",t[t.draw=-2]="draw"}(c||(c={}));var m,v=function(t){return t.state},g=function(t){var e=t.state,n=t.tick,r=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]])}return n}(t,["state","tick"]),a={name:r.name,priority:r.priority||c.zero,initialize:r.initialize||v,create:r.create||v,tick:function(t){var e=t.state,a=t.eventBuffer,o=e.component[r.name];return o?Object.values(o).reduce((function(t,e){var o=function(t){var e=t.entity,n=t.eventBuffer,r=t.state,a=t.eventHandler,o=t.component;return n[e]?n[e].reduce((function(t,n){if(a){var r=p({state:t,entity:e,name:o.name});return r?a({state:t,event:n,component:r}):t}return t}),r):r}({eventHandler:r.event,state:t,eventBuffer:a,entity:e.entity,component:e});return n?n({state:o,component:e}):o}),e):e},remove:r.remove||v,event:r.event||v};return d(d({},e),{system:y(y([],e.system),[a])})},h=function(){return(h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},b="first",x={},O={},w=function(t){"first"===b?(x[t.entity]||(x[t.entity]=[]),x[t.entity].push(t)):(O[t.entity]||(O[t.entity]=[]),O[t.entity].push(t))},T=function(){return(T=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};!function(t){t.Type||(t.Type={})}(m||(m={}));var E,P=function(t,e,n){return t&&t[n]?t[n][e]:void 0},A=0,I=10,C=-10,M=-5,k=-4,j=-15,B=50,V=0,S=1,R=2,q=7,L=-5,N=-4,Q=0,z=0;!function(t){t[t.less=-1]="less",t[t.equal=0]="equal",t[t.more=1]="more"}(E||(E={}));var G=function(t){var e=t.state,n=Rt({state:e});return n?n.grid.reduce((function(t,n){var a=p({name:r.box,state:e,entity:n});if(a){var o=a.gridPosition[0],i=a.gridPosition[1];t[o]||(t[o]=[]),t[o][i]=T(T({},a),{points:0})}return t}),[]):[]},U=function(t){var e=t.dataGrid,n=t.currentPlayer;return e.reduce((function(t,r,a){return t[a]=r.reduce((function(t,r,o){if(r.player!==n&&void 0!==r.player)return t;var i=[[P(e,o-1,a-1),P(e,o,a-1),P(e,o+1,a-1)],[P(e,o-1,a),P(e,o,a),P(e,o+1,a)],[P(e,o-1,a+1),P(e,o,a+1),P(e,o+1,a+1)]],u=function(t){var e=t[1][1];return function(t){return[t[1][0],t[0][1],t[1][2],t[2][1]]}(t).reduce((function(t,n){if(!n)return t+V;var r=e.dots===n.dots?E.equal:e.dots>n.dots?E.more:E.less;if(n.player!==e.player&&void 0!==n.player){if(r===E.more){var a=e.dots-n.dots;return t+A-a}if(r===E.equal)return t+I*e.dots;if(r===E.less)return a=n.dots-e.dots,t+C*a}else{if(6===e.dots)return t;if(r===E.more)return t+M;if(r===E.equal)return 6===n.dots&&6===e.dots?t+B:t+k;if(r===E.less)return 6===n.dots?t+2*j:t+j}return t}),0)}(i)+function(t){var e=t[1][1];return function(t){return[t[0][0],t[0][2],t[2][0],t[2][2]]}(t).reduce((function(t,n){if(!n)return t+z;var r=e.dots===n.dots?E.equal:e.dots>n.dots?E.more:E.less;if(n.player!==e.player&&void 0!==n.player){if(r===E.more)return t+S;if(r===E.equal)return 6===n.dots?t+-10*R:t+R;if(r===E.less)return 6===n.dots?t+2*q:t+q}else{if(6===e.dots)return t;if(r===E.more)return t+L;if(r===E.equal)return t+N;if(r===E.less){var a=n.dots-e.dots;return t+Q+Math.pow(a,2)}}return t}),0)}(i);return t[o]=T(T({},r),{points:r.points+u}),t}),r),t}),e)},D=function(t){var e=t.state,n=t.ai,r=t.preferEmptyBoxes,a=n.entity,o=G({state:e});return o=function(t){var e=t.dataGrid,n=t.preferEmptyBoxes;return e.reduce((function(t,e,r){return t[r]=e.reduce((function(t,e,r){var a=void 0===e.player,o=n?100:0,i=a?e.points+50+o:e.points;return t[r]=T(T({},e),{points:i}),t}),e),t}),e)}({dataGrid:o,preferEmptyBoxes:!!r}),function(t){var e=t.currentPlayer,n=-1/0,r=[];t.dataGrid.forEach((function(t){t.forEach((function(t){var a=void 0===t.player,o=t.player===e;(a||o)&&(t.points>n&&(r=[]),t.points>=n&&(n=t.points,r.push(t)))}))}));var a=Math.floor(Math.random()*r.length);return r[a]}({currentPlayer:a,dataGrid:o=U({currentPlayer:a,dataGrid:o})})};const _=n.p+"d0b02301cf22a066ce5efc6a4d353c4a.png",Y=n.p+"1199d81f91233c5b428d48edeb5efbde.png",H=n.p+"7e640f0339b663753965c7d2b518a274.png",K=n.p+"917ac946784d62fdf0c021cb3612fdb2.png",W=n.p+"48c6631e7335af8fe553f470b80d8976.png",F=n.p+"fece679ff0a36907324c646caf55dd8c.png",$=n.p+"5030d234d3163eca2b8f7a7b4ae5de38.png",J=n.p+"bf30000e751062d61a14f789ff98d211.png",X=n.p+"1e41fdc607aa7739e496651e94c33873.png",Z=n.p+"d949a0fcb5a3df6b7e925bb282a9864c.png",tt=n.p+"6ee0c3c39c0311cef85b1cfc79fd2d85.png",et=n.p+"f7a6779ba4f1319b9642eb3b4ef74086.png",nt=n.p+"705ac6c5ae5713f9343dc873dd267da9.png",rt=n.p+"e593bf10d8560f93d523ab53dd42ce63.png",at=n.p+"933225f4b538f8888ed03abca7494cf3.png",ot=n.p+"e79851835ce027cb15e2c56ff7feae3e.png",it=n.p+"9c92ec43dc64c4c4dd46e523b1abe290.png",ut=n.p+"0da7dc8ec0665e566165da248be0cad8.png",ct=n.p+"beaa728dd1d3231bd65c9c6bf7dfc03b.png",st=n.p+"988c7a2a62df78a626970c546a259442.png",ft=n.p+"a472a634acf5ccf35d372c70a802939c.png",pt=n.p+"caa6a8fe383b064d572ef15125f29b4b.png",lt=n.p+"708b5f6366bfce9801d51e2e2bc4ac5f.png",dt=n.p+"73eefd68fbb861657a80d7d35c158cca.png",yt=n.p+"f2d6950b7e5068555193493083288ae3.png";n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p,n.p;var mt,vt,gt=[_,Y,H,K,W,F,$],ht=[_,J,X,Z,tt,et,nt],bt=[_,rt,at,ot,it,ut,ct],xt=[_,st,ft,pt,lt,dt,yt],Ot=function(){return(Ot=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},wt=function(t,e){for(var n=0,r=e.length,a=t.length;n<r;n++,a++)t[a]=e[n];return t};!function(t){t[t.up=0]="up",t[t.down=1]="down",t[t.left=2]="left",t[t.right=3]="right"}(mt||(mt={})),function(t){var e;(e=t.Type||(t.Type={}))[e.onClick=0]="onClick",e[e.rotationEnd=1]="rotationEnd",e[e.rotate=2]="rotate"}(vt||(vt={}));var Tt,Et=function(t){return t>2*Math.PI||t<-2*Math.PI?-2*Math.PI:t},Pt=function(t){var e=t.state,n=t.ai,r=Rt({state:e});return(null==r?void 0:r.colorBlindMode)?n.textureSet:gt},At=function(t){var e=t.entity,n=t.state,r=Rt({state:n});return r?s({state:n,data:Ot(Ot({},r),{boxRotationQueue:wt(wt([],r.boxRotationQueue),[e])})}):n},It=function(t){var e=t.entity,n=t.animationEndCallback,r=(t.direction,t.color),a=t.texture,i=$t.getTransformNodeByUniqueId(parseInt(e));if(i){var u=o.Tools.ToRadians(90)*(Math.random()>.5?1:-1),c=Math.random()>.5?"x":"y",s=i.rotation,f=new o.Vector3("x"===c?u:0,"y"===c?u:0,0).add(s),p=new o.Vector3(Et(f.x),Et(f.y),Et(f.z)),l=new o.Animation("rotateAnimation","rotation",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),d=new o.AnimationEvent(.5,n,!0);l.addEvent(d);var y=[];y.push({frame:0,value:s}),y.push({frame:.5,value:p}),l.setKeys(y),i.animations[i.animations.length]=l,$t.beginAnimation(i,0,1,!1),i.getChildren().slice(0,-1).forEach((function(t){var e=$t.getMeshByUniqueId(t.uniqueId);e&&(e.material.diffuseColor=new o.Color3(r[0],r[1],r[2]),e.material.diffuseTexture=new o.Texture(a,$t))}))}},Ct=function(t){return 6===t?1:t+1},Mt=function(t){var e=t.state,n=t.ai,r=t.box,a=r.entity,o=r.dots;return n&&(o=Ct(r.dots),It({entity:a,animationEndCallback:function(){w({type:vt.Type.rotationEnd,entity:a,payload:{ai:n,shouldExplode:6===r.dots}})},texture:Pt({state:e,ai:n})[o],color:n.color}),e=At({entity:a,state:e})),s({state:e,data:Ot(Ot({},r),{isAnimating:!0,player:(null==n?void 0:n.entity)||"",dots:o})})},kt=function(t){var e=t.boxEntity,n=t.texture,r=t.color,a=$t.getTransformNodeByUniqueId(parseInt(e));a&&(a.rotation.x=0,a.rotation.y=0,a.getChildren().forEach((function(t){var e=$t.getMeshByUniqueId(t.uniqueId);e&&(e.material.diffuseColor=new o.Color3(r[0],r[1],r[2]),e.material.diffuseTexture=new o.Texture(n,$t))})))},jt=function(){return(jt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Bt="game";!function(t){var e;(e=t.Type||(t.Type={}))[e.startLevel=0]="startLevel",e[e.nextTurn=1]="nextTurn",e[e.boxExplosion=2]="boxExplosion",e[e.playerClick=3]="playerClick"}(Tt||(Tt={}));var Vt,St=function(t){var e=t.boxEntity,n=t.markerEntity,r=t.color,a=$t.getTransformNodeByUniqueId(parseInt(e)),i=$t.getMeshByUniqueId(parseInt(n));i&&a&&(i.material.diffuseColor=new o.Color3(r[0],r[1],r[2]),i.position=new o.Vector3(a.position.x,a.position.y,a.position.z-1),$t.beginAnimation(i,0,1,!1))},Rt=function(t){var e=t.state;return p({state:e,entity:Bt,name:r.game})},qt=function(t){var e=t.playersQueue,n=t.index,a=t.state,o=p({state:a,name:r.ai,entity:e[n]});return(null==o?void 0:o.active)?o:qt({playersQueue:e,index:n>=e.length?0:n+1,state:a})},Lt=function(t){var e=t.state,n=Rt({state:e});if(n){var r=n.playersQueue.findIndex((function(t){return n.currentPlayer===t}));return qt({playersQueue:n.playersQueue,index:r+1,state:e})}},Nt=function(t,e){var n=function(t){var e=t.getEngine().getRenderingCanvasClientRect();return null!==e?e.height/e.width:1}(e),r=e.activeCamera;r&&(n>1?(r.orthoLeft=-t,r.orthoRight=t,r.orthoBottom=r.orthoLeft*n,r.orthoTop=r.orthoRight*n):(r.orthoBottom=-t,r.orthoTop=t,r.orthoLeft=r.orthoBottom/n,r.orthoRight=r.orthoTop/n))},Qt=function(){return(Qt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},zt=function(t){var e=1.2*t[0].length,n=1.2*t.length;return{center:[(e-1-.2)/2,(n-1-.2)/2],cameraDistance:(e>n?e:n)/2+.2}},Gt=function(){return(Gt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Ut={entity:{},component:(Vt={},Vt[r.box]={},Vt[r.ai]={},Vt[r.game]={},Vt),system:[]},Dt=Ut=function(t){return g({state:t,name:r.game,event:function(t){var e=t.state,n=t.component,a=t.event;switch(a.type){case Tt.Type.startLevel:return function(t){var e=t.state,n=t.component,a=n.currentPlayer,o=(n.grid,n.quickStart),i=p({name:r.ai,state:e,entity:a});if(!i)return e;if(e=s({state:e,data:jt(jt({},n),{gameStarted:!0,currentPlayer:i.entity})}),o&&function(t){var e=t.state,n=Rt({state:e});n&&n.grid.forEach((function(t){var n=p({state:e,entity:t,name:r.box}),a=p({state:e,entity:(null==n?void 0:n.player)||"",name:r.ai});n&&a&&w({type:vt.Type.rotate,entity:t,payload:{color:a.color,texture:Pt({state:e,ai:a})[n.dots],direction:mt.up}})}))}({state:e=function(t){var e,n=t.state;return(null===(e=Rt({state:n}))||void 0===e?void 0:e.grid.reduce((function(t){var e=Rt({state:t}),n=p({state:t,name:r.ai,entity:(null==e?void 0:e.currentPlayer)||""});if(!e||!n)return t;var a=D({state:t,ai:n,preferEmptyBoxes:!0});if(!a)return t;t=s({state:t,data:jt(jt({},a),{player:n.entity,dots:Ct(a.dots)})});var o=Lt({state:t});return o?t=s({state:t,data:jt(jt({},e),{currentPlayer:o.entity})}):t}),n))||n}({state:e})}),e=s({state:e,data:jt(jt({},n),{gameStarted:!0,currentPlayer:i.entity})}),!i.human){var u=D({state:e,ai:i});u&&(e=Mt({box:u,state:e,ai:i}))}return e}({state:e,component:n,event:a});case Tt.Type.nextTurn:return function(t){var e=t.state,n=t.component,a=n.gameStarted,o=n.boxRotationQueue;if(a&&0===o.length){var i=Lt({state:e});if(!i)return e;var u=p({name:r.ai,state:e,entity:i.entity});if(!u)return e;if(e=s({state:e,data:jt(jt({},n),{currentPlayer:u.entity})}),!u.human&&u.active){var c=D({state:e,ai:u});if(!c)return function(t){var e=t.state,n=t.ai,a=t.component;e=s({state:e,data:jt(jt({},n),{active:!1})});var o=l({state:e,name:r.ai});return 1===Object.values(o||{}).reduce((function(t,e){return e.active?t+1:t}),0)?s({state:e,data:jt(jt({},a),{gameStarted:!1})}):(w({type:Tt.Type.nextTurn,entity:Bt,payload:{ai:n}}),e)}({state:e,component:n,ai:u});St({boxEntity:c.entity,color:u.color,markerEntity:n.markerEntity}),e=Mt({box:c,state:e,ai:u}),e=At({state:e,entity:c.entity})}}return e}({state:e,component:n,event:a});case Tt.Type.playerClick:return function(t){var e=t.state,n=t.component,a=t.event,o=n.currentPlayer,i=n.gameStarted,u=n.boxRotationQueue,c=p({state:e,name:r.box,entity:a.payload.boxEntity}),s=void 0===(null==c?void 0:c.player)||(null==c?void 0:c.player)===o;if(i&&0===u.length&&s){var f=p({name:r.ai,state:e,entity:o});c&&(null==f?void 0:f.human)&&(St({boxEntity:c.entity,color:f.color,markerEntity:n.markerEntity}),e=Mt({box:c,state:e,ai:f}))}return e}({state:e,component:n,event:a})}}})}(Ut=function(t){return g({state:t,name:r.ai,create:function(t){var e=t.component,n=t.state;return e.textureSet.forEach((function(t){(new Image).src=t})),n}})}(Ut=function(t){return g({state:t,name:r.box,create:function(t){return t.state},event:function(t){var e=t.state,n=t.component,r=t.event;switch(r.type){case vt.Type.rotationEnd:return function(t){var e=t.state,n=t.component,r=t.event.payload,a=r.ai,o=r.shouldExplode;e=function(t){var e=t.entity,n=t.state,r=Rt({state:n});return r?s({state:n,data:Ot(Ot({},r),{boxRotationQueue:r.boxRotationQueue.filter((function(t){return t!==e}))})}):n}({entity:n.entity,state:e}),kt({boxEntity:n.entity,texture:Pt({state:e,ai:a})[n.dots],color:a.color});var i=Rt({state:e});if(!i)return e;o?e=function(t){var e=t.state,n=t.ai,r=t.box.gridPosition,a=r[0],o=r[1],i=G({state:e});return[P(i,o,a-1),P(i,o,a+1),P(i,o-1,a),P(i,o+1,a)].filter((function(t){return void 0!==t})).reduce((function(t,e,r){return t=Mt({ai:n,box:e,state:t}),At({entity:e.entity,state:t})}),e)}({state:e,box:n,ai:a}):0===i.boxRotationQueue.length&&w({type:Tt.Type.nextTurn,entity:Bt,payload:{ai:a}});var u=$t.getTransformNodeByUniqueId(parseInt(n.entity));return u&&(u.animations=[]),s({state:e,data:Ot(Ot({},n),{isAnimating:!1})})}({state:e,component:n,event:r});case vt.Type.rotate:return function(t){var e=t.state,n=t.component,r=t.event;return It({entity:n.entity,animationEndCallback:function(){kt({boxEntity:n.entity,texture:r.payload.texture,color:r.payload.color})},texture:r.payload.texture,color:r.payload.color}),e}({state:e,component:n,event:r})}}})}(Ut))),_t=function(){return(_t=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};const Yt=n.p+"a9e5de2dd68bd2d03d16525655ad7a8b.png";var Ht=function(){return(Ht=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Kt=document.getElementById("game"),Wt="humanPlayer",Ft=new o.Engine(Kt,!0,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1}),$t=new o.Scene(Ft);Ft.runRenderLoop((function(){$t&&$t.activeCamera&&$t.render()}));var Jt=new o.UniversalCamera("UniversalCamera",new o.Vector3(0,0,-1),$t);Jt.mode=o.Camera.ORTHOGRAPHIC_CAMERA;var Xt=new o.HemisphericLight("light",new o.Vector3(0,0,1),$t);Xt.intensity=1,Xt.diffuse=new BABYLON.Color3(1,1,1),Xt.specular=new BABYLON.Color3(1,1,1),Xt.groundColor=new BABYLON.Color3(1,1,1);var Zt=function(t){void 0===t&&(t={game:{}});var e=s({state:Dt,data:{entity:Wt,name:r.ai,human:!0,level:0,color:[0,0,1],textureSet:["","","","","","",""],active:!0}});return s({state:e,data:_t({entity:Bt,name:r.game,grid:[],round:0,currentPlayer:Wt,gameStarted:!1,playersQueue:[],boxRotationQueue:[],quickStart:!1,colorBlindMode:!1,markerEntity:""},null==t?void 0:t.game)})}({game:{quickStart:!0}}),te=Array.from({length:7}).map((function(){return Array.from({length:7}).map((function(){return{player:void 0,dots:0}}))})),ee=function(t,e,n,a){return void 0===a&&(a=!1),{entity:t,name:r.ai,human:a,level:1,color:e,textureSet:n,active:!0}};Zt=function(t){var e=t.state,n=t.ai;e=f({state:e,name:r.ai});var a=Rt({state:e});return a&&(e=s({state:e,data:Gt(Gt({},a),{playersQueue:n.map((function(t){return t.entity}))})})),n.reduce((function(t,e){return s({state:t,data:e})}),e)}({state:Zt=function(t){var e=t.dataGrid,n=t.scene,a=t.camera,i=t.state,u=new o.TransformNode("grid"),c=zt(e),f=c.center,p=c.cameraDistance;a.position.x=f[1],a.position.y=f[0],a.position.z=-10,a.setTarget(new o.Vector3(f[1],f[0])),Nt(p,n);var l=[];i=e.reduce((function(t,e,a){return e.reduce((function(t,e,i){var c=e.dots,f=e.player,p=function(t){var e=t.scene,n=t.name,r=new o.TransformNode("box "+n,e);return[[new o.Vector3(-.5,0,0),new o.Vector3(0,Math.PI/2,0)],[new o.Vector3(0,0,.5),new o.Vector3(0,Math.PI,0)],[new o.Vector3(.5,0,0),new o.Vector3(0,-Math.PI/2,0)],[new o.Vector3(0,.5,0),new o.Vector3(Math.PI/2,0,0)],[new o.Vector3(0,-.5,0),new o.Vector3(-Math.PI/2,0,0)],[new o.Vector3(0,0,-.5),new o.Vector3(0,0,0)]].forEach((function(t,n){var a=t[0],i=t[1],u=o.Mesh.CreatePlane("plane"+n,1,e,!0);u.parent=r,u.material=new o.StandardMaterial("mat",e),u.material.diffuseColor=o.Color3.White(),u.material.diffuseTexture=new o.Texture(_,e),u.material.alpha=1,u.position=a,u.rotation=i,u.setParent(r),u.actionManager=new o.ActionManager(e),u.actionManager.registerAction(new o.ExecuteCodeAction(o.ActionManager.OnPickUpTrigger,(function(){w({entity:Bt,type:Tt.Type.playerClick,payload:{boxEntity:r.uniqueId.toString()}})})))})),r}({scene:n,name:a+"-"+i});p.position.x=1.2*a,p.position.y=1.2*i,p.setParent(u);var d=p.uniqueId.toString();return l.push(d),s({state:t,data:{name:r.box,entity:d,isAnimating:!1,dots:c,gridPosition:[a,i],player:f}})}),t)}),i);var d=Rt({state:i});return d?i=s({state:i,data:Qt(Qt({},d),{grid:l})}):i}({dataGrid:te,scene:$t,camera:Jt,state:Zt}),ai:[ee(Wt,[.09,.84,1],gt,!0),ee("2",[.99,.42,.45],ht),ee("3",[.11,.79,.29],bt),ee("4",[.99,.97,.32],xt)]}),Zt=function(t){var e,n,r=t.scene,a=t.state,i=o.Mesh.CreatePlane("marker",1.4,r,!0);i.position=new o.Vector3(9999,9999,9999),i.material=new o.StandardMaterial("material",r),i.material.useAlphaFromDiffuseTexture=!0,i.material.diffuseColor=o.Color3.White(),i.material.diffuseTexture=new o.Texture(Yt,r),i.material.diffuseTexture.hasAlpha=!0,i.animations[0]=(e=new o.Animation("getScaleAnimation","scaling",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),(n=[]).push({frame:0,value:new o.Vector3(2,2,1)}),n.push({frame:.5,value:new o.Vector3(.9,.9,1)}),e.setKeys(n),e),i.animations[1]=function(){var t=new o.Animation("getAlphaAnimation","material.alpha",1,o.Animation.ANIMATIONTYPE_FLOAT,o.Animation.ANIMATIONLOOPMODE_RELATIVE),e=[];return e.push({frame:0,value:0}),e.push({frame:.5,value:1}),t.setKeys(e),t}();var u=Rt({state:a});return u?s({state:a,data:Ht(Ht({},u),{markerEntity:i.uniqueId.toString()})}):a}({scene:$t,state:Zt}),$t.registerBeforeRender((function(){Zt=function(t){var e=t.state;b="second",O={};var n=e.system.concat().sort((function(t,e){return t>e?-1:1})).reduce((function(t,e){return e.tick({state:t,eventBuffer:x})}),e);return x={},b="first",x=h({},O),n}({state:Zt})})),window.addEventListener("resize",(function(){Nt(zt(G({state:Zt})).cameraDistance,$t),setTimeout((function(){Ft.resize()}),1e3)})),w({type:Tt.Type.startLevel,entity:Bt,payload:{}})}},t=>{"use strict";t.O(0,[216],(()=>(91,t(t.s=91)))),t.O()}]);