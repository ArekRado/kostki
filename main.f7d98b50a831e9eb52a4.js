"use strict";(self.webpackChunkkostki=self.webpackChunkkostki||[]).push([[179],{8502:(e,t,a)=>{a.d(t,{$:()=>Vo});var o=a(1361);let r,n,s,l,d,i;var p;(p=r||(r={})).box="box",p.ai="ai",p.game="game",p.marker="marker",p.background="background",p.logo="logo",p.gameMap="gameMap",p.tutorial="tutorial",function(e){e.mainMenu="mainMenu",e.customLevel="customLevel",e.customLevelSettings="customLevelSettings"}(n||(n={})),function(e){e.mainMenu="mainMenu",e.campaignLevel="campaignLevel",e.campaignLevelSelect="campaignLevelSelect",e.customLevel="customLevel",e.customLevelSettings="customLevelSettings"}(s||(s={})),function(e){e.easy="customLevelSettings easy",e.medium="customLevelSettings medium",e.hard="customLevelSettings hard",e.random="customLevelSettings random"}(l||(l={})),function(e){e.disabled="disabled",e.random="random",e.easy="easy",e.medium="medium",e.hard="hard"}(d||(d={})),function(e){e[e.less=-1]="less",e[e.equal=0]="equal",e[e.more=1]="more"}(i||(i={}));var y=a(7455),c=a(5559),u=a(9228),m=a(5431),g=a(4357);const v={},f=({textureUrl:e,scene:t})=>{const a=new g.x(e,t,void 0,void 0,g.x.NEAREST_NEAREST_MIPLINEAR);return v[e]=a,a},h=a.p+"57365b6b32a38acad399fa24be970b62.png",b=a.p+"86711768640182ba9774e66c59e43713.png",x=a.p+"d5fd50f6577249e4bd0a6cedc07b855c.png",E=a.p+"1cece826ef3290f02e8ab121defa70e5.png",w=a.p+"04486ea103fd49156ce128e43c00f4af.png",T=a.p+"4c8888485f10730f523694c6ac7449e4.png",C=a.p+"3bb45fa09a5eb9cd805c7f32aab31591.png",M=a.p+"289b33e3a3e1c125f813747944282bbb.png",k=a.p+"e7015b6db11decc2aa7f722b6eaaa343.png",L=a.p+"7e6aabd8e3d92edca81c0207761816f0.png",S=a.p+"1a202abfbdfbb945f566e890f0e0fa7f.png",P=a.p+"ad7c3be816ce34c76152ecc6c61d263b.png",I=a.p+"8711d0d55135c6a04bf3e76aa6287504.png",R=a.p+"717e6eb5fb82bedfc88f6dc0c65b6f12.png",B=a.p+"16c7f9cc6c2acada16547b3befe94a91.png",j=a.p+"2d2b2519ce6d9ed0c93cd7ed21aed043.png",q=a.p+"7fa7abdc3e479f97ee5f6b283630df03.png",K=a.p+"f3941c38549dddc4a8cb586591e36996.png",N=a.p+"62bd7e3778d77e5ca308fcb5f4b0da78.png",A=a.p+"2f30a46bdc58014e8ba857f895bbe5b8.png",O=a.p+"de0b87223c2e5708366657b7da01c941.png",$=a.p+"54b2699e76fca159c5797b2b93b10bd4.png",U=a.p+"3d713800c02422e02fe02e70f53e9771.png",G=a.p+"2f9682e3f7d362cc3087ef4dcbbdfd2b.png",W=a.p+"62f6adca2ae3c6e088aac66bc47cb54e.png",F=a.p+"9bb2d886948bbd78603ec224904774fd.png",D=a.p+"2d9f8ec02b7087dc45bf61208aacf7a8.png",z=a.p+"4fd5888696b352601fd6c1f7a1420e1f.png",X=a.p+"d62f41f971620bf90529571efed25c8e.png",Q=a.p+"2c7434786497b8ccb02757089a53015a.png",Y=a.p+"51f16b6b18086fcc295f8bc02e6c8c45.png",H=a.p+"0dfd6a6b5e5120be13c81ddc1d84a1df.png",J=a.p+"301a367840edef78b86808852d0c067e.png",V=a.p+"d854a7c9f810ebe5be07e17990bd0ee4.png",_=a.p+"777079c111d24a4a0402f5afbc95b175.png",Z=a.p+"e1b39772fd20282e80743b1f04be6795.png",ee=a.p+"24075b75ce25b7869e6559cccca76b75.png",te=a.p+"698b6e6ce4fcc13dd8ac2cdb9bb484fe.png",ae=a.p+"38ca2b18556222743ee8778742514d73.png",oe=a.p+"aebe569c1bf5190e0038b7098791359c.png",re=a.p+"d1390ce752b5ee52126d21de796a81f8.png",ne=a.p+"d54421100963619575d7b3f35876fdfe.png",se=a.p+"cde379b0a92320968a3826f29eff20fc.png",le=a.p+"d1b88dc4aa017270afbb48ce8c2d93ee.png",de=a.p+"f07f0db4072406727dc668f8f643b725.png",ie=a.p+"f60fcf550b1112ec6a6bb8c80cc4b142.png",pe=a.p+"5fded717b6adc588c2dcdedd900f3bea.png",ye=a.p+"ed032e786ebb26ea79c773fd85684876.png",ce=a.p+"7960efbc05f46d226a4e232b391a79ea.png",ue=[h,b,x,E,w,T,C],me=[h,M,k,L,S,P,I],ge=[h,R,B,j,q,K,N],ve=[h,A,O,$,U,G,W],fe=[h,F,D,z,X,Q,Y],he=[h,H,J,V,_,Z,ee],be=[h,te,ae,oe,re,ne,se],xe=[h,le,de,ie,pe,ye,ce],Ee=({state:e})=>{const t=e.babylonjs.sceneRef;return t?((e=>{setTimeout((()=>{ue.forEach((t=>{const a=new Image;a.src=t,a.onload=()=>{f({textureUrl:t,scene:e})}}))}),2e3*Math.random()+1e3)})(t),e):e},we="game";let Te;!function(e){let t;!function(e){e.startCustomLevel="GameEvent-startCustomLevel",e.boxExplosion="GameEvent-boxExplosion",e.playerClick="GameEvent-playerClick",e.cleanScene="GameEvent-cleanScene",e.shakeAiBoxes="GameEvent-shakeAiBoxes",e.playAgainCustomLevel="GameEvent-playAgainCustomLevel",e.changePlayers="GameEvent-changePlayers",e.changeDifficulty="GameEvent-changeDifficulty",e.changeQuickStart="GameEvent-changeQuickStart",e.changeColorBlindMode="GameEvent-changeColorBlindMode",e.changeMapType="GameEvent-changeMapType",e.startCampaignLevel="GameEvent-startCampaignLevel"}(t||(t={})),e.Type=t}(Te||(Te={}));const Ce=(0,m.o)({entity:we,name:r.game}),Me=Ce.getComponent,ke=Ce.setComponent;var Le=a(2922);const Se=({mesh:e,texture:t,scene:a,color:o})=>{o&&(e.material.diffuseColor=new Le.Wo(o[0],o[1],o[2]));const r=(({textureUrl:e,scene:t})=>v[e]?v[e]:f({textureUrl:e,scene:t}))({textureUrl:t,scene:a});return e.material.diffuseTexture=r,r},Pe=({state:e,ai:t})=>{const a=Me({state:e});return t&&null!=a&&a.colorBlindMode?t.textureSet:ue};var Ie=a(4179),Re=a(5412),Be=a(5367),je=a(4510),qe=a(8125),Ke=a(9798),Ne=a(3052);const Ae=1.2,Oe=({state:e,component:t})=>{const a=e.babylonjs.sceneRef;if(!a)return e;const{gridPosition:o}=t,n=(0,y.X)({state:e,name:r.ai,entity:t.player||""});return e=(0,c.L)({state:e,data:{name:u.f.transform,entity:t.entity,rotation:[0,0,0],fromParentRotation:[0,0,0],scale:[1,1,1],fromParentScale:[1,1,1],position:[o[0]*Ae,o[1]*Ae],fromParentPosition:[0,0]}}),(({scene:e,name:t,uniqueId:a,color:o,state:r,ai:n,dots:s,isClickable:l,scaleFactor:d=1})=>{const i=1/d,p=new Ie.Y(`box ${t}`,e);p.uniqueId=a,[[new Re.P(0,0,-i/2),new Re.P(0,0,0)],[new Re.P(-i/2,0,0),new Re.P(0,Math.PI/2,0)],[new Re.P(0,0,i/2),new Re.P(0,Math.PI,0)],[new Re.P(i/2,0,0),new Re.P(0,-Math.PI/2,0)],[new Re.P(0,i/2,0),new Re.P(Math.PI/2,0,0)],[new Re.P(0,-i/2,0),new Re.P(-Math.PI/2,0,0)]].forEach((([t,d],y)=>{const c=je.V.CreatePlane("plane"+y.toString(),{size:i});c.parent=p,c.material=new Be.K("mat",e),Se({mesh:c,color:o,texture:Pe({state:r,ai:n})[s],scene:e}),c.material.alpha=1,c.position=t,c.rotation=d,l&&(c.actionManager=new qe.k(e),c.actionManager.registerAction(new Ke.fQ(qe.k.OnPickUpTrigger,(()=>{(0,Ne.Kn)({type:Te.Type.playerClick,payload:{boxEntity:a.toString()}})}))))}))})({scene:a,name:`${o[0]}-${o[1]}`,uniqueId:parseFloat(t.entity),color:[1,1,1],ai:n,dots:0,state:e,isClickable:!0}),e},$e=({state:e,component:t})=>{if(e.babylonjs.sceneRef){const a=e.babylonjs.sceneRef.getTransformNodeByUniqueId(parseInt(t.entity));null==a||a.dispose()}return e};let Ue,Ge;!function(e){e.up="up",e.down="down",e.left="left",e.right="right",e.random="random"}(Ue||(Ue={})),function(e){let t;!function(e){e.onClick="BoxEvent-onClick",e.rotationEnd="BoxEvent-rotationEnd",e.rotateStart="BoxEvent-rotate"}(t||(t={})),e.Type=t}(Ge||(Ge={}));const We=a.p+"de1ab0613214552916d369d2014d1d95.png";var Fe=a(2646),De=a(8141),ze=a(4281);const Xe=()=>Math.floor(1e17*Math.random());var Qe=a(8375);const Ye=e=>e>2*Math.PI||e<-2*Math.PI?-2*Math.PI:e,He=Math.PI/2,Je=({boxUniqueId:e,direction:t=Ue.random,color:a,texture:o,state:n,nextTurn:s,shouldExplode:l})=>{const d=n.babylonjs.sceneRef;if(!d)return n;const i=d.getTransformNodeByUniqueId(parseInt(e));if(i){n=(0,Qe.K)({state:n,name:r.box,entity:e,update:e=>({...e,isAnimating:!0})});let p=He*(Math.random()>.5?1:-1),y=Math.random()>.5?"x":"y";switch(t){case Ue.down:p=-1*He,y="x";break;case Ue.up:p=1*He,y="x";break;case Ue.right:p=-1*He,y="y";break;case Ue.left:p=1*He,y="y";break;case Ue.random:p=He*(Math.random()>.5?1:-1),y=Math.random()>.5?"x":"y"}i.rotation.z=0;const m=[i.rotation.x,i.rotation.y,i.rotation.z],g=["x"===y?p:0,"y"===y?p:0,m[2]],v=[Ye(g[0]+m[0]),Ye(g[1]+m[1]),Ye(g[2]+m[2])],f={type:Ge.Type.rotationEnd,payload:{boxEntity:e,texture:o,color:a,nextTurn:s,shouldExplode:l}};n=(0,c.L)({state:n,data:{name:u.f.animation,entity:e,isPlaying:!0,isFinished:!1,currentTime:0,deleteWhenFinished:!0,wrapMode:Fe.f.WrapMode.once,timingMode:Fe.f.TimingMode.smooth,properties:[{path:"rotation",component:u.f.transform,entity:e,keyframes:[{duration:500,timingFunction:"Linear",valueRange:[m,v],endFrameEvent:f}]}]}});const h=i.getChildren();h.slice(1,h.length).forEach((e=>{const t=d.getMeshByUniqueId(e.uniqueId);t&&Se({mesh:t,color:a,texture:o,scene:d})}))}return n},Ve="38127445920450264";let _e;!function(e){let t;!function(e){e.appearAnimationEnd="MarkerEvent-appearAnimationEnd"}(t||(t={})),e.Type=t}(_e||(_e={}));const Ze=(0,m.o)({entity:Ve,name:r.marker}),et=(Ze.getComponent,({state:e,data:t})=>{e=(0,Qe.K)({state:e,name:u.f.material,entity:Ve,update:e=>({diffuseColor:t.color?[t.color[0],t.color[1],t.color[2],0]:e.diffuseColor})}),e=(0,Qe.K)({state:e,entity:Ve,name:u.f.transform,update:e=>({position:t.position?[t.position[0],t.position[1],-1]:e.position})});const a={type:_e.Type.appearAnimationEnd,payload:null};return e=(0,c.L)({state:e,data:{name:u.f.animation,entity:Ve,deleteWhenFinished:!0,isPlaying:!0,isFinished:!1,currentTime:0,wrapMode:Fe.f.WrapMode.once,timingMode:Fe.f.TimingMode.smooth,properties:[{path:"scale",component:u.f.transform,entity:Ve,keyframes:[{duration:400,timingFunction:"Linear",valueRange:[[2,2,1],[.9,.9,1]],endFrameEvent:a}]},{path:"alpha",component:u.f.material,entity:Ve,keyframes:[{duration:400,timingFunction:"Linear",valueRange:[0,1]}]}]}}),Ze.setComponent({state:e,data:t})}),tt=[[1,0,0,1,0,0,1,1,0,0,0,1,1,0,1,1,1,0,1,0,0,1,0,1],[1,0,1,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,1,0,1,0,0,1],[1,1,0,0,0,1,0,0,1,0,1,1,1,0,0,1,0,0,1,1,0,0,0,1],[1,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0,1],[1,0,0,1,0,0,1,1,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,1]].reduce(((e,t,a)=>(e[a]=t.reduce(((e,t,a)=>{if(0===t)e[a]="";else{const t=Xe().toString();e[a]=t}return e}),[]),e)),[]);var at=a(9779),ot=a(2817);const rt=({percentage:e,total:t})=>t*e,nt=({state:e,data:t})=>{const a=(0,ot.bp)({state:e});return(({state:e})=>{const t=(0,ot.bp)({state:e});if(!t)return e;const{topEdge:a,boxSize:o,screenSize:r}=(({state:e,boxScaleFactor:t})=>{const a=(0,ot.bp)({state:e});return a?{leftEdge:a.position[0]+a.left,topEdge:a.position[1]+a.top,boxSize:Ae/t,screenSize:[2*a.right,2*a.top]}:{leftEdge:0,topEdge:0,boxSize:0,screenSize:[0,0]}})({state:e,boxScaleFactor:3.2}),n=[tt[0].length*o,tt.length*o],s=[t.position[0]-n[0]/2,a-rt({total:r[1],percentage:.1})];return tt.reduce(((e,t,a)=>t.reduce(((e,t,r)=>{if(""===t)return e;const n=[s[0]+r*o,s[1]+-a*o];return(0,Qe.K)({state:e,name:u.f.transform,entity:t,update:()=>({position:[n[0],n[1]],scale:[.3125,.3125,.3125]})})}),e)),e)})({state:e=(0,ot.GR)({state:e,data:{...a,...t}})})},st=({state:e})=>e.babylonjs.sceneRef?(e=tt.reduce(((e,t,a)=>t.reduce(((e,t,o)=>""===t?e:(e=(0,at.J)({state:e,entity:t}),(0,c.L)({state:e,data:{name:r.box,entity:t,isAnimating:!1,dots:0,gridPosition:[o,a],player:""}}))),e)),e),e=nt({state:e,data:{}}),(0,Ne.Kn)({type:it.Type.rotateRandomLogoBox,payload:null}),e):e,lt=({state:e})=>{const t=e.babylonjs.sceneRef;return t?e=tt.flat().reduce(((e,a)=>{const o=t.getTransformNodeByUniqueId(parseFloat(a));return null==o||o.dispose(),(0,ze.S)({state:e,entity:a})}),e):e},dt="8523773494048061";let it;!function(e){let t;!function(e){e.rotateRandomLogoBox="LogoEvent-rotateRandomLogoBox"}(t||(t={})),e.Type=t}(it||(it={}));var pt=a(9655);const yt=(e,t)=>{document.dispatchEvent(new CustomEvent(e,{detail:t}))},ct=({state:e,name:t})=>{const a=(0,pt.C)({state:e,name:t});return a?Object.keys(a).reduce(((e,t)=>(0,ze.S)({state:e,entity:t})),e):e},ut=({state:e,event:t})=>(e=ke({state:e,data:{page:t.payload.newPage,turn:0,grid:[],currentPlayer:"",playersQueue:[],boxRotationQueue:[],gameStarted:!1}}),e=ct({name:r.box,state:e}),e=ct({name:r.ai,state:e}),e=ct({name:r.marker,state:e}),e=ct({name:r.background,state:e}),e=ct({name:r.logo,state:e}),e=ct({name:r.tutorial,state:e}),e=mt({state:e,page:t.payload.newPage}),yt("setUIState",e),e),mt=({state:e,page:t})=>(t===s.mainMenu&&(e=(0,Qe.K)({state:e,entity:ot.lw,name:u.f.camera,update:()=>({position:[0,0],distance:5})}),e=(0,at.J)({state:e,entity:dt}),e=(0,c.L)({state:e,data:{entity:dt,name:r.logo}})),e),gt=a.p+"48ac24087a2220449aefd17447f54715.png",vt="tutorial",ft=Xe().toString();let ht;!function(e){let t;!function(e){e.appearAnimationEnd="MarkerEvent-appearAnimationEnd"}(t||(t={})),e.Type=t}(ht||(ht={}));const bt=({value:e,min:t,max:a})=>e<=t?t:e>=a?a:e,xt=(e,t,a)=>(a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e),Et=[1,1,1],wt=[.6,.6,.6],Tt=[.11,.79,.29],Ct=[.09,.84,1],Mt=[1,.73,.29],kt=[.99,.97,.32],Lt=[.99,.42,.45],St=[.99,.47,.94],Pt=[.67,.23,.94],It=(e,t)=>e+Math.random()*t-Math.random()*t,Rt=e=>{const t=(([e,t,a])=>{const o=Math.max(e,t,a),r=Math.min(e,t,a);let n,s;const l=(o+r)/2;if(o==r)n=s=0;else{const d=o-r;switch(s=l>.5?d/(2-o-r):d/(o+r),o){case e:n=(t-a)/d+(t<a?6:0);break;case t:n=(a-e)/d+2;break;case a:n=(e-t)/d+4}n/=6}return[n,s,l]})(e),a=[t[0],bt({value:It(t[1],.2),min:.3,max:1}),bt({value:It(t[2],.2),min:.3,max:.7})];return(([e,t,a])=>{let o,r,n;if(0==t)o=r=n=a;else{const s=a<.5?a*(1+t):a+t-a*t,l=2*a-s;o=xt(l,s,e+1/3),r=xt(l,s,e),n=xt(l,s,e-1/3)}return[o,r,n]})([a[0],a[1],a[2]])},Bt=e=>[Rt(e),Rt(e),Rt(e),Rt(e),Rt(e),Rt(e),Rt(e),Rt(e),Rt(e),Rt(e)],jt=(Bt(wt),Bt(Tt),Bt(Ct),Bt(Mt),Bt(kt),Bt(Lt),Bt(St),Bt(Pt),(e,t,a,o=!1,n=d.easy)=>({entity:e,name:r.ai,human:o,level:n,color:t,textureSet:a,active:!0})),qt=()=>[jt(Vo,Ct,ue,!0,d.easy),jt("2",Lt,me,!1,d.easy),jt("3",Tt,ge,!1,d.easy),jt("4",kt,ve,!1,d.easy),jt("5",Mt,fe,!1,d.easy),jt("6",St,he,!1,d.easy),jt("7",wt,be,!1,d.easy),jt("8",Pt,xe,!1,d.easy)],Kt="localDbKey",Nt=e=>{const t=Me({state:e}),a=Object.values((0,pt.C)({name:r.gameMap,state:e})??{});t&&At({unlockedCampaignMapEntities:a.reduce(((e,{entity:t,locked:a})=>a?e:[...e,t]),[]),players:t.customLevelSettings.players,difficulty:t.customLevelSettings.difficulty,quickStart:t.customLevelSettings.quickStart,mapEntity:t.customLevelSettings.mapEntity,colorBlindMode:t.colorBlindMode,version:t.version})},At=e=>{localStorage.setItem(Kt,JSON.stringify(e))};var Ot=a(3043);const $t=(e,t)=>{const a=(e=>{const t=e.getEngine().getRenderingCanvasClientRect();return null!==t?t.height/t.width:1})(t);return a>1?{left:-e,right:e,bottom:-e*a,top:e*a}:{bottom:-e,top:e,left:-e/a,right:e/a}},Ut=(e,t,a)=>{var o;return null==e||null===(o=e[a])||void 0===o?void 0:o[t]},Gt=e=>[e[1][0],e[0][1],e[1][2],e[2][1]],Wt=(e,[t,a])=>[[Ut(e,a-1,t-1),Ut(e,a,t-1),Ut(e,a+1,t-1)],[Ut(e,a-1,t),Ut(e,a,t),Ut(e,a+1,t)],[Ut(e,a-1,t+1),Ut(e,a,t+1),Ut(e,a+1,t+1)]],Ft=({state:e})=>{const t=Me({state:e});return t?t.grid.reduce(((t,a)=>{const o=(0,y.X)({name:r.box,state:e,entity:a});if(o){const e=o.gridPosition[0],a=o.gridPosition[1];t[e]||(t[e]=[]),t[e][a]={...o,points:0}}return t}),[]):[]},Dt=({entity:e,state:t})=>(0,Qe.K)({state:t,name:r.game,entity:we,update:t=>({boxRotationQueue:[...t.boxRotationQueue,e]})}),zt=e=>6===e?1:e+1,Xt=({state:e,ai:t,box:a})=>{const{entity:o}=a,n=zt(a.dots);return e=Je({state:e,boxUniqueId:o,texture:Pe({state:e,ai:t})[n],color:t.color,nextTurn:!0,shouldExplode:6===a.dots}),e=Dt({entity:o,state:e}),(0,Qe.K)({state:e,name:r.box,entity:o,update:()=>({isAnimating:!0,player:(null==t?void 0:t.entity)||"",dots:n})})},Qt={emptyBox:50,preferEmptyBoxes:15,advancedAttack:7,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:10,playerLessThanOponent:-10,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:-15,sixToSix:50,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:2,playerLessThanOponent:7,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:0,toBorder:0}},Yt={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:2,playerLessThanOponent:-2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:1,playerLessThanOponent:2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:0,toBorder:0}},Ht={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:0,playerLessThanOponent:-2,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:5,playerEqualToOponent:0,playerLessThanOponent:5,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:0,toBorder:0}},Jt=({state:e,ai:t,preferEmptyBoxes:a})=>{const o=t.entity,r={[d.disabled]:Ht,[d.random]:Ht,[d.easy]:Ht,[d.medium]:Yt,[d.hard]:Qt}[t.level];let n=Ft({state:e});if(n=(({dataGrid:e,aIGridPoints:t})=>e.reduce(((e,a,o)=>(e[o]=a.reduce(((e,a,o)=>{const r=void 0===a.player?a.points+t.emptyBox:a.points;return e[o]={...a,points:r},e}),a),e)),e))({dataGrid:n,aIGridPoints:r}),n=(({dataGrid:e,currentPlayer:t,preferEmptyBoxes:a,aIGridPoints:o})=>e.reduce(((r,n,s)=>(r[s]=n.reduce(((r,n,l)=>{if(n.player!==t.entity&&void 0!==n.player)return r;const d=Wt(e,[s,l]),p=(({grid3x3:e,preferEmptyBoxes:t,currentPlayer:a,aIGridPoints:o})=>{const r=e[1][1];return Gt(e).reduce(((e,n)=>{if(!n)return e+o.adjacted.toBorder;const s=r.dots===n.dots?i.equal:r.dots>n.dots?i.more:i.less;if(n.player!==r.player&&void 0!==n.player){if(t&&void 0===r.player&&n.player===a.entity)return Math.random()>.5?e+o.preferEmptyBoxes:e;if(s===i.more){const t=r.dots-n.dots;return e+o.adjacted.playerMoreThanOponent-t}if(s===i.equal)return e+o.adjacted.playerEqualToOponent*r.dots;if(s===i.less){const t=r.dots-n.dots-n.dots;return e+o.adjacted.playerLessThanOponent*Math.abs(t)}}else{if(6===r.dots)return e;if(s===i.more)return e+o.adjacted.playerMoreThanPlayer;if(s===i.equal)return 6===n.dots&&6===r.dots?e+o.adjacted.sixToSix:e+o.adjacted.playerEqualToPlayer;if(s===i.less)return 6===n.dots?e+2*o.adjacted.playerLessThanPlayer:e+o.adjacted.playerLessThanPlayer}return e}),0)})({grid3x3:d,preferEmptyBoxes:a,currentPlayer:t,aIGridPoints:o})+(({grid3x3:e,aIGridPoints:t})=>{const a=e[1][1];return(e=>[e[0][0],e[0][2],e[2][0],e[2][2]])(e).reduce(((e,o)=>{if(!o)return e+t.diagonall.toBorder;const r=a.dots===o.dots?i.equal:a.dots>o.dots?i.more:i.less;if(o.player!==a.player&&void 0!==o.player){if(r===i.more)return e+t.diagonall.playerMoreThanOponent;if(r===i.equal)return 6===o.dots?e+-10*t.diagonall.playerEqualToOponent:e+t.diagonall.playerEqualToOponent;if(r===i.less)return 6===o.dots?e+2*t.diagonall.playerLessThanOponent:e+t.diagonall.playerLessThanOponent}else{if(6===a.dots)return e;if(r===i.more)return e+t.diagonall.playerMoreThanPlayer;if(r===i.equal)return e+t.diagonall.playerEqualToPlayer;if(r===i.less){const r=o.dots-a.dots;return e+t.diagonall.playerLessThanPlayer+r**2}}return e}),0)})({grid3x3:d,preferEmptyBoxes:a,currentPlayer:t,aIGridPoints:o});return r[l]={...n,points:n.points+p},r}),n),r)),e))({currentPlayer:t,dataGrid:n,preferEmptyBoxes:!!a,aIGridPoints:r}),!a)switch(t.level){case d.disabled:n=(({dataGrid:e})=>e.reduce(((e,t,a)=>(e[a]=t.reduce(((e,t,a)=>(e[a].player="-1",e)),t),e)),e))({dataGrid:n});break;case d.random:n=(({dataGrid:e,currentPlayer:t})=>e.reduce(((e,a,o)=>(e[o]=a.reduce(((e,a,o)=>(a.player!==t||void 0===a.player||(e[o]={...a,points:100*Math.random()}),e)),a),e)),e))({dataGrid:n,currentPlayer:o});break;case d.hard:n=(({dataGrid:e,currentPlayer:t})=>e.reduce(((a,o,r)=>(a[r]=o.reduce(((a,o,n)=>{if(o.player!==t)return a;const s=Wt(e,[r,n]),l=Gt(s);if(l.some((e=>6===(null==e?void 0:e.dots))))return a;const d=l.reduce(((a,r)=>{if(!r)return a;const n=void 0!==r.player&&r.player!==t,s=o.dots>=r.dots;if(n&&s&&(({currentPlayer:e,adjactedBox:t,dataGrid:a,position:[o,r]})=>{const n=Wt(a,[o,r]);return Gt(n).every((a=>void 0===a||a.player===e||void 0===a.player||a.dots<=t.dots))})({currentPlayer:t,adjactedBox:r,dataGrid:e,position:r.gridPosition})){const e=6/o.dots;a+=r.dots*Qt.advancedAttack/e}return a}),0);return a[n]={...o,points:o.points+d},a}),o),a)),e))({dataGrid:n,currentPlayer:o})}return(({currentPlayer:e,dataGrid:t})=>{let a=-1/0,o=[];t.forEach((t=>{t.forEach((t=>{const r=void 0===t.player,n=t.player===e;(r||n)&&(t.points>a&&(o=[]),t.points>=a&&(a=t.points,o.push(t)))}))}));const r=Math.floor(Math.random()*o.length);return o[r]})({currentPlayer:o,dataGrid:n})},Vt=({playersQueue:e,index:t,state:a})=>{const o=(0,y.X)({state:a,name:r.ai,entity:e[t]});return null!=o&&o.active?o:Vt({playersQueue:e,index:t>=e.length?0:t+1,state:a})},_t=({state:e})=>{const t=Me({state:e});if(!t||0===(null==t?void 0:t.playersQueue.length))return;const a=t.playersQueue.findIndex((e=>t.currentPlayer===e));return Vt({playersQueue:t.playersQueue,index:a+1,state:e})};var Zt=a(3666),ea=a(6553);const ta={entity:"gameMap-campaign-0",campaignNumber:0,locked:!1,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.disabled}],grid:[[{player:0,dots:1},{player:0,dots:2},{player:0,dots:1},{player:0,dots:2}],[{player:0,dots:1},{player:0,dots:2},{player:0,dots:3},{player:0,dots:1}],[{player:0,dots:2},{player:0,dots:4},{player:1,dots:4},{player:1,dots:2}],[{player:0,dots:2},{player:0,dots:5},{player:1,dots:4},{player:1,dots:1}]]},aa={entity:"gameMap-campaign-1",campaignNumber:1,locked:!1,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.disabled}],grid:[[{player:0,dots:1},{player:0,dots:1},{player:1,dots:1},{player:1,dots:6}],[{player:0,dots:1},{player:0,dots:1},{player:1,dots:1},{player:1,dots:6}],[{player:0,dots:1},{player:0,dots:6},{player:1,dots:6},{player:1,dots:6}],[{player:0,dots:1},{player:0,dots:1},{player:1,dots:1},{player:1,dots:1}]]},oa={entity:"gameMap-campaign-2",campaignNumber:2,locked:!1,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.disabled}],grid:[[{player:0,dots:6},{player:0,dots:6},{player:0,dots:3},{player:0,dots:2}],[{player:1,dots:5},{player:0,dots:6},{player:0,dots:5},{player:1,dots:5}],[{player:1,dots:6},{player:1,dots:5},{player:1,dots:6},{player:1,dots:3}],[{player:1,dots:3},{player:1,dots:2},{player:1,dots:1},{player:1,dots:1}]]},ra={entity:"gameMap-campaign-3",campaignNumber:3,locked:!1,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.random}],grid:[[{player:1,dots:1},{player:1,dots:1},{player:1,dots:1},{player:1,dots:1}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:0,dots:1},{player:0,dots:1},{player:0,dots:1},{player:0,dots:1}]]},na=({state:e,gridPosition:t,isPickable:a=!1})=>{const o=e.babylonjs.sceneRef;if(!o)return e;const n=Object.values((0,pt.C)({state:e,name:r.box})??{}),s=n.find((e=>(0,ea.fS)(e.gridPosition,t)));return n.forEach((e=>{const t=o.getTransformNodeByUniqueId(parseInt(e.entity));(null==s?void 0:s.entity)!==e.entity&&t&&t.getChildren().forEach((e=>{const t=o.getMeshByUniqueId(e.uniqueId);t&&(t.isPickable=a)}))})),e},sa=({state:e})=>(e=(0,Qe.K)({state:e,entity:vt,name:u.f.transform,update:()=>({position:[9999,9999,9999]})}),e=na({state:e,gridPosition:[-1,-1],isPickable:!0}),la({state:e,tipText:null})),la=({state:e,tipText:t})=>(e=(0,Qe.K)({state:e,entity:vt,name:r.tutorial,update:()=>({tipText:t})}),yt("setUIState",e),e),da=({state:e,gridPosition:t})=>{const a=(0,pt.C)({state:e,name:r.box}),o=Object.values(a??{}).find((e=>(0,ea.fS)(e.gridPosition,t))),n=(0,y.X)({state:e,name:u.f.transform,entity:(null==o?void 0:o.entity)||""});return e=(0,Qe.K)({state:e,entity:vt,name:u.f.transform,update:()=>({position:null!=n&&n.position?[n.position[0]+1/4,n.position[1]-1/1.5,(n.position[2]??0)-1]:void 0})}),yt("setUIState",e),na({state:e,gridPosition:t,isPickable:!1}),e},ia=({state:e})=>{const t=(0,y.X)({state:e,entity:vt,name:r.tutorial}),a=Me({state:e});if(!t||!a)return e;const{turn:o,currentCampaignLevelEntity:n}=a;return n===ta.entity?0===o?(e=da({state:e,gridPosition:[1,2]}),e=la({state:e,tipText:"Tap on dice to increase number of their dots and end your turn."})):2===o?(e=sa({state:e}),e=da({state:e,gridPosition:[1,2]}),e=la({state:e,tipText:"Tap one more time"})):4===o?(e=sa({state:e}),e=da({state:e,gridPosition:[1,2]}),e=la({state:e,tipText:"Six dot dices have a special ability. They can capture adjacent dices and increase their dots by one. Notice that a six dot dice resets its dots count to one. Tap on your dice to capture a red dice"})):6===o?(e=sa({state:e}),e=da({state:e,gridPosition:[2,2]}),e=la({state:e,tipText:"Great! Now this dice has a blue color and you can tap on it"})):8===o?(e=sa({state:e}),e=da({state:e,gridPosition:[2,2]}),e=la({state:e,tipText:"Tap to capture more dices"})):10===o?(e=sa({state:e}),e=da({state:e,gridPosition:[2,3]}),e=la({state:e,tipText:"You will win when you capture all dices"})):12===o?(e=sa({state:e}),e=da({state:e,gridPosition:[2,3]}),e=la({state:e,tipText:"Tap last time to capture last dice and finish this level"})):e=sa({state:e}):n===aa.entity?0===o?(e=sa({state:e}),e=da({state:e,gridPosition:[1,2]}),e=la({state:e,tipText:"Six dot dices can trigger another six dot dices. This is the best way to quickly capture a lot of dices"})):e=sa({state:e}):n===oa.entity?0===o?(e=sa({state:e}),e=da({state:e,gridPosition:[1,1]}),e=la({state:e,tipText:"Some combinations of five and six dots dices may lead to surprising results"})):2===o?(e=sa({state:e}),e=la({state:e,tipText:"Now you know the basics. Try to capture last dice by yourself. You don't have to hurry, there is no move limit. Tap on any blue dice"})):e=sa({state:e}):n===ra.entity?0===o?(e=sa({state:e}),e=da({state:e,gridPosition:[1,2]}),e=la({state:e,tipText:"White dices can be captured by tapping on them"})):2===o?(e=sa({state:e}),e=la({state:e,tipText:"This time the opponent will try to defend himself. Try not to lose, good luck!"})):e=sa({state:e}):e=sa({state:e}),e},pa={entity:"gameMap-campaign-4",campaignNumber:4,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.random}],grid:[[{player:1,dots:2},{player:-1,dots:0},{player:1,dots:4},{player:-1,dots:0}],[{player:0,dots:1},{player:0,dots:5},{player:0,dots:2},{player:0,dots:1}],[{player:-1,dots:0},{player:1,dots:3},{player:-1,dots:0},{player:1,dots:2}],[{player:0,dots:4},{player:0,dots:1},{player:0,dots:2},{player:0,dots:5}]]},ya={entity:"gameMap-campaign-5",campaignNumber:5,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.random}],grid:[[{player:-1,dots:0},{player:1,dots:1},{player:1,dots:1},{player:-1,dots:0}],[{player:0,dots:1},{player:1,dots:1},{player:1,dots:1},{player:0,dots:1}],[{player:1,dots:1},{player:0,dots:1},{player:0,dots:1},{player:1,dots:1}],[{player:-1,dots:0},{player:0,dots:1},{player:0,dots:1},{player:-1,dots:0}]]},ca={entity:"gameMap-campaign-6",campaignNumber:6,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy}],grid:[[{player:0,dots:1},{player:0,dots:1},{player:0,dots:5},{player:-1,dots:0}],[{player:0,dots:5},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:1,dots:5}],[{player:-1,dots:0},{player:1,dots:5},{player:1,dots:1},{player:1,dots:1}]]},ua={entity:"gameMap-campaign-7",campaignNumber:7,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy}],grid:[[void 0,{player:0,dots:1},{player:0,dots:1},void 0],[{player:1,dots:1},{player:-1,dots:0},{player:-1,dots:0},{player:1,dots:1}],[{player:1,dots:1},{player:-1,dots:0},{player:-1,dots:0},{player:1,dots:1}],[void 0,{player:0,dots:1},{player:0,dots:1},void 0]]},ma={entity:"gameMap-campaign-8",campaignNumber:8,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy}],grid:[[{player:0,dots:1},{player:0,dots:1},{player:0,dots:1},{player:0,dots:1}],[void 0,{player:1,dots:2},{player:-1,dots:0},{player:1,dots:2}],[{player:1,dots:2},{player:-1,dots:0},{player:1,dots:2},void 0],[{player:0,dots:1},{player:0,dots:1},{player:0,dots:1},{player:0,dots:1}]]},ga={entity:"gameMap-campaign-9",campaignNumber:9,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy}],grid:[[{player:-1,dots:0},{player:1,dots:5},{player:0,dots:2},{player:1,dots:1},{player:1,dots:1}],[{player:1,dots:3},{player:-1,dots:0},{player:1,dots:4},{player:-1,dots:0},{player:1,dots:1}],[{player:-1,dots:0},{player:1,dots:2},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:0,dots:1},{player:-1,dots:0},{player:0,dots:3},{player:1,dots:2},{player:0,dots:2}],[{player:0,dots:1},{player:0,dots:1},{player:-1,dots:0},{player:1,dots:1},{player:1,dots:1}]]},va={entity:"gameMap-campaign-10",campaignNumber:10,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy}],grid:[[{player:0,dots:4},{player:1,dots:4},{player:0,dots:4},{player:1,dots:4},{player:0,dots:4}],[{player:1,dots:4},{player:0,dots:4},{player:1,dots:4},{player:0,dots:4},{player:1,dots:4}],[{player:0,dots:4},{player:1,dots:4},{player:0,dots:4},{player:1,dots:4},{player:0,dots:4}],[{player:1,dots:4},{player:0,dots:4},{player:1,dots:4},{player:0,dots:4},{player:1,dots:4}],[{player:0,dots:4},{player:1,dots:4},{player:0,dots:4},{player:1,dots:4},{player:0,dots:4}]]},fa={entity:"gameMap-campaign-11",campaignNumber:11,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy}],grid:[[{player:0,dots:1},{player:0,dots:1},void 0,{player:1,dots:1},{player:1,dots:1}],[void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0],[void 0,{player:0,dots:1},{player:-1,dots:0},{player:1,dots:1},void 0],[void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0],[{player:1,dots:1},{player:1,dots:1},void 0,{player:0,dots:1},{player:0,dots:1}]]},ha={entity:"gameMap-campaign-12",campaignNumber:12,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy},{human:!1,color:Tt,level:d.easy}],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:1,dots:1},{player:1,dots:1},{player:1,dots:2},{player:-1,dots:0},{player:-1,dots:0}],[{player:0,dots:1},{player:0,dots:1},{player:0,dots:6},{player:-1,dots:0},{player:-1,dots:0}],[{player:0,dots:1},{player:0,dots:2},{player:1,dots:3},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:0,dots:1},{player:1,dots:1},{player:-1,dots:0},{player:-1,dots:0}]]},ba={entity:"gameMap-campaign-13",campaignNumber:13,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy},{human:!1,color:Tt,level:d.easy}],grid:[[{player:1,dots:1},{player:1,dots:1},{player:-1,dots:0},{player:-1,dots:0},{player:0,dots:1}],[{player:1,dots:1},{player:1,dots:1},{player:-1,dots:0},{player:-1,dots:0},{player:0,dots:1}],[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:0,dots:1}],[{player:2,dots:1},{player:2,dots:1},{player:-1,dots:0},{player:-1,dots:0},{player:0,dots:1}],[{player:2,dots:1},{player:2,dots:1},{player:-1,dots:0},{player:-1,dots:0},{player:0,dots:1}]]},xa={entity:"gameMap-campaign-14",campaignNumber:14,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy},{human:!1,color:Tt,level:d.easy}],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:2,dots:1},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:0,dots:1},void 0,{player:0,dots:1},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:1,dots:1},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},Ea={entity:"gameMap-campaign-15",campaignNumber:15,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy},{human:!1,color:Tt,level:d.easy}],grid:[[{player:0,dots:1},{player:0,dots:1},{player:-1,dots:0},{player:2,dots:1},{player:2,dots:1}],[{player:-1,dots:0},{player:0,dots:1},{player:0,dots:1},{player:2,dots:5},{player:2,dots:1}],[{player:-1,dots:0},{player:0,dots:1},{player:-1,dots:0},{player:0,dots:1},{player:-1,dots:0}],[{player:1,dots:1},{player:1,dots:5},{player:0,dots:1},{player:0,dots:1},{player:-1,dots:0}],[{player:1,dots:1},{player:1,dots:1},{player:-1,dots:0},{player:-1,dots:0},{player:0,dots:1}]]},wa={entity:"gameMap-campaign-16",campaignNumber:16,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy},{human:!1,color:Tt,level:d.easy}],grid:[[{player:2,dots:6},{player:0,dots:3},{player:0,dots:6},void 0,{player:1,dots:6}],[{player:2,dots:1},{player:2,dots:6},{player:0,dots:3},{player:1,dots:6},{player:1,dots:1}],[{player:2,dots:6},void 0,{player:0,dots:6},{player:0,dots:3},{player:1,dots:6}],[{player:2,dots:1},{player:2,dots:6},{player:0,dots:3},{player:1,dots:6},{player:1,dots:1}],[{player:2,dots:6},{player:0,dots:3},{player:0,dots:6},void 0,{player:1,dots:6}]]},Ta={entity:"gameMap-campaign-17",campaignNumber:17,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy},{human:!1,color:Tt,level:d.easy}],grid:[[{player:0,dots:1},{player:2,dots:1},{player:1,dots:1},{player:0,dots:1},{player:2,dots:1}],[{player:1,dots:1},{player:0,dots:1},{player:2,dots:1},{player:1,dots:1},{player:0,dots:1}],[{player:2,dots:1},{player:1,dots:1},{player:0,dots:1},{player:2,dots:1},{player:1,dots:1}],[{player:0,dots:1},{player:2,dots:1},{player:1,dots:1},{player:0,dots:1},{player:2,dots:1}],[{player:1,dots:1},{player:0,dots:1},{player:2,dots:1},{player:1,dots:1},{player:0,dots:1}]]},Ca={entity:"gameMap-campaign-18",campaignNumber:18,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy},{human:!1,color:Tt,level:d.easy},{human:!1,color:kt,level:d.easy}],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},Ma={entity:"gameMap-campaign-19",campaignNumber:19,locked:!0,players:[{human:!0,color:Ct,level:d.easy},{human:!1,color:Lt,level:d.easy},{human:!1,color:Tt,level:d.easy},{human:!1,color:kt,level:d.easy}],grid:[[{player:1,dots:6},{player:1,dots:1},{player:1,dots:6},{player:3,dots:1},{player:3,dots:6},{player:3,dots:1}],[{player:1,dots:1},{player:1,dots:6},{player:1,dots:1},{player:3,dots:6},{player:3,dots:1},{player:3,dots:6}],[{player:1,dots:6},{player:1,dots:1},{player:1,dots:6},{player:3,dots:1},{player:3,dots:6},{player:3,dots:1}],[{player:0,dots:1},{player:0,dots:6},{player:0,dots:1},{player:2,dots:6},{player:2,dots:1},{player:2,dots:1}],[{player:0,dots:6},{player:0,dots:1},{player:0,dots:6},{player:2,dots:1},{player:2,dots:6},{player:2,dots:6}],[{player:0,dots:1},{player:0,dots:6},{player:0,dots:1},{player:2,dots:6},{player:2,dots:1},{player:2,dots:6}]]},ka=[{entity:"gameMap-small-0",campaignNumber:-1,locked:!0,players:[],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},{entity:"gameMap-small-1",campaignNumber:-1,locked:!0,players:[],grid:[[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0]]},{entity:"gameMap-small-2",campaignNumber:-1,locked:!0,players:[],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},{entity:"gameMap-medium-0",campaignNumber:-1,locked:!0,players:[],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},{entity:"gameMap-medium-1",campaignNumber:-1,locked:!0,players:[],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},{entity:"gameMap-medium-2",campaignNumber:-1,locked:!0,players:[],grid:[[void 0,void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[void 0,void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,void 0],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,void 0]]},{entity:"gameMap-huge-0",campaignNumber:-1,locked:!0,players:[],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},{entity:"gameMap-huge-1",campaignNumber:-1,locked:!0,players:[],grid:[[{player:-1,dots:0},{player:-1,dots:0},void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0],[void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,{player:-1,dots:0}],[{player:-1,dots:0},void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},{entity:"gameMap-huge-2",campaignNumber:-1,locked:!0,players:[],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},{entity:"gameMap-huge-3",campaignNumber:-1,locked:!0,players:[],grid:[[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0],[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0],[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0]]},{entity:"gameMap-huge-4",campaignNumber:-1,locked:!0,players:[],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},ta,aa,oa,ra,pa,ya,ca,ua,ma,ga,va,fa,ha,ba,xa,Ea,wa,Ta,Ca,Ma],La=({state:e})=>{const t=Object.values((0,pt.C)({state:e,name:r.ai})??{}),a=Object.values((0,pt.C)({state:e,name:r.box})??{}),o=t.map((e=>{const t=a.filter((({player:t})=>t===e.entity));return{aiEntity:e.entity,boxesSum:t.length}}));return(0,Qe.K)({name:r.game,entity:we,state:e,update:e=>({statistics:[...e.statistics,o]})})},Sa=({state:e})=>{const t=Me({state:e});if(!t)return e;const{gameStarted:a,boxRotationQueue:o}=t;if(e=(0,Qe.K)({state:e,name:r.game,entity:we,update:t=>{var a;return{turn:t.turn+1,lastBoxClickTimestamp:(null===(a=(0,Zt.hK)({state:e}))||void 0===a?void 0:a.timeNow)||0}}}),a&&0===o.length){const t=_t({state:e});if(!t)return e;const a=(0,y.X)({name:r.ai,state:e,entity:t.entity});if(!a)return e;if(e=(0,Qe.K)({state:e,name:r.game,entity:we,update:e=>({currentPlayer:a.entity,moves:e.moves+1})}),a.active){if(0===(({state:e,ai:t})=>{const a=Me({state:e});return(null==a?void 0:a.grid.reduce(((a,o)=>{const n=(0,y.X)({state:e,name:r.box,entity:o}),s=void 0===(null==n?void 0:n.player),l=(null==n?void 0:n.player)===t.entity;return s||l?a+1:a}),0))||0})({state:e=La({state:e}),ai:a}))e=(({state:e,ai:t})=>{e=(0,Qe.K)({state:e,name:r.ai,entity:t.entity,update:()=>({active:!1})});const a=(0,pt.C)({state:e,name:r.ai});return 1===Object.values(a||{}).reduce(((e,t)=>t.active?e+1:e),0)?(e=(({state:e})=>{const t=Me({state:e});if(null!=t&&t.currentCampaignLevelEntity){var a;const o=ka.findIndex((({entity:e})=>e===(null==t?void 0:t.currentCampaignLevelEntity)));e=(0,Qe.K)({state:e,name:r.gameMap,entity:(null===(a=ka[o+1])||void 0===a?void 0:a.entity)??"",update:()=>({locked:!1})})}return Nt(e),e})({state:e=(0,Qe.K)({state:e,name:r.game,entity:we,update:()=>({gameStarted:!1})})}),yt("setUIState",e),e):e=Sa({state:e})})({state:e,ai:a});else if(!1===a.human){const t=Jt({state:e,ai:a}),o=(0,y.X)({name:u.f.transform,entity:(null==t?void 0:t.entity)||"",state:e});t?(e=et({state:e,data:{color:a.color,position:[(null==o?void 0:o.position[0])??0,(null==o?void 0:o.position[1])??0]}}),e=Xt({box:t,state:e,ai:a}),e=Dt({state:e,entity:t.entity})):e=Sa({state:e})}e=ia({state:e})}}return yt("setUIState",e),e},Pa=({state:e,ai:t})=>{e=ct({state:e,name:r.ai});const a=Me({state:e});return a&&(e=(0,c.L)({state:e,data:{...a,playersQueue:t.map((({entity:e})=>e))}})),t.reduce(((e,t)=>(e=(0,at.J)({state:e,entity:t.entity}),(0,c.L)({state:e,data:t}))),e)},Ia=Math.PI/3,Ra=({gridMaxSideLength:e,maxTime:t,direction:a})=>o=>{let r=0,n=Ue.up;switch(a){case"down":r=(e-o[1])/e,n=Ue.down;break;case"up":r=o[1]/e,n=Ue.up;break;case"left":r=(e-o[0])/e,n=Ue.left;break;case"right":r=o[0]/e,n=Ue.right}return{timeout:Math.sin(r*Ia)*t,boxRotationDirection:n}},Ba=e=>{let t=Ue.up;const a=[Math.abs(e[0]),Math.abs(e[1])],o=a[0]>a[1];return e[0]<0&&e[1]<0?t=o?Ue.left:Ue.down:e[0]>0&&e[1]<0?t=o?Ue.right:Ue.down:e[0]<0&&e[1]>0?t=o?Ue.left:Ue.up:e[0]>0&&e[1]>0&&(t=o?Ue.right:Ue.up),t},ja=({gridMaxSideLength:e,maxTime:t,direction:a})=>o=>{const r=[e/2,e/2],n=[r[0]-o[0],r[1]-o[1]],s=Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)),l=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2));let d=0,i=Ue.up;switch(a){case"center":d=l-s,i=Ba([n[0],n[1]]);break;case"outside":d=s,i=Ba([-n[0],-n[1]])}return{timeout:Math.sin(d/l*Ia)*t,boxRotationDirection:i}};var qa=a(5723);const Ka=e=>{switch(e){case l.easy:return d.easy;case l.medium:return d.medium;case l.hard:return d.hard;case l.random:const e=Math.floor(3*Math.random());return[d.easy,d.medium,d.hard][e]}},Na=({state:e,gameMap:t})=>{const a=Object.values((0,pt.C)({state:e,name:r.ai})??{}),o=e=>{var o;const r=null===(o=t.players[e??-1])||void 0===o?void 0:o.color;var n;if(r)return null===(n=a.find((e=>e.color[0]===r[0]&&e.color[1]===r[1]&&e.color[2]===r[2])))||void 0===n?void 0:n.entity};return t.grid.reduce(((e,t,a)=>t.reduce(((e,t,n)=>{if(!t)return e;const s=Xe().toString();e=(0,at.J)({state:e,entity:s}),e=(0,c.L)({state:e,data:{name:r.box,entity:s,isAnimating:!1,dots:t.dots,gridPosition:[n,a],player:-1===t.player?void 0:o(t.player)}});const l=Me({state:e});return l?ke({state:e,data:{...l,grid:[...l.grid,s]}}):e}),e)),e)},Aa=({state:e,mapEntity:t})=>{var a;(({state:e})=>{const t=Me({state:e}),a=Math.sqrt((null==t?void 0:t.grid.length)||1)-1,o=250*a,n=[ja({gridMaxSideLength:a,maxTime:o,direction:"center"}),ja({gridMaxSideLength:a,maxTime:o,direction:"outside"}),Ra({gridMaxSideLength:a,maxTime:o,direction:"left"}),Ra({gridMaxSideLength:a,maxTime:o,direction:"right"}),Ra({gridMaxSideLength:a,maxTime:o,direction:"down"}),Ra({gridMaxSideLength:a,maxTime:o,direction:"up"})],s=n[Math.floor(n.length*Math.random())];null==t||t.grid.forEach((t=>{const a=(0,y.X)({state:e,entity:t,name:r.box}),o=(0,y.X)({state:e,entity:(null==a?void 0:a.player)||"",name:r.ai});if(a&&o){const r=s(a.gridPosition),n=r.timeout+500*Math.random();setTimeout((()=>{(0,Ne.Kn)({type:Ge.Type.rotateStart,payload:{color:o.color,texture:Pe({state:e,ai:o})[a.dots],direction:r.boxRotationDirection,boxEntity:t}})}),n)}}))})({state:e});const o=(0,y.X)({state:e,name:r.ai,entity:(null===(a=Me({state:e}))||void 0===a?void 0:a.currentPlayer)||""});if(o&&!o.human){const t=Jt({state:e,ai:o});t&&(e=Xt({box:t,state:e,ai:o}))}return e=(0,at.J)({state:e,entity:Ve}),e=(0,c.L)({state:e,data:{entity:Ve,name:r.marker,color:[1,1,1],position:[0,0]}}),yt("setUIState",e),o&&setTimeout((()=>{(0,Ne.Kn)({type:Te.Type.shakeAiBoxes,payload:{ai:o}})}),3e3),e=(({state:e,mapEntity:t})=>{const a=(0,y.X)({state:e,name:r.gameMap,entity:t}),{center:o,cameraDistance:n}=(({grid:e})=>{const t=null!=e&&e[0]?(null==e?void 0:e[0].length)*Ae:Ae,a=void 0!==e?e.length*Ae:Ae;return{center:[(a-Ae)/2,(t-Ae)/2],cameraDistance:bt({value:(t>a?t:a)/2+.2,min:3,max:1/0})}})({grid:null==a?void 0:a.grid});return nt({state:e,data:{position:[o[0],o[1]],distance:n}})})({state:e=(0,Qe.K)({state:e,name:r.game,entity:we,update:()=>{var t;return{lastBoxClickTimestamp:(null===(t=(0,Zt.hK)({state:e}))||void 0===t?void 0:t.timeNow)||0}}}),mapEntity:t}),yt("setUIState",e),e},Oa=({state:e})=>{var t;e=(({state:e})=>{const t=Me({state:e});if(!t)return e;const a=(0,y.X)({state:e,name:r.gameMap,entity:t.customLevelSettings.mapEntity});return a?(e=Pa({state:e,ai:t.customLevelSettings.players.map((e=>({...e,level:Ka(t.customLevelSettings.difficulty)})))}),e=Na({state:e,gameMap:a})):e})({state:e=(0,Qe.K)({state:e,name:r.game,entity:we,update:()=>({statistics:[],gameStarted:!0,page:s.customLevel})})}),e=La({state:e}),e=ke({state:e,data:{currentPlayer:null===(t=_t({state:e}))||void 0===t?void 0:t.entity}});const a=Me({state:e});return a?(null!=a&&a.customLevelSettings.quickStart&&(e=(({state:e})=>{const t=Me({state:e}),a=(null==t?void 0:t.grid.length)||1,o=a-a%((null==t?void 0:t.customLevelSettings.players.length)||1);return Array.from({length:2*o}).reduce((e=>{const t=Me({state:e}),a=(0,y.X)({state:e,name:r.ai,entity:(null==t?void 0:t.currentPlayer)||""});if(!t||!a)return e;const o=Jt({state:e,ai:a,preferEmptyBoxes:!0});return o?(e=(0,Qe.K)({state:e,name:r.box,entity:o.entity,update:()=>({player:a.entity,dots:zt(o.dots)})}),e=(0,Qe.K)({state:e,name:r.game,entity:we,update:()=>{var t;return{currentPlayer:(null===(t=_t({state:e}))||void 0===t?void 0:t.entity)||""}}}),e=La({state:e})):e}),e)||e})({state:e})),e=Aa({state:e,mapEntity:null==a?void 0:a.customLevelSettings.mapEntity})):e};let $a;console.info(' call "window.loadAndMountDevtools()" to open devtools'),window.loadAndMountDevtools=()=>{a.e(26).then(a.bind(a,9026)),a.e(216).then(a.bind(a,1298)).then((({debugSystem:e})=>{(0,Ne.Kn)({type:$a.Type.enable,payload:{debugSystem:e}})}))},function(e){let t;!function(e){e.enable="DevtoolsEvent-enable"}(t||(t={})),e.Type=t}($a||($a={}));const Ua=({state:e,event:t})=>{switch(t.type){case ot.tP.Type.resize:return(({state:e})=>nt({state:e,data:{}}))({state:e,event:t});case it.Type.rotateRandomLogoBox:return(({state:e})=>{const t=e.babylonjs.sceneRef,a=(0,y.X)({state:e,name:r.logo,entity:dt}),o=Me({state:e});if(!a||!t||!o)return e;const n=(()=>{const e=tt.flat().filter((e=>""!==e));return e[Math.floor(e.length*Math.random())]})(),l=(()=>{const e=Math.floor(ue.length*Math.random());return ue[e]})(),d=(()=>{const e=[Et,...qt().map((({color:e})=>e))];return e[Math.floor(e.length*Math.random())]})();return e=Je({state:e,boxUniqueId:n,texture:l,color:d,nextTurn:!1,shouldExplode:!1}),o.page===s.mainMenu&&setTimeout((()=>{(0,Ne.Kn)({type:it.Type.rotateRandomLogoBox,payload:null})}),500*Math.random()+500),e})({state:e,event:t});case Te.Type.startCustomLevel:return Oa({state:e,event:t});case Te.Type.startCampaignLevel:return(({state:e,event:{payload:{mapEntity:t}}})=>(e=ut({state:e,event:{type:Te.Type.cleanScene,payload:{newPage:s.campaignLevel}}}),e=(({state:e,mapEntity:t})=>{if(!Me({state:e}))return e;const a=(0,y.X)({state:e,name:r.gameMap,entity:t});return a?(e=Pa({state:e,ai:a.players.map(((e,t)=>({...e,name:r.ai,entity:(0,qa.P)({name:"ai"}),active:!0,textureSet:qt()[t].textureSet})))}),e=Na({state:e,gameMap:a})):e})({state:e=(0,Qe.K)({state:e,name:r.game,entity:we,update:()=>({statistics:[],gameStarted:!0})}),mapEntity:t}),e=La({state:e}),e=(0,Qe.K)({state:e,name:r.game,entity:we,update:()=>{var a;return{currentPlayer:null===(a=_t({state:e}))||void 0===a?void 0:a.entity,currentCampaignLevelEntity:t}}}),e=(0,at.J)({state:e,entity:vt}),e=(0,c.L)({state:e,data:{entity:vt,name:r.tutorial}}),e=ia({state:e}),e=Aa({state:e,mapEntity:t})))({state:e,event:t});case Te.Type.playerClick:return(({state:e,event:t})=>{const a=Me({state:e});if(!a)return e;const{currentPlayer:o,gameStarted:n,boxRotationQueue:s}=a,l=(0,y.X)({state:e,name:r.box,entity:t.payload.boxEntity}),d=void 0===(null==l?void 0:l.player)||(null==l?void 0:l.player)===o,i=(0,y.X)({name:u.f.transform,entity:t.payload.boxEntity,state:e});if(i&&n&&0===s.length&&d){const t=(0,y.X)({name:r.ai,state:e,entity:o});l&&null!=t&&t.human&&(e=et({state:e,data:{color:t.color,position:[i.position[0],i.position[1]]}}),e=Xt({box:l,state:e,ai:t}))}return e})({state:e,event:t});case Te.Type.cleanScene:return ut({state:e,event:t});case Te.Type.changePlayers:return(({state:e})=>{var t,a;const o=Me({state:e});if(!o)return e;const n=8===(null===(t=o.customLevelSettings.players)||void 0===t?void 0:t.length)?2:(null===(a=o.customLevelSettings.players)||void 0===a?void 0:a.length)+1;return e=(0,Qe.K)({state:e,entity:we,name:r.game,update:e=>({customLevelSettings:{...e.customLevelSettings,players:qt().slice(0,n)}})}),yt("setUIState",e),Nt(e),e})({state:e,event:t});case Te.Type.changeDifficulty:return(({state:e})=>{const t=Me({state:e});if(!t)return e;const a=[l.easy,l.medium,l.hard,l.random],o=a.findIndex((e=>e===t.customLevelSettings.difficulty)),n=-1===o?a[0]:a[o+1]??a[0];return e=(0,Qe.K)({state:e,entity:we,name:r.game,update:e=>({customLevelSettings:{...e.customLevelSettings,difficulty:n}})}),yt("setUIState",e),Nt(e),e})({state:e,event:t});case Te.Type.changeQuickStart:return(({state:e})=>(e=(0,Qe.K)({state:e,entity:we,name:r.game,update:e=>({customLevelSettings:{...e.customLevelSettings,quickStart:!e.customLevelSettings.quickStart}})}),yt("setUIState",e),Nt(e),e))({state:e,event:t});case Te.Type.changeColorBlindMode:return(({state:e})=>(e=(0,Qe.K)({state:e,entity:we,name:r.game,update:e=>({colorBlindMode:!e.colorBlindMode})}),yt("setUIState",e),Nt(e),e))({state:e,event:t});case Te.Type.changeMapType:return(({state:e,event:{payload:{gameMapEntity:t}}})=>(e=(0,Qe.K)({state:e,entity:we,name:r.game,update:e=>({customLevelSettings:{...e.customLevelSettings,mapEntity:t}})}),yt("setUIState",e),Nt(e),e))({state:e,event:t});case Te.Type.shakeAiBoxes:return(({state:e,event:{payload:{ai:t}}})=>{const a=Me({state:e}),o=(0,Zt.hK)({state:e});if(!1===(null==a?void 0:a.gameStarted))return e;const n=(null==a?void 0:a.lastBoxClickTimestamp)||0;return((null==o?void 0:o.timeNow)||0)>n+6e3&&(null==a||a.grid.forEach((a=>{const o=(0,y.X)({state:e,name:r.box,entity:a});if(!(0,y.X)({state:e,name:u.f.animation,entity:a})&&(null==o?void 0:o.player)===t.entity&&(0,y.X)({state:e,name:u.f.transform,entity:a})){const t=Math.PI/16;e=(0,c.L)({state:e,data:{name:u.f.animation,entity:a,deleteWhenFinished:!0,isPlaying:!0,isFinished:!1,currentTime:0,wrapMode:Fe.f.WrapMode.once,timingMode:Fe.f.TimingMode.smooth,properties:[{path:"rotation",component:u.f.transform,entity:a,keyframes:[{duration:150,timingFunction:"Linear",valueRange:[[0,0,0],[0,0,t]]},{duration:300,timingFunction:"Linear",valueRange:[[0,0,t],[0,0,-t]]},{duration:300,timingFunction:"Linear",valueRange:[[0,0,-t],[0,0,0]]},{duration:50,timingFunction:"Linear",valueRange:[[0,0,0],[0,0,0]]}]}]}})}}))),setTimeout((()=>{(0,Ne.Kn)({type:Te.Type.shakeAiBoxes,payload:{ai:t}})}),3e3),e})({state:e,event:t});case Te.Type.playAgainCustomLevel:return e=ut({state:e,event:{type:Te.Type.cleanScene,payload:{newPage:s.customLevel}}}),Oa({state:e,event:{type:Te.Type.startCustomLevel,payload:null}});case Ge.Type.rotationEnd:return(({state:e,event:t})=>{const a=e.babylonjs.sceneRef,{boxEntity:o,texture:n,color:s,nextTurn:l,shouldExplode:d}=t.payload,i=(0,y.X)({state:e,name:r.box,entity:o}),p=(0,y.X)({state:e,name:u.f.transform,entity:o});if(!i||!a||!p)return e;e=(({entity:e,state:t})=>(0,Qe.K)({state:t,name:r.game,entity:we,update:t=>({boxRotationQueue:t.boxRotationQueue.filter((t=>t!==e))})}))({entity:i.entity,state:e}),e=(0,Qe.K)({state:e,name:u.f.transform,entity:o,update:()=>({rotation:[0,0,0]})});const c=a.getTransformNodeByUniqueId(parseInt(i.entity));c&&c.getChildren().forEach((e=>{const t=a.getMeshByUniqueId(e.uniqueId);t&&Se({mesh:t,color:s,texture:n,scene:a})})),e=(0,Qe.K)({state:e,name:r.box,entity:o,update:()=>({isAnimating:!1})});const m=Me({state:e}),g=(0,y.X)({state:e,name:r.ai,entity:(null==i?void 0:i.player)||""});return l&&g&&m&&i&&(d?e=(({state:e,ai:t,box:a})=>{const{gridPosition:[o,r]}=a,n=Ft({state:e});return[Ut(n,r,o-1),Ut(n,r,o+1),Ut(n,r-1,o),Ut(n,r+1,o)].filter((e=>void 0!==e)).reduce(((e,a)=>(e=Xt({ai:t,box:a,state:e}),Dt({entity:a.entity,state:e}))),e)})({state:e,box:i,ai:g}):0===m.boxRotationQueue.length&&(e=Sa({state:e}))),e})({state:e,event:t});case Ge.Type.rotateStart:return(({state:e,event:t})=>Je({state:e,boxUniqueId:t.payload.boxEntity,texture:t.payload.texture,color:t.payload.color,direction:t.payload.direction,nextTurn:!1}))({state:e,event:t});case _e.Type.appearAnimationEnd:return(({state:e})=>(0,Qe.K)({state:e,entity:Ve,name:u.f.transform,update:()=>({position:[9999,9999,1]})}))({state:e,event:t});case $a.Type.enable:return(({state:e,event:{payload:{debugSystem:t}}})=>t(e,"devtools"))({state:e,event:t})}return e},Ga=()=>{};var Wa=a(4155);const Fa=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Da(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}Wa.env.PUBLIC_URL="/kostki";var za=a(3935),Xa=a(7294),Qa=a(6744);const{styled:Ya,css:Ha}=(0,Qa.Th)({theme:{colors:{outline:"#595cff",gray50:"#F9FAFB",gray100:"#F3F4F6",gray200:"#E5E7EB",gray300:"#D1D5DB",gray400:"#9CA3AF",gray500:"#6B7280",gray600:"#4B5563",gray700:"#374151",gray800:"#1F2937",gray900:"#111827"},space:{},fontSizes:{},fonts:{},fontWeights:{},lineHeights:{},letterSpacings:{},sizes:{},borderWidths:{},borderStyles:{},radii:{},shadows:{},zIndices:{turnIndicatorHighlighter:1,turnIndicatorText:2,modal:3},transitions:{}},media:{bp1:"(max-width: 768px)",bp2:"(min-width: 769px)",bp3:"(min-width: 1024px)"}}),Ja=Ya("button",{border:"5px solid black",background:"white",padding:"10px 7px",fontSize:"1rem",whiteSpace:"nowrap",cursor:"pointer",transition:"0.2s transform",pointerEvents:"auto","&:hover":{transform:"scale(1.05)"},"&:focus":{transform:"scale(0.98)"}}),Va=Ya("div",{display:"flex"}),_a=Ya("div",{display:"grid",margin:"0 auto",padding:"0.5rem","@bp3":{maxWidth:"1920px"}}),Za=Ya("div",{color:"Black",fontSize:"1.5rem"});let eo;const to=()=>{const[e,t]=(0,Xa.useState)(void 0);return(0,Xa.useEffect)((()=>{const e=e=>{e&&(eo=e,t(e))};return((e,t)=>{document.addEventListener("setUIState",(e=>t(e.detail)))})(0,e),()=>{((e,t)=>{document.removeEventListener("setUIState",t)})(0,e)}}),[]),e||eo},ao=()=>{const e=to(),t=e&&Me({state:e});return Xa.createElement(_a,{css:{gridTemplateRows:"20% 70% 10%",gridTemplateColumns:"20% 60% 20%",flex:1}},Xa.createElement(Va,{css:{flexDirection:"column",justifyContent:"center",alignItems:"center",gridRow:"2 / 2",gridColumn:"2 / 3"}},Xa.createElement(Ja,{css:{maxWidth:"500px",width:"100%"},onClick:()=>{(0,Ne.Kn)({type:Te.Type.cleanScene,payload:{newPage:s.campaignLevelSelect}})}},"Start"),Xa.createElement(Ja,{css:{marginTop:"100px",maxWidth:"500px",width:"100%"},onClick:()=>{(0,Ne.Kn)({type:Te.Type.cleanScene,payload:{newPage:s.customLevelSettings}})}},"Custom Level")),Xa.createElement(Za,{css:{flexDirection:"column",justifyContent:"center",gridRow:"3 / 4",gridColumn:"3 / 3",color:"white",fontSize:"1rem"}},null==t?void 0:t.version))},oo=e=>{var t;"Tab"===e.key&&(null===(t=document.body)||void 0===t||t.classList.add("enable-outline"))},ro=()=>{var e;null===(e=document.body)||void 0===e||e.classList.remove("enable-outline")},no=Ya("div",{display:"grid"}),so=()=>Xa.createElement("svg",{width:"30",height:"30",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{margin:"-9px"}},Xa.createElement("path",{d:"M11.4669 3.72684C11.7558 3.91574 11.8369 4.30308 11.648 4.59198L7.39799 11.092C7.29783 11.2452 7.13556 11.3467 6.95402 11.3699C6.77247 11.3931 6.58989 11.3355 6.45446 11.2124L3.70446 8.71241C3.44905 8.48022 3.43023 8.08494 3.66242 7.82953C3.89461 7.57412 4.28989 7.55529 4.5453 7.78749L6.75292 9.79441L10.6018 3.90792C10.7907 3.61902 11.178 3.53795 11.4669 3.72684Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})),lo=()=>Xa.createElement("svg",{width:"30",height:"30",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{margin:"-9px"}},Xa.createElement("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})),io=(0,Qa.zo)("div",{display:"grid",gap:"1px",maxHeight:"100%",margin:"0 auto",alignItems:"center",alignContent:"center","@bp1":{gap:"3px"}}),po=(0,Qa.zo)("div",{borderWidth:"1px",borderStyle:"solid",borderColor:"black",boxSizing:"border-box",backgroundColor:"white",aspectRatio:"1 / 1","@bp1":{borderWidth:"2px"}}),yo=({gameMap:e})=>{var t,a,o,r,n;return Xa.createElement(io,{css:{gridTemplateColumns:`repeat(${null===(t=e.grid[0])||void 0===t?void 0:t.length}, 1fr)`,gridTemplateRows:`repeat(${(null===(a=e.grid)||void 0===a?void 0:a.length)-1||0}, 1fr)`,aspectRatio:`${null===(o=e.grid)||void 0===o?void 0:o.length} / ${null===(r=e.grid)||void 0===r||null===(n=r[0])||void 0===n?void 0:n.length}`}},e.grid.map(((t,a)=>t.reduce(((o,r,n)=>{var s;if(!r)return o;const l=(null===(s=e.players[r.player??-1])||void 0===s?void 0:s.color)??Et,d=n,i=t.length-a;return[...o,Xa.createElement(po,{key:`${n}-${a}`,css:{gridColumn:`${d+1} / ${d+1}`,gridRow:`${i+1} / ${i+1}`,backgroundColor:`rgb(${255*l[0]},${255*l[1]},${255*l[2]})`}})]}),[]))).flat())},co=(0,Qa.zo)(Va,{overflowX:"auto",gap:"10px",userSelect:"all",pointerEvents:"all",padding:"10px",width:"100%"}),uo=({css:e,gameMaps:t,selectedMapEntity:a})=>{const[o,r]=(0,Xa.useState)(!1);return(0,Xa.useEffect)((()=>{const e=document.querySelector("#mapList");if(!e)return;const t=t=>{e.scrollLeft+=t.deltaY};return null==e||e.addEventListener("wheel",t),()=>{null==e||e.removeEventListener("wheel",t)}}),[]),(0,Xa.useLayoutEffect)((()=>{if(!o){const e=document.querySelector("#mapList"),t=document.querySelector(`#${a??""}`);if(e&&t){const a=t.getBoundingClientRect();e.scrollTo({left:a.left-a.width/2}),e.scrollLeft=a.left-a.width/2,r(!0)}}}),[a,o]),Xa.createElement(co,{id:"mapList",css:e},t.map((e=>Xa.createElement(Ja,{id:e.entity,key:e.entity,css:{padding:"5px",aspectRatio:"1 / 1",height:"100%",border:"none",transition:"0.2s transform, 0.2s background-color",backgroundColor:e.entity===a?"rgba(255,255,255,0.5)":"rgba(255,255,255,0.0)"},onClick:()=>{return t=e.entity,(0,Ne.Kn)({type:Te.Type.changeMapType,payload:{gameMapEntity:t}});var t}},Xa.createElement(yo,{gameMap:e})))))},mo=()=>{var e;const t=to(),a=t&&Me({state:t}),o=null==a?void 0:a.customLevelSettings.mapEntity,n=Object.values(t?(0,pt.C)({state:t,name:r.gameMap})??{}:{}).filter((({campaignNumber:e})=>-1===e));return a&&n?Xa.createElement(_a,{css:{gridTemplateRows:"1fr 1fr 1fr",gridTemplateColumns:"1fr 1fr",gridGap:"1rem",flex:1}},Xa.createElement(uo,{selectedMapEntity:o??"",gameMaps:n,css:{gridRow:"1 / 1",gridColumn:"1 / 3"}}),Xa.createElement(no,{css:{gridTemplateRows:"1fr 1fr 1fr 1fr",gridTemplateColumns:"1fr","@bp2":{gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr 1fr"},gridGap:"0.5rem",gridRow:"2 / 2",gridColumn:"1 / 3"}},Xa.createElement(Ja,{css:{display:"flex",justifyContent:"space-between",gridRow:"1 / 1",gridColumn:"1 / 1",alignSelf:"center"},onClick:()=>(0,Ne.Kn)({type:Te.Type.changeDifficulty,payload:null})},Xa.createElement("div",null,"Difficulty"),Xa.createElement("div",null,(e=>{switch(e){case l.random:return"Random";case l.easy:return"Easy";case l.medium:return"Medium";case l.hard:return"Hard"}})(a.customLevelSettings.difficulty))),Xa.createElement(Ja,{css:{display:"flex",justifyContent:"space-between",gridRow:"2 / 2",gridColumn:"1 / 1",alignSelf:"center","@bp2":{gridRow:"1 / 1",gridColumn:"2 / 2"}},onClick:()=>(0,Ne.Kn)({type:Te.Type.changePlayers,payload:null})},Xa.createElement("div",null,"Players"),Xa.createElement("div",null,null===(e=a.customLevelSettings.players)||void 0===e?void 0:e.length)),Xa.createElement(Ja,{css:{display:"flex",justifyContent:"space-between",gridRow:"3 / 3",gridColumn:"1 / 1",alignSelf:"center","@bp2":{gridRow:"2 / 2",gridColumn:"1 / 1"}},onClick:()=>(0,Ne.Kn)({type:Te.Type.changeQuickStart,payload:null})},Xa.createElement("div",null,"Quick Start"),Xa.createElement("div",null,a.customLevelSettings.quickStart?Xa.createElement(so,null):Xa.createElement(lo,null))),Xa.createElement(Ja,{css:{display:"flex",justifyContent:"space-between",gridRow:"4 / 4",gridColumn:"1 / 1",alignSelf:"center","@bp2":{gridRow:"2 / 2",gridColumn:"2 / 2"}},onClick:()=>(0,Ne.Kn)({type:Te.Type.changeColorBlindMode,payload:null})},Xa.createElement("div",null,"Color Blind Mode"),Xa.createElement("div",null,a.colorBlindMode?Xa.createElement(so,null):Xa.createElement(lo,null)))),Xa.createElement(Va,{css:{flexDirection:"column",justifyContent:"center",gridRow:"3 / 3",gridColumn:"1 / 1"}},Xa.createElement(Ja,{onClick:()=>(0,Ne.Kn)({type:Te.Type.cleanScene,payload:{newPage:s.mainMenu}})},"Back")),Xa.createElement(Va,{css:{flexDirection:"column",justifyContent:"center",gridRow:"3 / 3",gridColumn:"2 / 2"}},Xa.createElement(Ja,{onClick:()=>(0,Ne.Kn)({type:Te.Type.startCustomLevel,payload:null})},"Start"))):null},go=()=>Xa.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xa.createElement("path",{d:"M1.5 3C1.22386 3 1 3.22386 1 3.5C1 3.77614 1.22386 4 1.5 4H13.5C13.7761 4 14 3.77614 14 3.5C14 3.22386 13.7761 3 13.5 3H1.5ZM1 7.5C1 7.22386 1.22386 7 1.5 7H13.5C13.7761 7 14 7.22386 14 7.5C14 7.77614 13.7761 8 13.5 8H1.5C1.22386 8 1 7.77614 1 7.5ZM1 11.5C1 11.2239 1.22386 11 1.5 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7761 13.7761 12 13.5 12H1.5C1.22386 12 1 11.7761 1 11.5Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})),vo=Ya("div",{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"auto"}),fo=(0,Qa.F4)({"0%":{opacity:0,transform:"scale(0.9) translateY(100px)"},"100%":{opacity:1,transform:"scale(1) translateY(0px)"}}),ho=Ya("div",{border:"5px solid black",background:"white",padding:"1rem","@bp1":{width:"80%",height:"40%"},"@bp2":{width:"70%",height:"40%"},"@bp3":{width:"40%",height:"50%"},animation:`${fo.toString()} 300ms`}),bo=({children:e,css:t})=>Xa.createElement(vo,null,Xa.createElement(ho,{css:t},e)),xo=(0,Qa.zo)("div",{backgroundColor:"rgba(255,255,255,0.6)",position:"absolute",top:"0",left:"0",width:"100%",transition:"transform 0.5s cubic-bezier(.77,0,.18,1) 0s",zIndex:"$turnIndicatorHighlighter"}),Eo=e=>`TurnIndicator${e}`,wo=({ai:e})=>{const t=e.find((({hasCurrentTurn:e})=>e))??e[0],a=document.getElementById(Eo((null==t?void 0:t.entity)??"")),o=null==a?void 0:a.getBoundingClientRect(),r=a?[a.offsetLeft,a.offsetTop]:[0,0];return Xa.createElement(Va,{css:{flexDirection:"column",position:"relative"}},Xa.createElement(xo,{css:{transform:`translate(${r[0]}px, ${r[1]}px)`,height:`${(null==o?void 0:o.height)??0}px`}}),e.map((({entity:e,name:t,color:a,active:o})=>Xa.createElement(Va,{id:Eo(e),key:e,css:{alignItems:"center",padding:"0.125rem",paddingRight:"1rem",zIndex:"$turnIndicatorText"}},Xa.createElement(Va,{css:{position:"relative",width:"0.5rem",height:"0.5rem",border:"0.125rem solid black","@bp2":{width:"2rem",height:"2rem",border:"0.25rem solid black"},marginRight:"0.5rem",backgroundColor:`rgb(${255*a[0]}, ${255*a[1]}, ${255*a[2]})`}}),Xa.createElement(Za,{css:{fontSize:"0.75rem",textDecoration:o?"":"line-through",color:o?"$gray900":"$gray700","@bp2":{fontSize:"1.5rem"}}},t)))))},To=(0,Qa.zo)("div",{position:"relative",width:"100%",height:"100%",overflow:"hidden"}),Co=(0,Qa.zo)("svg",{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),Mo=()=>{var e;const t=(0,Xa.useRef)(null),[a,o]=(0,Xa.useState)([]),n=to(),s=n&&Me({state:n}),l=null===(e=t.current)||void 0===e?void 0:e.getBoundingClientRect(),d=(null==l?void 0:l.height)??0,i=(null==l?void 0:l.width)??0;return(0,Xa.useEffect)((()=>{var e,t;const a=(null==s?void 0:s.grid.length)??0,l=(null==s?void 0:s.statistics.length)??0,p=(e=>e?Object.values((0,pt.C)({state:e,name:r.ai})??{}).reduce(((e,t)=>(e[t.entity]=t.color,e)),{}):{})(n),y=null==s||null===(e=s.statistics)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.map((({aiEntity:e},t)=>{const o=p[e]??[0,0,0],r=null==s?void 0:s.statistics.map(((e,o)=>{const{boxesSum:r}=e[t],n=o/(l-1)*i,s=r/a*d,p=((e,t)=>e.slice(0,t).reduce(((e,{boxesSum:t})=>e+t),0))(e,t)/a*d;return`${n},${d-s-p}`}));return{color:o,points:[`0,${d}`,...r,`${i},${d}`].join(" "),aiEntity:e}}));o(y??[])}),[null==s?void 0:s.statistics,null==s?void 0:s.grid.length,n,d,i]),Xa.createElement(To,{ref:t},Xa.createElement(Co,{width:"100%",height:"100%",version:"1.1",viewBox:`0 0 ${i??0} ${d??0}`,preserveAspectRatio:"xMinYMin meet"},[...a].reverse().map((({aiEntity:e,points:t,color:a})=>Xa.createElement("polygon",{key:e,points:t,fill:`rgb(${255*a[0]},${255*a[1]},${255*a[2]})`})))))},ko=({onClose:e})=>Xa.createElement(bo,{css:{display:"flex",flexDirection:"column",justifyContent:"space-around"}},Xa.createElement(Za,{css:{textAlign:"center"}},"Are you sure you want to finish the game?"),Xa.createElement(Va,{css:{justifyContent:"space-evenly"}},Xa.createElement(Ja,{css:{width:"40%"},onClick:()=>{e(!1)}},"No"),Xa.createElement(Ja,{css:{width:"40%"},onClick:()=>{(0,Ne.Kn)({type:Te.Type.cleanScene,payload:{newPage:s.mainMenu}})}},"Yes"))),Lo=()=>Xa.createElement(bo,{css:{display:"flex",flexDirection:"column",justifyContent:"space-around"}},Xa.createElement(Za,{css:{textAlign:"center"}},"You lost"),Xa.createElement(Va,{css:{width:"90%",height:"90%",alignSelf:"center",margin:"1rem"}},Xa.createElement(Mo,null)),Xa.createElement(Va,{css:{justifyContent:"space-evenly"}},Xa.createElement(Ja,{css:{width:"40%"},onClick:()=>{(0,Ne.Kn)({type:Te.Type.cleanScene,payload:{newPage:s.mainMenu}})}},"Back to main menu"),Xa.createElement(Ja,{css:{width:"40%"},onClick:()=>{(0,Ne.Kn)({type:Te.Type.playAgainCustomLevel,payload:null})}},"Play again"))),So=e=>{const t=Me({state:e});return(null==t?void 0:t.playersQueue.map((t=>(0,y.X)({state:e,name:r.ai,entity:t}))).filter((e=>!!e))).map((e=>{let a="";if(e.human)a="You";else switch(e.level){case d.disabled:a="Enemy";break;case d.easy:a="Enemy easy";break;case d.medium:a="Enemy medium";break;case d.hard:a="Enemy hard";break;case d.random:a="Enemy"}return{entity:e.entity,color:e.color,active:e.active,human:e.human,hasCurrentTurn:(null==t?void 0:t.currentPlayer)===e.entity,name:a}}))},Po=()=>Xa.createElement(bo,{css:{display:"flex",flexDirection:"column",justifyContent:"space-around"}},Xa.createElement(Za,{css:{textAlign:"center"}},"You won"),Xa.createElement(Va,{css:{width:"90%",height:"90%",alignSelf:"center",margin:"1rem"}},Xa.createElement(Mo,null)),Xa.createElement(Va,{css:{justifyContent:"space-evenly"}},Xa.createElement(Ja,{css:{width:"40%"},onClick:()=>{(0,Ne.Kn)({type:Te.Type.cleanScene,payload:{newPage:s.mainMenu}})}},"Main menu"),Xa.createElement(Ja,{css:{width:"40%"},onClick:()=>{(0,Ne.Kn)({type:Te.Type.playAgainCustomLevel,payload:null})}},"Play again")));var Io;!function(e){e.playerWon="playerWon",e.playerLost="playerLost",e.gameInProgress="gameInProgress"}(Io||(Io={}));const Ro=()=>{const e=to(),t=e&&Me({state:e}),a=e?So(e):[],[o,n]=(0,Xa.useState)(!1),s=t&&e?(({aiList:e,game:t,state:a})=>{if(!0===t.gameStarted)return Io.gameInProgress;const o=e.find((e=>e.human)),n=t.grid.reduce(((e,t)=>{const n=(0,y.X)({state:a,name:r.box,entity:t});return(null==n?void 0:n.player)===(null==o?void 0:o.entity)?e+1:e}),0);return 0===n?Io.playerLost:n===t.grid.length?Io.playerWon:Io.gameInProgress})({game:t,aiList:a,state:e}):Io.gameInProgress;return Xa.createElement(_a,{css:{gridTemplateRows:"4rem 1fr",gridTemplateColumns:"1fr 4rem",flex:1}},o&&Xa.createElement(ko,{onClose:()=>n(!1)}),s===Io.playerWon&&Xa.createElement(Po,null),s===Io.playerLost&&Xa.createElement(Lo,null),Xa.createElement(Va,{css:{gridRow:"1 / 3",gridColumn:"1 / 1"}},Xa.createElement(wo,{ai:a})),Xa.createElement(Ja,{css:{gridRow:"1 / 1",gridColumn:"2 / 2",display:"flex",alignContent:"center",alignItems:"center",padding:"0.75rem"},onClick:()=>{n(!0)}},Xa.createElement(go,null)))},Bo=()=>Xa.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Xa.createElement("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),Xa.createElement("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})),jo=()=>{const e=to();if(!e)return null;const t=(0,pt.C)({state:e,name:r.gameMap}),a=Object.values(t??{}).filter((({campaignNumber:e})=>-1!==e));return Xa.createElement(_a,{css:{gridTemplateRows:"10fr 1fr",gridTemplateColumns:"1fr",flex:1}},Xa.createElement(no,{css:{gridTemplateColumns:"repeat(4, 1fr)",alignContent:"baseline",gridGap:"0.5rem","@bp2":{gridTemplateColumns:"repeat(10, 1fr)",gridGap:"1rem"}}},a.map((e=>Xa.createElement(Ja,{key:e.entity,onClick:()=>{return!e.locked&&(t=e.entity,(0,Ne.Kn)({type:Te.Type.startCampaignLevel,payload:{mapEntity:t}}));var t},css:{flex:"1",padding:"3px",aspectRatio:"1 / 1",border:"none",transition:"0.2s transform, 0.2s background-color",backgroundColor:"rgba(255,255,255,0.5)"}},e.locked?Xa.createElement(Bo,null):Xa.createElement(yo,{gameMap:e}))))),Xa.createElement(Va,{css:{flexDirection:"column",justifyContent:"center",gridRow:"2 / ",gridColumn:"1 / 1"}},Xa.createElement(Ja,{onClick:()=>(0,Ne.Kn)({type:Te.Type.cleanScene,payload:{newPage:s.mainMenu}})},"Back")))};let qo;!function(e){e.playerWon="playerWon",e.playerLost="playerLost",e.gameInProgress="gameInProgress"}(qo||(qo={}));const Ko=Ya("div",{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"}),No=Ya("div",{border:"5px solid black",background:"rgba(255,255,255,0.9)",padding:"1rem",overflowY:"auto",alignSelf:"end",marginBottom:"10px","@bp1":{width:"80%",height:"20%"},"@bp2":{width:"70%",height:"20%"},"@bp3":{width:"40%",height:"20%"},animation:`${fo.toString()} 300ms`}),Ao=({children:e})=>Xa.createElement(Ko,null,Xa.createElement(No,null,Xa.createElement(Za,null,e))),Oo=({onClose:e})=>Xa.createElement(bo,{css:{display:"flex",flexDirection:"column",justifyContent:"space-around"}},Xa.createElement(Za,{css:{textAlign:"center"}},"Are you sure you want to finish the game?"),Xa.createElement(Va,{css:{justifyContent:"space-evenly"}},Xa.createElement(Ja,{css:{width:"40%"},onClick:()=>{e(!1)}},"No"),Xa.createElement(Ja,{css:{width:"40%"},onClick:()=>{(0,Ne.Kn)({type:Te.Type.cleanScene,payload:{newPage:s.mainMenu}})}},"Yes"))),$o=({nextMapEntity:e})=>Xa.createElement(bo,{css:{display:"flex",flexDirection:"column",justifyContent:"space-around"}},Xa.createElement(Za,{css:{textAlign:"center"}},"You won"),Xa.createElement(Va,{css:{width:"90%",height:"90%",alignSelf:"center",margin:"1rem"}},Xa.createElement(Mo,null)),Xa.createElement(Va,{css:{justifyContent:"space-evenly"}},Xa.createElement(Ja,{css:{width:"40%"},onClick:()=>{(0,Ne.Kn)({type:Te.Type.cleanScene,payload:{newPage:s.campaignLevelSelect}})}},"Levels list"),e?Xa.createElement(Ja,{css:{width:"40%"},onClick:()=>{(0,Ne.Kn)({type:Te.Type.startCampaignLevel,payload:{mapEntity:e}})}},"Next level"):null)),Uo=({state:e,currentCampaignLevelEntity:t})=>{var a,o;const n=(null===(a=(0,y.X)({state:e,entity:t,name:r.gameMap}))||void 0===a?void 0:a.campaignNumber)??0,s=(0,pt.C)({state:e,name:r.gameMap});return null===(o=Object.values(s??{}).find((({campaignNumber:e})=>e===n+1)))||void 0===o?void 0:o.entity},Go=()=>{const e=to(),t=e&&Me({state:e}),a=e&&(0,y.X)({state:e,entity:vt,name:r.tutorial}),o=e?So(e):[],[n,s]=(0,Xa.useState)(!1),l=t&&e?(({aiList:e,game:t,state:a})=>{if(!0===t.gameStarted)return qo.gameInProgress;const o=e.find((e=>e.human)),n=t.grid.reduce(((e,t)=>{const n=(0,y.X)({state:a,name:r.box,entity:t});return(null==n?void 0:n.player)===(null==o?void 0:o.entity)?e+1:e}),0);return 0===n?qo.playerLost:n===t.grid.length?qo.playerWon:qo.gameInProgress})({game:t,aiList:o,state:e}):qo.gameInProgress;return Xa.createElement(_a,{css:{gridTemplateRows:"4rem 1fr",gridTemplateColumns:"1fr 4rem",flex:1}},n&&Xa.createElement(Oo,{onClose:()=>s(!1)}),l===qo.playerWon&&Xa.createElement($o,{nextMapEntity:e?Uo({state:e,currentCampaignLevelEntity:(null==t?void 0:t.currentCampaignLevelEntity)??""}):""}),l===qo.playerLost&&Xa.createElement(Lo,null),(null==a?void 0:a.tipText)&&Xa.createElement(Ao,null,null==a?void 0:a.tipText),Xa.createElement(Va,{css:{gridRow:"1 / 3",gridColumn:"1 / 1"}},Xa.createElement(wo,{ai:o})),Xa.createElement(Ja,{css:{gridRow:"1 / 1",gridColumn:"2 / 2",display:"flex",alignContent:"center",alignItems:"center",padding:"0.75rem"},onClick:()=>{s(!0)}},Xa.createElement(go,null)))},Wo=(0,Qa.zY)({"*":{fontFamily:"Sans-serif",userSelect:"none"},".enable-outline *:focus":{outlineWidth:"10px",outlineStyle:"solid",outlineColor:"$outline"}}),Fo=({state:e})=>{var t;(0,Xa.useEffect)((()=>(window.addEventListener("keydown",oo),()=>{window.removeEventListener("keydown",oo)})),[]),(0,Xa.useEffect)((()=>(window.addEventListener("click",ro),()=>{window.removeEventListener("click",ro)})),[]),Wo();const a=to();switch(null===(t=Me({state:a||e}))||void 0===t?void 0:t.page){case s.mainMenu:return Xa.createElement(ao,null);case s.campaignLevelSelect:return Xa.createElement(jo,null);case s.campaignLevel:return Xa.createElement(Go,null);case s.customLevelSettings:return Xa.createElement(mo,null);case s.customLevel:return Xa.createElement(Ro,null);case void 0:return null}};var Do=a(7307),zo=(a(2920),a(2031)),Xo=a(9469),Qo=a(3607),Yo=a(2587),Ho=a(9509);const Jo=document.getElementById("game"),Vo="humanPlayer",_o=new Do.D(Jo,!0,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1}),Zo=new zo.x(_o);_o.runRenderLoop((()=>{Zo&&Zo.activeCamera&&Zo.render()}));const er=new Xo.x("UniversalCamera",new Re.P(0,0,-1),Zo);er.mode=Qo.V.ORTHOGRAPHIC_CAMERA;const tr=new Yo.e("light",new Re.P(0,0,1),Zo);tr.intensity=1,tr.diffuse=new Le.Wo(1,1,1),tr.specular=new Le.Wo(1,1,1),tr.groundColor=new Le.Wo(1,1,1);{var ar;"serviceWorker"in navigator&&function(e){if("serviceWorker"in navigator){if(new URL(Wa.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t=`${Wa.env.PUBLIC_URL??""}/service-worker.js`;Fa?(function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((a=>{const o=a.headers.get("content-type");404===a.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()})).catch(Ga)})).catch(Ga):Da(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")})).catch(Ga)):Da(t,e)}))}}({onUpdate:Ga,onSuccess:Ga}),Zo.clearColor=new Le.HE(0,0,0,0),null===(ar=document.querySelector("#loader"))||void 0===ar||ar.remove();let e=(({scene:e,camera:t,Vector3:a})=>{var n;let i=(0,Ot.y0)({scene:e,camera:t,Vector3:a,StandardMaterial:Be.K,MeshBuilder:je.V,Texture:g.x,Color3:Le.Wo});(0,Ne.Ib)(Ua),i=(e=>(0,o.FI)({state:e,name:r.box,componentName:r.box,create:Oe,remove:$e}))(i),i=(e=>(0,o.FI)({state:e,name:r.ai,componentName:r.ai}))(i),i=(e=>(0,o.FI)({state:e,name:r.game,componentName:r.game,create:Ee}))(i),i=(e=>(0,o.FI)({state:e,name:r.marker,componentName:r.marker,create:({state:e,component:t})=>{const a=1.4;e=(0,c.L)({state:e,data:(0,De.$e)({entity:t.entity,position:[9999,9999,9999],scale:[a,a,1]})});const o=Xe();return e=(0,c.L)({state:e,data:{entity:t.entity,name:u.f.material,uniqueId:o,diffuseTexture:We,diffuseColor:[1,0,1,0]}}),(0,c.L)({state:e,data:{entity:t.entity,name:u.f.mesh,type:Fe.o.plane,uniqueId:o,width:a,height:a,updatable:!1,sideOrientation:0,materialEntity:[t.entity]}})},remove:({state:e})=>(0,ze.S)({state:e,entity:Ve})}))(i),i=(e=>(0,o.FI)({state:e,name:r.logo,componentName:r.logo,create:st,remove:lt}))(i),i=(e=>(0,o.FI)({state:e,name:r.tutorial,componentName:r.tutorial,create:({state:e})=>{e=(0,c.L)({state:e,data:(0,De.$e)({entity:vt,position:[9999,9999,9999],scale:[1,1,1]})}),e=(0,c.L)({state:e,data:{entity:vt,name:u.f.material,uniqueId:parseInt(ft),diffuseTexture:gt,diffuseColor:[1,1,1,0]}}),e=(0,c.L)({state:e,data:{entity:vt,name:u.f.mesh,type:Fe.o.plane,uniqueId:parseInt(ft),width:1,height:1,updatable:!1,sideOrientation:0,materialEntity:[vt]}});const t=(e=(0,c.L)({state:e,data:{name:u.f.animation,entity:vt,deleteWhenFinished:!1,isPlaying:!0,isFinished:!1,currentTime:0,wrapMode:Fe.f.WrapMode.loop,timingMode:Fe.f.TimingMode.smooth,properties:[{path:"scale",component:u.f.transform,entity:vt,keyframes:[{duration:500,timingFunction:"Linear",valueRange:[[.9,.9,.9],[1.2,1.2,1.2]]},{duration:500,timingFunction:"Linear",valueRange:[[1.2,1.2,1.2],[.9,.9,.9]]}]}]}})).babylonjs.sceneRef;if(t){const e=t.getMeshByUniqueId(parseInt(ft));e&&(e.isPickable=!1)}return e},remove:({state:e})=>(e=(0,ze.S)({state:e,entity:vt}),(0,ze.S)({state:e,entity:ft}))}))(i),i=(0,at.J)({state:i,entity:Vo}),i=(0,c.L)({state:i,data:{entity:Vo,name:r.ai,human:!0,level:d.hard,color:[0,0,1],textureSet:["","","","","","",""],active:!0}});const p=(()=>{const e=JSON.parse(localStorage.getItem(Kt)||"null");if("object"==typeof e&&null!==e){const t=e;let a=l.easy;switch(t.difficulty){case l.easy:a=l.easy;break;case l.medium:a=l.medium;break;case l.hard:a=l.hard;break;case l.random:a=l.random}return{unlockedCampaignMapEntities:t.unlockedCampaignMapEntities??[],difficulty:a,colorBlindMode:(null==t?void 0:t.colorBlindMode)??!1,players:(null==t?void 0:t.players)??qt().slice(0,4),quickStart:(null==t?void 0:t.quickStart)??!0,mapEntity:(null==t?void 0:t.mapEntity)??"",version:(null==t?void 0:t.version)??""}}return{unlockedCampaignMapEntities:[],difficulty:l.easy,colorBlindMode:!1,players:qt().slice(0,4),quickStart:!0,mapEntity:"",version:""}})();i=(({state:e,savedData:t})=>(ka.forEach((a=>{e=(0,at.J)({state:e,entity:a.entity});const o=!t.unlockedCampaignMapEntities.find((e=>e===a.entity));e=(0,c.L)({state:e,data:{name:r.gameMap,...a,locked:!1!==a.locked&&o}})})),e))({state:i,savedData:p});const y=null===(n=Object.values((0,pt.C)({state:i,name:r.gameMap})??{}).find((({campaignNumber:e})=>-1===e)))||void 0===n?void 0:n.entity;return i=(0,at.J)({state:i,entity:we}),i=(0,c.L)({state:i,data:{version:"0.0.24",page:s.mainMenu,lastBoxClickTimestamp:0,entity:we,name:r.game,moves:0,grid:[],turn:0,currentCampaignLevelEntity:"",currentPlayer:Vo,gameStarted:!1,playersQueue:[],boxRotationQueue:[],colorBlindMode:p.colorBlindMode,statistics:[],customLevelSettings:{players:p.players,difficulty:p.difficulty,quickStart:p.quickStart,mapEntity:p.mapEntity||y||""}}}),e&&(i=(0,c.L)({state:i,data:{entity:ot.lw,name:u.f.camera,position:[0,0],distance:5,...$t(5,e)}})),i=mt({state:i,page:s.mainMenu}),i})({scene:Zo,camera:er,Vector3:Re.P});if((({state:e})=>{za.render(Xa.createElement(Xa.StrictMode,null,Xa.createElement(Fo,{state:e})),document.getElementById("gameUi"))})({state:e}),e.babylonjs.sceneRef){const t=()=>{e=(0,Ho.P)({state:e})};e.babylonjs.sceneRef.registerBeforeRender(t)}window.addEventListener("resize",(()=>{(0,Ne.Kn)({type:ot.tP.Type.resize,payload:{}}),_o.resize()}))}}},e=>{e.O(0,[216],(()=>(8502,e(e.s=8502)))),e.O()}]);