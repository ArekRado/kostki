(self.webpackChunkkostki=self.webpackChunkkostki||[]).push([[179],{91:(t,e,n)=>{"use strict";n.d(e,{$z:()=>we,Ah:()=>Ee});var a,r,o=n(385),i=function(){return(i=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},c=function(t,e){return e.find((function(e){return e.name===t}))};(r=a||(a={})).box="box",r.ai="ai",r.game="game";var u,s=function(t){var e,n,a=t.state,r=t.data,o=i(i({},a),{component:i(i({},a.component),(e={},e[r.name]=i(i({},a.component[r.name]),(n={},n[r.entity]=r,n)),e))}),u=c(r.name,a.system);return void 0===u||void 0!==a.component[r.name]&&void 0!==a.component[r.name][r.entity]?o:u.create({state:o,component:r})},f=function(t){var e=t.state,n=t.name,a=d({state:e,name:n});return a?Object.keys(a).reduce((function(t,e){return function(t){var e,n=t.name,a=t.entity,r=t.state,o=r.component[n],u=a,s=(o[u],function(t,e){var n={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(n[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(t);r<a.length;r++)e.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(t,a[r])&&(n[a[r]]=t[a[r]])}return n}(o,["symbol"==typeof u?u:u+""])),f=i(i({},r),{component:i(i({},r.component),(e={},e[n]=s,e))}),d=p({name:n,state:r,entity:a}),l=c(n,f.system);return l&&d?l.remove({state:f,component:d}):f}({name:n,entity:e,state:t})}),e):e},p=function(t){var e=t.name,n=t.entity,a=t.state.component[e];return a?a[n]:void 0},d=function(t){var e=t.name;return t.state.component[e]},l=function(){return(l=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},y=function(t,e){for(var n=0,a=e.length,r=t.length;n<a;n++,r++)t[r]=e[n];return t};!function(t){t[t.last=3]="last",t[t.time=3]="time",t[t.io=2]="io",t[t.transform=1]="transform",t[t.zero=0]="zero",t[t.sprite=-1]="sprite",t[t.draw=-2]="draw"}(u||(u={}));var m,v=function(t){return t.state},b=function(t){var e=t.state,n=t.tick,a=function(t,e){var n={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(n[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(t);r<a.length;r++)e.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(t,a[r])&&(n[a[r]]=t[a[r]])}return n}(t,["state","tick"]),r={name:a.name,priority:a.priority||u.zero,initialize:a.initialize||v,create:a.create||v,tick:function(t){var e=t.state,r=t.eventBuffer,o=e.component[a.name];return o?Object.values(o).reduce((function(t,e){var o=function(t){var e=t.entity,n=t.eventBuffer,a=t.state,r=t.eventHandler,o=t.component;return n[e]?n[e].reduce((function(t,n){if(r){var a=p({state:t,entity:e,name:o.name});return a?r({state:t,event:n,component:a}):t}return t}),a):a}({eventHandler:a.event,state:t,eventBuffer:r,entity:e.entity,component:e});return n?n({state:o,component:e}):o}),e):e},remove:a.remove||v,event:a.event||v};return l(l({},e),{system:y(y([],e.system),[r])})},g=function(){return(g=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},h="first",x={},O={},w=function(t){"first"===h?(x[t.entity]||(x[t.entity]=[]),x[t.entity].push(t)):(O[t.entity]||(O[t.entity]=[]),O[t.entity].push(t))},T=function(){return(T=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};!function(t){t.Type||(t.Type={})}(m||(m={}));var E,P=function(t,e,n){return t&&t[n]?t[n][e]:void 0},A=0,I=10,C=-10,M=-5,k=-4,j=-15,B=50,V=0,R=1,S=2,q=7,L=-5,N=-4,Q=0,z=0;!function(t){t[t.less=-1]="less",t[t.equal=0]="equal",t[t.more=1]="more"}(E||(E={}));var G=function(t){var e=t.state,n=se({state:e});return n?n.grid.reduce((function(t,n){var r=p({name:a.box,state:e,entity:n});if(r){var o=r.gridPosition[0],i=r.gridPosition[1];t[o]||(t[o]=[]),t[o][i]=T(T({},r),{points:0})}return t}),[]):[]},U=function(t){var e=t.dataGrid,n=t.currentPlayer;return e.reduce((function(t,a,r){return t[r]=a.reduce((function(t,a,o){if(a.player!==n&&void 0!==a.player)return t;var i=[[P(e,o-1,r-1),P(e,o,r-1),P(e,o+1,r-1)],[P(e,o-1,r),P(e,o,r),P(e,o+1,r)],[P(e,o-1,r+1),P(e,o,r+1),P(e,o+1,r+1)]],c=function(t){var e=t[1][1];return function(t){return[t[1][0],t[0][1],t[1][2],t[2][1]]}(t).reduce((function(t,n){if(!n)return t+V;var a=e.dots===n.dots?E.equal:e.dots>n.dots?E.more:E.less;if(n.player!==e.player&&void 0!==n.player){if(a===E.more){var r=e.dots-n.dots;return t+A-r}if(a===E.equal)return t+I*e.dots;if(a===E.less)return r=n.dots-e.dots,t+C*r}else{if(6===e.dots)return t;if(a===E.more)return t+M;if(a===E.equal)return 6===n.dots&&6===e.dots?t+B:t+k;if(a===E.less)return 6===n.dots?t+2*j:t+j}return t}),0)}(i)+function(t){var e=t[1][1];return function(t){return[t[0][0],t[0][2],t[2][0],t[2][2]]}(t).reduce((function(t,n){if(!n)return t+z;var a=e.dots===n.dots?E.equal:e.dots>n.dots?E.more:E.less;if(n.player!==e.player&&void 0!==n.player){if(a===E.more)return t+R;if(a===E.equal)return 6===n.dots?t+-10*S:t+S;if(a===E.less)return 6===n.dots?t+2*q:t+q}else{if(6===e.dots)return t;if(a===E.more)return t+L;if(a===E.equal)return t+N;if(a===E.less){var r=n.dots-e.dots;return t+Q+Math.pow(r,2)}}return t}),0)}(i);return t[o]=T(T({},a),{points:a.points+c}),t}),a),t}),e)},D=function(t){var e=t.state,n=t.ai,a=t.preferEmptyBoxes,r=n.entity,o=G({state:e});return o=function(t){var e=t.dataGrid,n=t.preferEmptyBoxes;return e.reduce((function(t,e,a){return t[a]=e.reduce((function(t,e,a){var r=void 0===e.player,o=n?100:0,i=r?e.points+50+o:e.points;return t[a]=T(T({},e),{points:i}),t}),e),t}),e)}({dataGrid:o,preferEmptyBoxes:!!a}),function(t){var e=t.currentPlayer,n=-1/0,a=[];t.dataGrid.forEach((function(t){t.forEach((function(t){var r=void 0===t.player,o=t.player===e;(r||o)&&(t.points>n&&(a=[]),t.points>=n&&(n=t.points,a.push(t)))}))}));var r=Math.floor(Math.random()*a.length);return a[r]}({currentPlayer:r,dataGrid:o=U({currentPlayer:r,dataGrid:o})})};const _=n.p+"d0b02301cf22a066ce5efc6a4d353c4a.png",Y=n.p+"1199d81f91233c5b428d48edeb5efbde.png",H=n.p+"7e640f0339b663753965c7d2b518a274.png",K=n.p+"917ac946784d62fdf0c021cb3612fdb2.png",W=n.p+"48c6631e7335af8fe553f470b80d8976.png",F=n.p+"fece679ff0a36907324c646caf55dd8c.png",$=n.p+"5030d234d3163eca2b8f7a7b4ae5de38.png",J=n.p+"bf30000e751062d61a14f789ff98d211.png",X=n.p+"1e41fdc607aa7739e496651e94c33873.png",Z=n.p+"d949a0fcb5a3df6b7e925bb282a9864c.png",tt=n.p+"6ee0c3c39c0311cef85b1cfc79fd2d85.png",et=n.p+"f7a6779ba4f1319b9642eb3b4ef74086.png",nt=n.p+"705ac6c5ae5713f9343dc873dd267da9.png",at=n.p+"e593bf10d8560f93d523ab53dd42ce63.png",rt=n.p+"933225f4b538f8888ed03abca7494cf3.png",ot=n.p+"e79851835ce027cb15e2c56ff7feae3e.png",it=n.p+"9c92ec43dc64c4c4dd46e523b1abe290.png",ct=n.p+"0da7dc8ec0665e566165da248be0cad8.png",ut=n.p+"beaa728dd1d3231bd65c9c6bf7dfc03b.png",st=n.p+"988c7a2a62df78a626970c546a259442.png",ft=n.p+"a472a634acf5ccf35d372c70a802939c.png",pt=n.p+"caa6a8fe383b064d572ef15125f29b4b.png",dt=n.p+"708b5f6366bfce9801d51e2e2bc4ac5f.png",lt=n.p+"73eefd68fbb861657a80d7d35c158cca.png",yt=n.p+"f2d6950b7e5068555193493083288ae3.png",mt=n.p+"4e7ff01b4581466a224a94674cb6d991.png",vt=n.p+"194a0763a310ec3ade0763015d5ebdd7.png",bt=n.p+"73ca9bf11fff3828b4a3521e26c7744e.png",gt=n.p+"ae73f01b7f1999b0e78aa42cf82ead3b.png",ht=n.p+"15c4c20ee20757841813d78c82986e9d.png",xt=n.p+"fdcc5902d83a55bbedb7eca2983cbd82.png",Ot=n.p+"3e1fd807f95651a6d3c88e1d8520a35a.png",wt=n.p+"0301bf4c80c59b9c9ee82bbfdaa51437.png",Tt=n.p+"0b83c99f83d916e909544806796ad0dc.png",Et=n.p+"91e8f960d9648d8b8ceef7cb4378b7c7.png",Pt=n.p+"13c077ad3452cbd2e1e290e51ebcc4e9.png",At=n.p+"bca44b576aa4bee86d2be532c3a51c1b.png",It=n.p+"08c2fe94f2c53d838910c6392f202d57.png",Ct=n.p+"742dc1ac64405bc3be1a8e12d24f886b.png",Mt=n.p+"ff2c63f3a50c47bae033e36af5b05b2b.png",kt=n.p+"2f56694be17df8c457c7fc70d930cf17.png",jt=n.p+"e48bdf38df8efd30bf9926b3c59d3579.png",Bt=n.p+"a85f2f30cc66206608521873879ea780.png",Vt=n.p+"7aaeea3f7d4d1165af88ec38f1b57f4c.png",Rt=n.p+"229688c1f876adcfd817087efcc2332b.png",St=n.p+"56db8b550dd47587d591f3a663e9aa97.png",qt=n.p+"84a7d3ad3fae05b1f8f8c2a25580396b.png",Lt=n.p+"8393bc8e18c29781118859e303a09012.png",Nt=n.p+"40340f15cafd8836d764f0f6fdc272e8.png";var Qt,zt,Gt=[_,Y,H,K,W,F,$],Ut=[_,J,X,Z,tt,et,nt],Dt=[_,at,rt,ot,it,ct,ut],_t=[_,st,ft,pt,dt,lt,yt],Yt=[_,mt,vt,bt,gt,ht,xt],Ht=[_,Ot,wt,Tt,Et,Pt,At],Kt=[_,It,Ct,Mt,kt,jt,Bt],Wt=[_,Vt,Rt,St,qt,Lt,Nt],Ft=function(){return(Ft=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},$t=function(t,e){for(var n=0,a=e.length,r=t.length;n<a;n++,r++)t[r]=e[n];return t};!function(t){t[t.up=0]="up",t[t.down=1]="down",t[t.left=2]="left",t[t.right=3]="right"}(Qt||(Qt={})),function(t){var e;(e=t.Type||(t.Type={}))[e.onClick=0]="onClick",e[e.rotationEnd=1]="rotationEnd",e[e.rotate=2]="rotate"}(zt||(zt={}));var Jt,Xt=function(t){return t>2*Math.PI||t<-2*Math.PI?-2*Math.PI:t},Zt=function(t){var e=t.state,n=t.ai,a=se({state:e});return(null==a?void 0:a.colorBlindMode)?n.textureSet:Gt},te=function(t){var e=t.entity,n=t.state,a=se({state:n});return a?s({state:n,data:Ft(Ft({},a),{boxRotationQueue:$t($t([],a.boxRotationQueue),[e])})}):n},ee=function(t){var e=t.entity,n=t.animationEndCallback,a=(t.direction,t.color),r=t.texture,i=Ee.getTransformNodeByUniqueId(parseInt(e));if(i){var c=o.Tools.ToRadians(90)*(Math.random()>.5?1:-1),u=Math.random()>.5?"x":"y",s=i.rotation,f=new o.Vector3("x"===u?c:0,"y"===u?c:0,0).add(s),p=new o.Vector3(Xt(f.x),Xt(f.y),Xt(f.z)),d=new o.Animation("rotateAnimation","rotation",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),l=new o.AnimationEvent(.5,n,!0);d.addEvent(l);var y=[];y.push({frame:0,value:s}),y.push({frame:.5,value:p}),d.setKeys(y),i.animations[i.animations.length]=d,Ee.beginAnimation(i,0,1,!1),i.getChildren().slice(0,-1).forEach((function(t){var e=Ee.getMeshByUniqueId(t.uniqueId);e&&(e.material.diffuseColor=new o.Color3(a[0],a[1],a[2]),e.material.diffuseTexture=new o.Texture(r,Ee))}))}},ne=function(t){return 6===t?1:t+1},ae=function(t){var e=t.state,n=t.ai,a=t.box,r=a.entity,o=a.dots;return n&&(o=ne(a.dots),ee({entity:r,animationEndCallback:function(){w({type:zt.Type.rotationEnd,entity:r,payload:{ai:n,shouldExplode:6===a.dots}})},texture:Zt({state:e,ai:n})[o],color:n.color}),e=te({entity:r,state:e})),s({state:e,data:Ft(Ft({},a),{isAnimating:!0,player:(null==n?void 0:n.entity)||"",dots:o})})},re=function(t){var e=t.boxEntity,n=t.texture,a=t.color,r=Ee.getTransformNodeByUniqueId(parseInt(e));r&&(r.rotation.x=0,r.rotation.y=0,r.getChildren().forEach((function(t){var e=Ee.getMeshByUniqueId(t.uniqueId);e&&(e.material.diffuseColor=new o.Color3(a[0],a[1],a[2]),e.material.diffuseTexture=new o.Texture(n,Ee))})))},oe=function(){return(oe=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},ie="game";!function(t){var e;(e=t.Type||(t.Type={}))[e.startLevel=0]="startLevel",e[e.nextTurn=1]="nextTurn",e[e.boxExplosion=2]="boxExplosion",e[e.playerClick=3]="playerClick"}(Jt||(Jt={}));var ce,ue=function(t){var e=t.boxEntity,n=t.markerEntity,a=t.color,r=Ee.getTransformNodeByUniqueId(parseInt(e)),i=Ee.getMeshByUniqueId(parseInt(n));i&&r&&(i.material.diffuseColor=new o.Color3(a[0],a[1],a[2]),i.position=new o.Vector3(r.position.x,r.position.y,r.position.z-1),Ee.beginAnimation(i,0,1,!1))},se=function(t){var e=t.state;return p({state:e,entity:ie,name:a.game})},fe=function(t){var e=t.playersQueue,n=t.index,r=t.state,o=p({state:r,name:a.ai,entity:e[n]});return(null==o?void 0:o.active)?o:fe({playersQueue:e,index:n>=e.length?0:n+1,state:r})},pe=function(t){var e=t.state,n=se({state:e});if(n){var a=n.playersQueue.findIndex((function(t){return n.currentPlayer===t}));return fe({playersQueue:n.playersQueue,index:a+1,state:e})}},de=function(t,e){var n=function(t){var e=t.getEngine().getRenderingCanvasClientRect();return null!==e?e.height/e.width:1}(e),a=e.activeCamera;a&&(n>1?(a.orthoLeft=-t,a.orthoRight=t,a.orthoBottom=a.orthoLeft*n,a.orthoTop=a.orthoRight*n):(a.orthoBottom=-t,a.orthoTop=t,a.orthoLeft=a.orthoBottom/n,a.orthoRight=a.orthoTop/n))},le=function(){return(le=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},ye=function(t){var e=1.2*t[0].length,n=1.2*t.length;return{center:[(e-1-.2)/2,(n-1-.2)/2],cameraDistance:(e>n?e:n)/2+.2}},me=function(){return(me=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},ve={entity:{},component:(ce={},ce[a.box]={},ce[a.ai]={},ce[a.game]={},ce),system:[]},be=ve=function(t){return b({state:t,name:a.game,event:function(t){var e=t.state,n=t.component,r=t.event;switch(r.type){case Jt.Type.startLevel:return function(t){var e=t.state,n=t.component,r=n.currentPlayer,o=(n.grid,n.quickStart),i=p({name:a.ai,state:e,entity:r});if(!i)return e;if(e=s({state:e,data:oe(oe({},n),{gameStarted:!0,currentPlayer:i.entity})}),o&&function(t){var e=t.state,n=se({state:e});n&&n.grid.forEach((function(t){var n=p({state:e,entity:t,name:a.box}),r=p({state:e,entity:(null==n?void 0:n.player)||"",name:a.ai});n&&r&&w({type:zt.Type.rotate,entity:t,payload:{color:r.color,texture:Zt({state:e,ai:r})[n.dots],direction:Qt.up}})}))}({state:e=function(t){var e,n=t.state;return(null===(e=se({state:n}))||void 0===e?void 0:e.grid.reduce((function(t){var e=se({state:t}),n=p({state:t,name:a.ai,entity:(null==e?void 0:e.currentPlayer)||""});if(!e||!n)return t;var r=D({state:t,ai:n,preferEmptyBoxes:!0});if(!r)return t;t=s({state:t,data:oe(oe({},r),{player:n.entity,dots:ne(r.dots)})});var o=pe({state:t});return o?t=s({state:t,data:oe(oe({},e),{currentPlayer:o.entity})}):t}),n))||n}({state:e})}),!i.human){var c=D({state:e,ai:i});c&&(e=ae({box:c,state:e,ai:i}))}return e}({state:e,component:n,event:r});case Jt.Type.nextTurn:return function(t){var e=t.state,n=t.component,r=n.gameStarted,o=n.boxRotationQueue;if(r&&0===o.length){var i=pe({state:e});if(!i)return e;var c=p({name:a.ai,state:e,entity:i.entity});if(!c)return e;if(e=s({state:e,data:oe(oe({},n),{currentPlayer:c.entity})}),!c.human&&c.active){var u=D({state:e,ai:c});if(!u)return function(t){var e=t.state,n=t.ai,r=t.component;e=s({state:e,data:oe(oe({},n),{active:!1})});var o=d({state:e,name:a.ai});return 1===Object.values(o||{}).reduce((function(t,e){return e.active?t+1:t}),0)?s({state:e,data:oe(oe({},r),{gameStarted:!1})}):(w({type:Jt.Type.nextTurn,entity:ie,payload:{ai:n}}),e)}({state:e,component:n,ai:c});ue({boxEntity:u.entity,color:c.color,markerEntity:n.markerEntity}),e=ae({box:u,state:e,ai:c}),e=te({state:e,entity:u.entity})}}return e}({state:e,component:n,event:r});case Jt.Type.playerClick:return function(t){var e=t.state,n=t.component,r=t.event,o=n.currentPlayer,i=n.gameStarted,c=n.boxRotationQueue,u=p({state:e,name:a.box,entity:r.payload.boxEntity}),s=void 0===(null==u?void 0:u.player)||(null==u?void 0:u.player)===o;if(i&&0===c.length&&s){var f=p({name:a.ai,state:e,entity:o});u&&(null==f?void 0:f.human)&&(ue({boxEntity:u.entity,color:f.color,markerEntity:n.markerEntity}),e=ae({box:u,state:e,ai:f}))}return e}({state:e,component:n,event:r})}}})}(ve=function(t){return b({state:t,name:a.ai,create:function(t){var e=t.component,n=t.state;return e.textureSet.forEach((function(t){(new Image).src=t})),n}})}(ve=function(t){return b({state:t,name:a.box,create:function(t){return t.state},event:function(t){var e=t.state,n=t.component,a=t.event;switch(a.type){case zt.Type.rotationEnd:return function(t){var e=t.state,n=t.component,a=t.event.payload,r=a.ai,o=a.shouldExplode;e=function(t){var e=t.entity,n=t.state,a=se({state:n});return a?s({state:n,data:Ft(Ft({},a),{boxRotationQueue:a.boxRotationQueue.filter((function(t){return t!==e}))})}):n}({entity:n.entity,state:e}),re({boxEntity:n.entity,texture:Zt({state:e,ai:r})[n.dots],color:r.color});var i=se({state:e});if(!i)return e;o?e=function(t){var e=t.state,n=t.ai,a=t.box.gridPosition,r=a[0],o=a[1],i=G({state:e});return[P(i,o,r-1),P(i,o,r+1),P(i,o-1,r),P(i,o+1,r)].filter((function(t){return void 0!==t})).reduce((function(t,e,a){return t=ae({ai:n,box:e,state:t}),te({entity:e.entity,state:t})}),e)}({state:e,box:n,ai:r}):0===i.boxRotationQueue.length&&w({type:Jt.Type.nextTurn,entity:ie,payload:{ai:r}});var c=Ee.getTransformNodeByUniqueId(parseInt(n.entity));return c&&(c.animations=[]),s({state:e,data:Ft(Ft({},n),{isAnimating:!1})})}({state:e,component:n,event:a});case zt.Type.rotate:return function(t){var e=t.state,n=t.component,a=t.event;return ee({entity:n.entity,animationEndCallback:function(){re({boxEntity:n.entity,texture:a.payload.texture,color:a.payload.color})},texture:a.payload.texture,color:a.payload.color}),e}({state:e,component:n,event:a})}}})}(ve))),ge=function(){return(ge=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};const he=n.p+"a9e5de2dd68bd2d03d16525655ad7a8b.png";var xe=function(){return(xe=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Oe=document.getElementById("game"),we="humanPlayer",Te=new o.Engine(Oe,!0,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1}),Ee=new o.Scene(Te);Te.runRenderLoop((function(){Ee&&Ee.activeCamera&&Ee.render()}));var Pe=new o.UniversalCamera("UniversalCamera",new o.Vector3(0,0,-1),Ee);Pe.mode=o.Camera.ORTHOGRAPHIC_CAMERA;var Ae=new o.HemisphericLight("light",new o.Vector3(0,0,1),Ee);Ae.intensity=1,Ae.diffuse=new BABYLON.Color3(1,1,1),Ae.specular=new BABYLON.Color3(1,1,1),Ae.groundColor=new BABYLON.Color3(1,1,1);var Ie=function(t){void 0===t&&(t={game:{}});var e=s({state:be,data:{entity:we,name:a.ai,human:!0,level:0,color:[0,0,1],textureSet:["","","","","","",""],active:!0}});return s({state:e,data:ge({entity:ie,name:a.game,grid:[],round:0,currentPlayer:we,gameStarted:!1,playersQueue:[],boxRotationQueue:[],quickStart:!1,colorBlindMode:!1,markerEntity:""},null==t?void 0:t.game)})}({game:{quickStart:!0}}),Ce=Array.from({length:10}).map((function(){return Array.from({length:10}).map((function(){return{player:void 0,dots:0}}))})),Me=function(t,e,n,r){return void 0===r&&(r=!1),{entity:t,name:a.ai,human:r,level:1,color:e,textureSet:n,active:!0}};Ie=function(t){var e=t.state,n=t.ai;e=f({state:e,name:a.ai});var r=se({state:e});return r&&(e=s({state:e,data:me(me({},r),{playersQueue:n.map((function(t){return t.entity}))})})),n.reduce((function(t,e){return s({state:t,data:e})}),e)}({state:Ie=function(t){var e=t.dataGrid,n=t.scene,r=t.camera,i=t.state,c=new o.TransformNode("grid"),u=ye(e),f=u.center,p=u.cameraDistance;r.position.x=f[1],r.position.y=f[0],r.position.z=-10,r.setTarget(new o.Vector3(f[1],f[0])),de(p,n);var d=[];i=e.reduce((function(t,e,r){return e.reduce((function(t,e,i){var u=e.dots,f=e.player,p=function(t){var e=t.scene,n=t.name,a=new o.TransformNode("box "+n,e);return[[new o.Vector3(-.5,0,0),new o.Vector3(0,Math.PI/2,0)],[new o.Vector3(0,0,.5),new o.Vector3(0,Math.PI,0)],[new o.Vector3(.5,0,0),new o.Vector3(0,-Math.PI/2,0)],[new o.Vector3(0,.5,0),new o.Vector3(Math.PI/2,0,0)],[new o.Vector3(0,-.5,0),new o.Vector3(-Math.PI/2,0,0)],[new o.Vector3(0,0,-.5),new o.Vector3(0,0,0)]].forEach((function(t,n){var r=t[0],i=t[1],c=o.Mesh.CreatePlane("plane"+n,1,e,!0);c.parent=a,c.material=new o.StandardMaterial("mat",e),c.material.diffuseColor=o.Color3.White(),c.material.diffuseTexture=new o.Texture(_,e),c.material.alpha=1,c.position=r,c.rotation=i,c.setParent(a),c.actionManager=new o.ActionManager(e),c.actionManager.registerAction(new o.ExecuteCodeAction(o.ActionManager.OnPickUpTrigger,(function(){w({entity:ie,type:Jt.Type.playerClick,payload:{boxEntity:a.uniqueId.toString()}})})))})),a}({scene:n,name:r+"-"+i});p.position.x=1.2*r,p.position.y=1.2*i,p.setParent(c);var l=p.uniqueId.toString();return d.push(l),s({state:t,data:{name:a.box,entity:l,isAnimating:!1,dots:u,gridPosition:[r,i],player:f}})}),t)}),i);var l=se({state:i});return l?i=s({state:i,data:le(le({},l),{grid:d})}):i}({dataGrid:Ce,scene:Ee,camera:Pe,state:Ie}),ai:[Me(we,[.09,.84,1],Gt),Me("2",[.99,.42,.45],Ut),Me("3",[.11,.79,.29],Dt),Me("4",[.99,.97,.32],_t),Me("5",[.1,.73,.29],Yt),Me("6",[.99,.47,.94],Ht),Me("7",[.13,.48,.75],Kt),Me("8",[.67,.23,.94],Wt)]}),Ie=function(t){var e,n,a=t.scene,r=t.state,i=o.Mesh.CreatePlane("marker",1.4,a,!0);i.material=new o.StandardMaterial("material",a),i.material.useAlphaFromDiffuseTexture=!0,i.material.diffuseColor=o.Color3.White(),i.material.diffuseTexture=new o.Texture(he,a),i.material.diffuseTexture.hasAlpha=!0,i.animations[0]=(e=new o.Animation("getScaleAnimation","scaling",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),(n=[]).push({frame:0,value:new o.Vector3(2,2,1)}),n.push({frame:.5,value:new o.Vector3(.9,.9,1)}),e.setKeys(n),e),i.animations[1]=function(){var t=new o.Animation("getAlphaAnimation","material.alpha",1,o.Animation.ANIMATIONTYPE_FLOAT,o.Animation.ANIMATIONLOOPMODE_RELATIVE),e=[];return e.push({frame:0,value:0}),e.push({frame:.5,value:1}),t.setKeys(e),t}();var c=se({state:r});return c?s({state:r,data:xe(xe({},c),{markerEntity:i.uniqueId.toString()})}):r}({scene:Ee,state:Ie}),Ee.registerBeforeRender((function(){Ie=function(t){var e=t.state;h="second",O={};var n=e.system.concat().sort((function(t,e){return t>e?-1:1})).reduce((function(t,e){return e.tick({state:t,eventBuffer:x})}),e);return x={},h="first",x=g({},O),n}({state:Ie})})),window.addEventListener("resize",(function(){de(ye(G({state:Ie})).cameraDistance,Ee),setTimeout((function(){Te.resize()}),1e3)})),w({type:Jt.Type.startLevel,entity:ie,payload:{}})}},t=>{"use strict";t.O(0,[216],(()=>(91,t(t.s=91)))),t.O()}]);