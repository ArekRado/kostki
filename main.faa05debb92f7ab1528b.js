"use strict";(self.webpackChunkkostki=self.webpackChunkkostki||[]).push([[179],{2304:(e,t,a)=>{a.d(t,{$:()=>Ya});var n=a(1361);let o,r,s,l,i;var d;(d=o||(o={})).box="box",d.ai="ai",d.game="game",d.marker="marker",d.background="background",d.logo="logo",d.gameMap="gameMap",function(e){e.mainMenu="mainMenu",e.customLevel="customLevel",e.customLevelSettings="customLevelSettings"}(r||(r={})),function(e){e.mainMenu="mainMenu",e.customLevel="customLevel",e.customLevelSettings="customLevelSettings"}(s||(s={})),function(e){e.disabled="disabled",e.random="random",e.easy="easy",e.medium="medium",e.hard="hard"}(l||(l={})),function(e){e[e.less=-1]="less",e[e.equal=0]="equal",e[e.more=1]="more"}(i||(i={}));var c=a(7455),p=a(5559),y=a(9228),u=a(5431),m=a(4357);const g={},f=({textureUrl:e,scene:t})=>{const a=new m.x(e,t,void 0,void 0,m.x.NEAREST_NEAREST_MIPLINEAR);return g[e]=a,a},v=a.p+"57365b6b32a38acad399fa24be970b62.png",h=a.p+"86711768640182ba9774e66c59e43713.png",b=a.p+"d5fd50f6577249e4bd0a6cedc07b855c.png",x=a.p+"1cece826ef3290f02e8ab121defa70e5.png",E=a.p+"04486ea103fd49156ce128e43c00f4af.png",w=a.p+"4c8888485f10730f523694c6ac7449e4.png",T=a.p+"3bb45fa09a5eb9cd805c7f32aab31591.png",C=a.p+"289b33e3a3e1c125f813747944282bbb.png",S=a.p+"e7015b6db11decc2aa7f722b6eaaa343.png",L=a.p+"7e6aabd8e3d92edca81c0207761816f0.png",M=a.p+"1a202abfbdfbb945f566e890f0e0fa7f.png",P=a.p+"ad7c3be816ce34c76152ecc6c61d263b.png",k=a.p+"8711d0d55135c6a04bf3e76aa6287504.png",R=a.p+"717e6eb5fb82bedfc88f6dc0c65b6f12.png",I=a.p+"16c7f9cc6c2acada16547b3befe94a91.png",B=a.p+"2d2b2519ce6d9ed0c93cd7ed21aed043.png",q=a.p+"7fa7abdc3e479f97ee5f6b283630df03.png",K=a.p+"f3941c38549dddc4a8cb586591e36996.png",j=a.p+"62bd7e3778d77e5ca308fcb5f4b0da78.png",A=a.p+"2f30a46bdc58014e8ba857f895bbe5b8.png",G=a.p+"de0b87223c2e5708366657b7da01c941.png",O=a.p+"54b2699e76fca159c5797b2b93b10bd4.png",U=a.p+"3d713800c02422e02fe02e70f53e9771.png",W=a.p+"2f9682e3f7d362cc3087ef4dcbbdfd2b.png",z=a.p+"62f6adca2ae3c6e088aac66bc47cb54e.png",D=a.p+"9bb2d886948bbd78603ec224904774fd.png",F=a.p+"2d9f8ec02b7087dc45bf61208aacf7a8.png",Q=a.p+"4fd5888696b352601fd6c1f7a1420e1f.png",X=a.p+"d62f41f971620bf90529571efed25c8e.png",N=a.p+"2c7434786497b8ccb02757089a53015a.png",$=a.p+"51f16b6b18086fcc295f8bc02e6c8c45.png",H=a.p+"0dfd6a6b5e5120be13c81ddc1d84a1df.png",J=a.p+"301a367840edef78b86808852d0c067e.png",V=a.p+"d854a7c9f810ebe5be07e17990bd0ee4.png",Y=a.p+"777079c111d24a4a0402f5afbc95b175.png",_=a.p+"e1b39772fd20282e80743b1f04be6795.png",Z=a.p+"24075b75ce25b7869e6559cccca76b75.png",ee=a.p+"698b6e6ce4fcc13dd8ac2cdb9bb484fe.png",te=a.p+"38ca2b18556222743ee8778742514d73.png",ae=a.p+"aebe569c1bf5190e0038b7098791359c.png",ne=a.p+"d1390ce752b5ee52126d21de796a81f8.png",oe=a.p+"d54421100963619575d7b3f35876fdfe.png",re=a.p+"cde379b0a92320968a3826f29eff20fc.png",se=a.p+"d1b88dc4aa017270afbb48ce8c2d93ee.png",le=a.p+"f07f0db4072406727dc668f8f643b725.png",ie=a.p+"f60fcf550b1112ec6a6bb8c80cc4b142.png",de=a.p+"5fded717b6adc588c2dcdedd900f3bea.png",ce=a.p+"ed032e786ebb26ea79c773fd85684876.png",pe=a.p+"7960efbc05f46d226a4e232b391a79ea.png",ye=[v,h,b,x,E,w,T],ue=[v,C,S,L,M,P,k],me=[v,R,I,B,q,K,j],ge=[v,A,G,O,U,W,z],fe=[v,D,F,Q,X,N,$],ve=[v,H,J,V,Y,_,Z],he=[v,ee,te,ae,ne,oe,re],be=[v,se,le,ie,de,ce,pe],xe=({state:e})=>{const t=e.babylonjs.sceneRef;return t?((e=>{setTimeout((()=>{ye.forEach((t=>{const a=new Image;a.src=t,a.onload=()=>{f({textureUrl:t,scene:e})}}))}),2e3*Math.random()+1e3)})(t),e):e},Ee="game";let we;!function(e){let t;!function(e){e.startCustomLevel="GameEvent-startCustomLevel",e.boxExplosion="GameEvent-boxExplosion",e.playerClick="GameEvent-playerClick",e.cleanScene="GameEvent-cleanScene",e.shakeAiBoxes="GameEvent-shakeAiBoxes",e.playAgainCustomLevel="GameEvent-playAgainCustomLevel",e.changePlayers="GameEvent-changePlayers",e.changeDifficulty="GameEvent-changeDifficulty",e.changeQuickStart="GameEvent-changeQuickStart",e.changeColorBlindMode="GameEvent-changeColorBlindMode",e.changeMapType="GameEvent-changeMapType",e.showNewVersion="GameEvent-showNewVersion",e.reload="GameEvent-reload"}(t||(t={})),e.Type=t}(we||(we={}));const Te=(0,u.o)({entity:Ee,name:o.game}),Ce=Te.getComponent,Se=Te.setComponent;var Le=a(2922);const Me=({mesh:e,texture:t,scene:a,color:n})=>{n&&(e.material.diffuseColor=new Le.Wo(n[0],n[1],n[2]));const o=(({textureUrl:e,scene:t})=>g[e]?g[e]:f({textureUrl:e,scene:t}))({textureUrl:t,scene:a});return e.material.diffuseTexture=o,o},Pe=({state:e,ai:t})=>{const a=Ce({state:e});return t&&null!=a&&a.colorBlindMode?t.textureSet:ye};var ke=a(4179),Re=a(5412),Ie=a(5367),Be=a(4510),qe=a(8125),Ke=a(9798),je=a(3052);const Ae=({state:e})=>{const t=Ce({state:e});return t?t.grid.reduce(((t,a)=>{const n=(0,c.X)({name:o.box,state:e,entity:a});if(n){const e=n.gridPosition[0],a=n.gridPosition[1];t[e]||(t[e]=[]),t[e][a]={...n,points:0}}return t}),[]):[]};var Ge=a(2817),Oe=a(8375);const Ue=({percentage:e,total:t})=>t*e,We=()=>Math.floor(1e17*Math.random()),ze=[[1,0,0,1,0,0,1,1,0,0,0,1,1,0,1,1,1,0,1,0,0,1,0,1],[1,0,1,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,1,0,1,0,0,1],[1,1,0,0,0,1,0,0,1,0,1,1,1,0,0,1,0,0,1,1,0,0,0,1],[1,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0,1],[1,0,0,1,0,0,1,1,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,1]].reduce(((e,t,a)=>(e[a]=t.reduce(((e,t,a)=>{if(0===t)e[a]="";else{const t=We().toString();e[a]=t}return e}),[]),e)),[]),De=({state:e,data:t})=>{const a=(0,Ge.bp)({state:e});return(({state:e})=>{if(!e.babylonjs.sceneRef)return e;const t=(0,Ge.bp)({state:e});if(!t)return e;const{topEdge:a,boxSize:n,screenSize:o}=(({state:e,boxScaleFactor:t})=>{const a=(0,Ge.bp)({state:e});return a?{leftEdge:a.position[0]+a.left,topEdge:a.position[1]+a.top,boxSize:Fe/t,screenSize:[2*a.right,2*a.top]}:{leftEdge:0,topEdge:0,boxSize:0,screenSize:[0,0]}})({state:e,boxScaleFactor:3.2}),r=[ze[0].length*n,ze.length*n],s=[t.position[0]-r[0]/2,a-Ue({total:o[1],percentage:.1})];return ze.reduce(((e,t,a)=>t.reduce(((e,t,o)=>{if(""===t)return e;const r=[s[0]+o*n,s[1]+-a*n];return(0,Oe.K)({state:e,name:y.f.transform,entity:t,update:()=>({position:[r[0],r[1]],scale:[.3125,.3125,.3125]})})}),e)),e)})({state:e=(0,Ge.GR)({state:e,data:{...a,...t}})})},Fe=1.2,Qe=({state:e,component:t})=>{const a=e.babylonjs.sceneRef;if(!a)return e;const{gridPosition:n}=t,r=(0,c.X)({state:e,name:o.ai,entity:t.player||""});return e=(0,p.L)({state:e,data:{name:y.f.transform,entity:t.entity,rotation:[0,0,0],fromParentRotation:[0,0,0],scale:[1,1,1],fromParentScale:[1,1,1],position:[n[0]*Fe,-n[1]*Fe],fromParentPosition:[0,0]}}),(({scene:e,name:t,uniqueId:a,color:n,state:o,ai:r,dots:s,isClickable:l,scaleFactor:i=1})=>{const d=1/i,c=new ke.Y(`box ${t}`,e);c.uniqueId=a,[[new Re.P(0,0,-d/2),new Re.P(0,0,0)],[new Re.P(-d/2,0,0),new Re.P(0,Math.PI/2,0)],[new Re.P(0,0,d/2),new Re.P(0,Math.PI,0)],[new Re.P(d/2,0,0),new Re.P(0,-Math.PI/2,0)],[new Re.P(0,d/2,0),new Re.P(Math.PI/2,0,0)],[new Re.P(0,-d/2,0),new Re.P(-Math.PI/2,0,0)]].forEach((([t,i],p)=>{const y=Be.V.CreatePlane("plane"+p.toString(),{size:d});y.parent=c,y.material=new Ie.K("mat",e),Me({mesh:y,color:n,texture:Pe({state:o,ai:r})[s],scene:e}),y.material.alpha=1,y.position=t,y.rotation=i,l&&(y.actionManager=new qe.k(e),y.actionManager.registerAction(new Ke.fQ(qe.k.OnPickUpTrigger,(()=>{(0,je.Kn)({type:we.Type.playerClick,payload:{boxEntity:a.toString()}})}))))}))})({scene:a,name:`${n[0]}-${n[1]}`,uniqueId:parseFloat(t.entity),color:(null==r?void 0:r.color)||[1,1,1],ai:r,dots:t.dots,state:e,isClickable:!0}),e},Xe=({state:e,component:t})=>{if(e.babylonjs.sceneRef){const a=e.babylonjs.sceneRef.getTransformNodeByUniqueId(parseInt(t.entity));null==a||a.dispose()}return e};let Ne,$e;!function(e){e.up="up",e.down="down",e.left="left",e.right="right",e.random="random"}(Ne||(Ne={})),function(e){let t;!function(e){e.onClick="BoxEvent-onClick",e.rotationEnd="BoxEvent-rotationEnd",e.rotateStart="BoxEvent-rotate"}(t||(t={})),e.Type=t}($e||($e={}));const He=a.p+"de1ab0613214552916d369d2014d1d95.png";var Je=a(2646),Ve=a(8141),Ye=a(4281);const _e=e=>e>2*Math.PI||e<-2*Math.PI?-2*Math.PI:e,Ze=Math.PI/2,et=({boxUniqueId:e,direction:t=Ne.random,color:a,texture:n,state:r,nextTurn:s,shouldExplode:l})=>{const i=r.babylonjs.sceneRef;if(!i)return r;const d=i.getTransformNodeByUniqueId(parseInt(e));if(d){r=(0,Oe.K)({state:r,name:o.box,entity:e,update:e=>({...e,isAnimating:!0})});let c=Ze*(Math.random()>.5?1:-1),u=Math.random()>.5?"x":"y";switch(t){case Ne.down:c=-1*Ze,u="x";break;case Ne.up:c=1*Ze,u="x";break;case Ne.right:c=-1*Ze,u="y";break;case Ne.left:c=1*Ze,u="y";break;case Ne.random:c=Ze*(Math.random()>.5?1:-1),u=Math.random()>.5?"x":"y"}d.rotation.z=0;const m=[d.rotation.x,d.rotation.y,d.rotation.z],g=["x"===u?c:0,"y"===u?c:0,m[2]],f=[_e(g[0]+m[0]),_e(g[1]+m[1]),_e(g[2]+m[2])],v={type:$e.Type.rotationEnd,payload:{boxEntity:e,texture:n,color:a,nextTurn:s,shouldExplode:l}};r=(0,p.L)({state:r,data:{name:y.f.animation,entity:e,isPlaying:!0,isFinished:!1,currentTime:0,deleteWhenFinished:!0,wrapMode:Je.f.WrapMode.once,timingMode:Je.f.TimingMode.smooth,properties:[{path:"rotation",component:y.f.transform,entity:e,keyframes:[{duration:500,timingFunction:"Linear",valueRange:[m,f],endFrameEvent:v}]}]}});const h=d.getChildren();h.slice(1,h.length).forEach((e=>{const t=i.getMeshByUniqueId(e.uniqueId);t&&Me({mesh:t,color:a,texture:n,scene:i})}))}return r},tt="38127445920450264";let at;!function(e){let t;!function(e){e.appearAnimationEnd="MarkerEvent-appearAnimationEnd"}(t||(t={})),e.Type=t}(at||(at={}));const nt=(0,u.o)({entity:tt,name:o.marker}),ot=(nt.getComponent,({state:e,data:t})=>{if(e.babylonjs.sceneRef){e=(0,Oe.K)({state:e,name:y.f.material,entity:tt,update:e=>({diffuseColor:t.color?[t.color[0],t.color[1],t.color[2],0]:e.diffuseColor})}),e=(0,Oe.K)({state:e,entity:tt,name:y.f.transform,update:e=>({position:t.position?[t.position[0],t.position[1],-1]:e.position})});const a={type:at.Type.appearAnimationEnd,payload:null};e=(0,p.L)({state:e,data:{name:y.f.animation,entity:tt,deleteWhenFinished:!0,isPlaying:!0,isFinished:!1,currentTime:0,wrapMode:Je.f.WrapMode.once,timingMode:Je.f.TimingMode.smooth,properties:[{path:"scale",component:y.f.transform,entity:tt,keyframes:[{duration:400,timingFunction:"Linear",valueRange:[[2,2,1],[.9,.9,1]],endFrameEvent:a}]},{path:"alpha",component:y.f.material,entity:tt,keyframes:[{duration:400,timingFunction:"Linear",valueRange:[0,1]}]}]}})}return nt.setComponent({state:e,data:t})}),rt=({value:e,min:t,max:a})=>e<=t?t:e>=a?a:e,st=(e,t,a)=>(a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e),lt=[1,1,1],it=[.6,.6,.6],dt=[.11,.79,.29],ct=[.09,.84,1],pt=[1,.73,.29],yt=[.99,.97,.32],ut=[.99,.42,.45],mt=[.99,.47,.94],gt=[.67,.23,.94],ft=(e,t)=>e+Math.random()*t-Math.random()*t,vt=e=>{const t=(([e,t,a])=>{const n=Math.max(e,t,a),o=Math.min(e,t,a);let r,s;const l=(n+o)/2;if(n==o)r=s=0;else{const i=n-o;switch(s=l>.5?i/(2-n-o):i/(n+o),n){case e:r=(t-a)/i+(t<a?6:0);break;case t:r=(a-e)/i+2;break;case a:r=(e-t)/i+4}r/=6}return[r,s,l]})(e),a=[t[0],rt({value:ft(t[1],.2),min:.3,max:1}),rt({value:ft(t[2],.2),min:.3,max:.7})];return(([e,t,a])=>{let n,o,r;if(0==t)n=o=r=a;else{const s=a<.5?a*(1+t):a+t-a*t,l=2*a-s;n=st(l,s,e+1/3),o=st(l,s,e),r=st(l,s,e-1/3)}return[n,o,r]})([a[0],a[1],a[2]])},ht=e=>[vt(e),vt(e),vt(e),vt(e),vt(e),vt(e),vt(e),vt(e),vt(e),vt(e)],bt=(ht(it),ht(dt),ht(ct),ht(pt),ht(yt),ht(ut),ht(mt),ht(gt),(e,t)=>{document.dispatchEvent(new CustomEvent(e,{detail:t}))}),xt="localDbKey",Et=e=>{const t=Ce({state:e});t&&wt({players:t.customLevelSettings.players,difficulty:t.customLevelSettings.difficulty,quickStart:t.customLevelSettings.quickStart,mapType:t.customLevelSettings.mapType,colorBlindMode:t.colorBlindMode})},wt=e=>{localStorage.setItem(xt,JSON.stringify(e))},Tt=(e,t,a,n=!1,r=l.easy)=>({entity:e,name:o.ai,human:n,level:r,color:t,textureSet:a,active:!0}),Ct=()=>[Tt(Ya,ct,ye,!0,l.easy),Tt("2",ut,ue,!1,l.easy),Tt("3",dt,me,!1,l.easy),Tt("4",yt,ge,!1,l.easy),Tt("5",pt,fe,!1,l.easy),Tt("6",mt,ve,!1,l.easy),Tt("7",it,he,!1,l.easy),Tt("8",gt,be,!1,l.easy)];var St=a(9779);const Lt=({state:e})=>e.babylonjs.sceneRef?(e=ze.reduce(((e,t,a)=>t.reduce(((e,t,n)=>""===t?e:(e=(0,St.J)({state:e,entity:t}),(0,p.L)({state:e,data:{name:o.box,entity:t,isAnimating:!1,dots:0,gridPosition:[n,a],player:""}}))),e)),e),e=De({state:e,data:{}}),(0,je.Kn)({type:kt.Type.rotateRandomLogoBox,payload:null}),e):e,Mt=({state:e})=>{const t=e.babylonjs.sceneRef;return t?e=ze.flat().reduce(((e,a)=>{const n=t.getTransformNodeByUniqueId(parseFloat(a));return null==n||n.dispose(),(0,Ye.S)({state:e,entity:a})}),e):e},Pt="8523773494048061";let kt;!function(e){let t;!function(e){e.rotateRandomLogoBox="LogoEvent-rotateRandomLogoBox"}(t||(t={})),e.Type=t}(kt||(kt={}));var Rt=a(9655);const It=({state:e,name:t})=>{const a=(0,Rt.C)({state:e,name:t});return a?Object.keys(a).reduce(((e,t)=>(0,Ye.S)({state:e,entity:t})),e):e},Bt=({state:e,event:t})=>(e=Se({state:e,data:{page:t.payload.newPage,round:0,grid:[],currentPlayer:"",playersQueue:[],boxRotationQueue:[],gameStarted:!1}}),e=It({name:o.box,state:e}),e=It({name:o.ai,state:e}),e=It({name:o.marker,state:e}),e=It({name:o.background,state:e}),e=It({name:o.logo,state:e}),e=qt({state:e,page:t.payload.newPage}),bt("setUIState",e),e),qt=({state:e,page:t})=>(t===s.mainMenu&&(e=(0,Oe.K)({state:e,entity:Ge.lw,name:y.f.camera,update:()=>({position:[0,0],distance:5})}),e=(0,St.J)({state:e,entity:Pt}),e=(0,p.L)({state:e,data:{entity:Pt,name:o.logo}})),e);var Kt=a(3043);const jt=(e,t)=>{const a=(e=>{const t=e.getEngine().getRenderingCanvasClientRect();return null!==t?t.height/t.width:1})(t);return a>1?{left:-e,right:e,bottom:-e*a,top:e*a}:{bottom:-e,top:e,left:-e/a,right:e/a}},At=(e,t,a)=>{var n;return null==e||null===(n=e[a])||void 0===n?void 0:n[t]},Gt=e=>[e[1][0],e[0][1],e[1][2],e[2][1]],Ot=(e,[t,a])=>[[At(e,a-1,t-1),At(e,a,t-1),At(e,a+1,t-1)],[At(e,a-1,t),At(e,a,t),At(e,a+1,t)],[At(e,a-1,t+1),At(e,a,t+1),At(e,a+1,t+1)]],Ut=({entity:e,state:t})=>(0,Oe.K)({state:t,name:o.game,entity:Ee,update:t=>({boxRotationQueue:[...t.boxRotationQueue,e]})}),Wt=e=>6===e?1:e+1,zt=({state:e,ai:t,box:a})=>{const{entity:n}=a,r=Wt(a.dots);return e=et({state:e,boxUniqueId:n,texture:Pe({state:e,ai:t})[r],color:t.color,nextTurn:!0,shouldExplode:6===a.dots}),e=Ut({entity:n,state:e}),(0,Oe.K)({state:e,name:o.box,entity:n,update:()=>({isAnimating:!0,player:(null==t?void 0:t.entity)||"",dots:r})})},Dt={emptyBox:50,preferEmptyBoxes:15,advancedAttack:7,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:10,playerLessThanOponent:-10,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:-15,sixToSix:50,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:2,playerLessThanOponent:7,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:0,toBorder:0}},Ft={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:2,playerLessThanOponent:-2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:1,playerLessThanOponent:2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:0,toBorder:0}},Qt={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:0,playerLessThanOponent:-2,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:5,playerEqualToOponent:0,playerLessThanOponent:5,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:0,toBorder:0}},Xt=({state:e,ai:t,preferEmptyBoxes:a})=>{const n=t.entity,o={[l.disabled]:Qt,[l.random]:Qt,[l.easy]:Qt,[l.medium]:Ft,[l.hard]:Dt}[t.level];let r=Ae({state:e});if(r=(({dataGrid:e,aIGridPoints:t})=>e.reduce(((e,a,n)=>(e[n]=a.reduce(((e,a,n)=>{const o=void 0===a.player?a.points+t.emptyBox:a.points;return e[n]={...a,points:o},e}),a),e)),e))({dataGrid:r,aIGridPoints:o}),r=(({dataGrid:e,currentPlayer:t,preferEmptyBoxes:a,aIGridPoints:n})=>e.reduce(((o,r,s)=>(o[s]=r.reduce(((o,r,l)=>{if(r.player!==t.entity&&void 0!==r.player)return o;const d=Ot(e,[s,l]),c=(({grid3x3:e,preferEmptyBoxes:t,currentPlayer:a,aIGridPoints:n})=>{const o=e[1][1];return Gt(e).reduce(((e,r)=>{if(!r)return e+n.adjacted.toBorder;const s=o.dots===r.dots?i.equal:o.dots>r.dots?i.more:i.less;if(r.player!==o.player&&void 0!==r.player){if(t&&void 0===o.player&&r.player===a.entity)return Math.random()>.5?e+n.preferEmptyBoxes:e;if(s===i.more){const t=o.dots-r.dots;return e+n.adjacted.playerMoreThanOponent-t}if(s===i.equal)return e+n.adjacted.playerEqualToOponent*o.dots;if(s===i.less){const t=o.dots-r.dots-r.dots;return e+n.adjacted.playerLessThanOponent*Math.abs(t)}}else{if(6===o.dots)return e;if(s===i.more)return e+n.adjacted.playerMoreThanPlayer;if(s===i.equal)return 6===r.dots&&6===o.dots?e+n.adjacted.sixToSix:e+n.adjacted.playerEqualToPlayer;if(s===i.less)return 6===r.dots?e+2*n.adjacted.playerLessThanPlayer:e+n.adjacted.playerLessThanPlayer}return e}),0)})({grid3x3:d,preferEmptyBoxes:a,currentPlayer:t,aIGridPoints:n})+(({grid3x3:e,aIGridPoints:t})=>{const a=e[1][1];return(e=>[e[0][0],e[0][2],e[2][0],e[2][2]])(e).reduce(((e,n)=>{if(!n)return e+t.diagonall.toBorder;const o=a.dots===n.dots?i.equal:a.dots>n.dots?i.more:i.less;if(n.player!==a.player&&void 0!==n.player){if(o===i.more)return e+t.diagonall.playerMoreThanOponent;if(o===i.equal)return 6===n.dots?e+-10*t.diagonall.playerEqualToOponent:e+t.diagonall.playerEqualToOponent;if(o===i.less)return 6===n.dots?e+2*t.diagonall.playerLessThanOponent:e+t.diagonall.playerLessThanOponent}else{if(6===a.dots)return e;if(o===i.more)return e+t.diagonall.playerMoreThanPlayer;if(o===i.equal)return e+t.diagonall.playerEqualToPlayer;if(o===i.less){const o=n.dots-a.dots;return e+t.diagonall.playerLessThanPlayer+o**2}}return e}),0)})({grid3x3:d,preferEmptyBoxes:a,currentPlayer:t,aIGridPoints:n});return o[l]={...r,points:r.points+c},o}),r),o)),e))({currentPlayer:t,dataGrid:r,preferEmptyBoxes:!!a,aIGridPoints:o}),!a)switch(t.level){case l.disabled:r=(({dataGrid:e})=>e.reduce(((e,t,a)=>(e[a]=t.reduce(((e,t,a)=>(e[a].player="-1",e)),t),e)),e))({dataGrid:r});break;case l.random:r=(({dataGrid:e,currentPlayer:t})=>e.reduce(((e,a,n)=>(e[n]=a.reduce(((e,a,n)=>(a.player!==t||void 0===a.player||(e[n]={...a,points:100*Math.random()}),e)),a),e)),e))({dataGrid:r,currentPlayer:n});break;case l.hard:r=(({dataGrid:e,currentPlayer:t})=>e.reduce(((a,n,o)=>(a[o]=n.reduce(((a,n,r)=>{if(n.player!==t)return a;const s=Ot(e,[o,r]),l=Gt(s);if(l.some((e=>6===(null==e?void 0:e.dots))))return a;const i=l.reduce(((a,o)=>{if(!o)return a;const r=void 0!==o.player&&o.player!==t,s=n.dots>=o.dots;if(r&&s&&(({currentPlayer:e,adjactedBox:t,dataGrid:a,position:[n,o]})=>{const r=Ot(a,[n,o]);return Gt(r).every((a=>void 0===a||a.player===e||void 0===a.player||a.dots<=t.dots))})({currentPlayer:t,adjactedBox:o,dataGrid:e,position:o.gridPosition})){const e=6/n.dots;a+=o.dots*Dt.advancedAttack/e}return a}),0);return a[r]={...n,points:n.points+i},a}),n),a)),e))({dataGrid:r,currentPlayer:n})}return(({currentPlayer:e,dataGrid:t})=>{let a=-1/0,n=[];t.forEach((t=>{t.forEach((t=>{const o=void 0===t.player,r=t.player===e;(o||r)&&(t.points>a&&(n=[]),t.points>=a&&(a=t.points,n.push(t)))}))}));const o=Math.floor(Math.random()*n.length);return n[o]})({currentPlayer:n,dataGrid:r})},Nt=({playersQueue:e,index:t,state:a})=>{const n=(0,c.X)({state:a,name:o.ai,entity:e[t]});return null!=n&&n.active?n:Nt({playersQueue:e,index:t>=e.length?0:t+1,state:a})},$t=({state:e})=>{const t=Ce({state:e});if(!t)return;const a=t.playersQueue.findIndex((e=>t.currentPlayer===e));return Nt({playersQueue:t.playersQueue,index:a+1,state:e})};var Ht=a(3666);const Jt=({state:e,ai:t})=>{e=(0,Oe.K)({state:e,name:o.ai,entity:t.entity,update:()=>({active:!1})});const a=(0,Rt.C)({state:e,name:o.ai});return 1===Object.values(a||{}).reduce(((e,t)=>t.active?e+1:e),0)?(e=(0,Oe.K)({state:e,name:o.game,entity:Ee,update:()=>({gameStarted:!1})}),bt("setUIState",e),e):e=Vt({state:e})},Vt=({state:e})=>{const t=Ce({state:e});if(!t)return e;const{gameStarted:a,boxRotationQueue:n}=t;if(e=(0,Oe.K)({state:e,name:o.game,entity:Ee,update:()=>{var t;return{lastBoxClickTimestamp:(null===(t=(0,Ht.hK)({state:e}))||void 0===t?void 0:t.timeNow)||0}}}),a&&0===n.length){const t=$t({state:e});if(!t)return e;const a=(0,c.X)({name:o.ai,state:e,entity:t.entity});if(!a)return e;if(e=(0,Oe.K)({state:e,name:o.game,entity:Ee,update:e=>({currentPlayer:a.entity,moves:e.moves+1})}),a.active)if(a.human)0===(({state:e,ai:t})=>{const a=Ce({state:e});return(null==a?void 0:a.grid.reduce(((a,n)=>{const r=(0,c.X)({state:e,name:o.box,entity:n});return(null==r?void 0:r.player)===t.entity?a+1:a}),0))||0})({state:e,ai:a})&&(e=Jt({state:e,ai:a}));else{const t=Xt({state:e,ai:a}),n=(0,c.X)({name:y.f.transform,entity:(null==t?void 0:t.entity)||"",state:e});t?(e=ot({state:e,data:{color:a.color,position:[(null==n?void 0:n.position[0])??0,(null==n?void 0:n.position[1])??0]}}),e=zt({box:t,state:e,ai:a}),e=Ut({state:e,entity:t.entity})):e=Jt({state:e,ai:a})}}return bt("setUIState",e),e},Yt=Math.PI/3,_t=({gridMaxSideLength:e,maxTime:t,direction:a})=>n=>{let o=0,r=Ne.up;switch(a){case"down":o=(e-n[1])/e,r=Ne.down;break;case"up":o=n[1]/e,r=Ne.up;break;case"left":o=(e-n[0])/e,r=Ne.left;break;case"right":o=n[0]/e,r=Ne.right}return{timeout:Math.sin(o*Yt)*t,boxRotationDirection:r}},Zt=e=>{let t=Ne.up;const a=[Math.abs(e[0]),Math.abs(e[1])],n=a[0]>a[1];return e[0]<0&&e[1]<0?t=n?Ne.left:Ne.down:e[0]>0&&e[1]<0?t=n?Ne.right:Ne.down:e[0]<0&&e[1]>0?t=n?Ne.left:Ne.up:e[0]>0&&e[1]>0&&(t=n?Ne.right:Ne.up),t},ea=({gridMaxSideLength:e,maxTime:t,direction:a})=>n=>{const o=[e/2,e/2],r=[o[0]-n[0],o[1]-n[1]],s=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)),l=Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2));let i=0,d=Ne.up;switch(a){case"center":i=l-s,d=Zt([r[0],r[1]]);break;case"outside":i=s,d=Zt([-r[0],-r[1]])}return{timeout:Math.sin(i/l*Yt)*t,boxRotationDirection:d}},ta=({state:e,game:t})=>{const a=(0,c.X)({state:e,name:o.gameMap,entity:t.customLevelSettings.mapType});if(!a)return e;e=(({state:e,ai:t})=>{e=It({state:e,name:o.ai});const a=Ce({state:e});return a&&(e=(0,p.L)({state:e,data:{...a,playersQueue:t.map((({entity:e})=>e))}})),t.reduce(((e,t)=>(e=(0,St.J)({state:e,entity:t.entity}),(0,p.L)({state:e,data:t}))),e)})({state:e=a.grid.reduce(((e,t,a)=>t.reduce(((e,t,n)=>{if(!t)return e;const r=We().toString();e=(0,St.J)({state:e,entity:r}),e=(0,p.L)({state:e,data:{name:o.box,entity:r,isAnimating:!1,dots:0,gridPosition:[n,a],player:void 0}});const s=Ce({state:e});return s?Se({state:e,data:{...s,grid:[...s.grid,r]}}):e}),e)),e),ai:t.customLevelSettings.players.map((e=>({...e,level:t.customLevelSettings.difficulty})))});const{center:n,cameraDistance:r}=(({state:e})=>{const t=Ae({state:e}),a=t[0]?1.2*-t[0].length:1,n=1.2*t.length;return{width:a,height:n,center:[(a+1+.2)/2,(n-1-.2)/2],cameraDistance:(a>n?a:n)/2+.2}})({state:e});return De({state:e,data:{position:[n[0],n[1]],distance:r}})},aa=({state:e})=>{var t,a;const n=Ce({state:e});if(!n)return e;e=ta({state:e,game:n}),e=Se({state:e,data:{currentPlayer:null===(t=$t({state:e}))||void 0===t?void 0:t.entity}});const r=Ce({state:e});null!=r&&r.customLevelSettings.quickStart&&(e=(({state:e})=>{const t=Ce({state:e}),a=(null==t?void 0:t.grid.length)||1,n=a-a%((null==t?void 0:t.customLevelSettings.players.length)||1);return Array.from({length:2*n}).reduce((e=>{const t=Ce({state:e}),a=(0,c.X)({state:e,name:o.ai,entity:(null==t?void 0:t.currentPlayer)||""});if(!t||!a)return e;const n=Xt({state:e,ai:a,preferEmptyBoxes:!0});return n?(e=(0,Oe.K)({state:e,name:o.box,entity:n.entity,update:()=>({player:a.entity,dots:Wt(n.dots)})}),e=(0,Oe.K)({state:e,name:o.game,entity:Ee,update:()=>{var t;return{currentPlayer:(null===(t=$t({state:e}))||void 0===t?void 0:t.entity)||""}}})):e}),e)||e})({state:e})),(({state:e})=>{const t=Ce({state:e}),a=Math.sqrt((null==t?void 0:t.grid.length)||1)-1,n=2e3,r=[ea({gridMaxSideLength:a,maxTime:n,direction:"center"}),ea({gridMaxSideLength:a,maxTime:n,direction:"outside"}),_t({gridMaxSideLength:a,maxTime:n,direction:"left"}),_t({gridMaxSideLength:a,maxTime:n,direction:"right"}),_t({gridMaxSideLength:a,maxTime:n,direction:"down"}),_t({gridMaxSideLength:a,maxTime:n,direction:"up"})],s=r[Math.floor(r.length*Math.random())];null==t||t.grid.forEach((t=>{const a=(0,c.X)({state:e,entity:t,name:o.box}),n=(0,c.X)({state:e,entity:(null==a?void 0:a.player)||"",name:o.ai});if(a&&n){const o=s(a.gridPosition),r=o.timeout+500*Math.random();setTimeout((()=>{(0,je.Kn)({type:$e.Type.rotateStart,payload:{color:n.color,texture:Pe({state:e,ai:n})[a.dots],direction:o.boxRotationDirection,boxEntity:t}})}),r)}}))})({state:e}),e=Se({state:e,data:{gameStarted:!0,page:s.customLevel}});const l=(0,c.X)({state:e,name:o.ai,entity:(null===(a=Ce({state:e}))||void 0===a?void 0:a.currentPlayer)||""});if(l&&!l.human){const t=Xt({state:e,ai:l});t&&(e=zt({box:t,state:e,ai:l}))}return e=(0,St.J)({state:e,entity:tt}),e=(0,p.L)({state:e,data:{entity:tt,name:o.marker,color:[1,1,1],position:[0,0]}}),bt("setUIState",e),l&&setTimeout((()=>{(0,je.Kn)({type:we.Type.shakeAiBoxes,payload:{ai:l}})}),3e3),e=(0,Oe.K)({state:e,name:o.game,entity:Ee,update:()=>{var t;return{lastBoxClickTimestamp:(null===(t=(0,Ht.hK)({state:e}))||void 0===t?void 0:t.timeNow)||0}}})};let na;console.info('ðŸ“ call "window.loadAndMountDevtools()" to open devtools'),window.loadAndMountDevtools=()=>{a.e(216).then(a.bind(a,2420)).then((({debugSystem:e})=>{(0,je.Kn)({type:na.Type.enable,payload:{debugSystem:e}})}))},function(e){let t;!function(e){e.enable="DevtoolsEvent-enable"}(t||(t={})),e.Type=t}(na||(na={}));const oa=({state:e,event:t})=>{switch(t.type){case Ge.tP.Type.resize:return(({state:e})=>De({state:e,data:{}}))({state:e,event:t});case kt.Type.rotateRandomLogoBox:return(({state:e})=>{const t=e.babylonjs.sceneRef,a=(0,c.X)({state:e,name:o.logo,entity:Pt}),n=Ce({state:e});if(!a||!t||!n)return e;const r=(()=>{const e=ze.flat().filter((e=>""!==e));return e[Math.floor(e.length*Math.random())]})(),l=(()=>{const e=Math.floor(ye.length*Math.random());return ye[e]})(),i=(()=>{const e=[lt,...Ct().map((({color:e})=>e))];return e[Math.floor(e.length*Math.random())]})();return e=et({state:e,boxUniqueId:r,texture:l,color:i,nextTurn:!1,shouldExplode:!1}),n.page===s.mainMenu&&setTimeout((()=>{(0,je.Kn)({type:kt.Type.rotateRandomLogoBox,payload:null})}),500*Math.random()+500),e})({state:e,event:t});case we.Type.startCustomLevel:return aa({state:e,event:t});case we.Type.playerClick:return(({state:e,event:t})=>{const a=Ce({state:e});if(!a)return e;const{currentPlayer:n,gameStarted:r,boxRotationQueue:s}=a,l=(0,c.X)({state:e,name:o.box,entity:t.payload.boxEntity}),i=void 0===(null==l?void 0:l.player)||(null==l?void 0:l.player)===n,d=(0,c.X)({name:y.f.transform,entity:t.payload.boxEntity,state:e});if(d&&r&&0===s.length&&i){const t=(0,c.X)({name:o.ai,state:e,entity:n});l&&null!=t&&t.human&&(e=ot({state:e,data:{color:t.color,position:[d.position[0],d.position[1]]}}),e=zt({box:l,state:e,ai:t}))}return e})({state:e,event:t});case we.Type.cleanScene:return Bt({state:e,event:t});case we.Type.changePlayers:return(({state:e})=>{var t,a;const n=Ce({state:e});if(!n)return e;const r=8===(null===(t=n.customLevelSettings.players)||void 0===t?void 0:t.length)?2:(null===(a=n.customLevelSettings.players)||void 0===a?void 0:a.length)+1;return e=(0,Oe.K)({state:e,entity:Ee,name:o.game,update:e=>({customLevelSettings:{...e.customLevelSettings,players:Ct().slice(0,r)}})}),bt("setUIState",e),Et(e),e})({state:e,event:t});case we.Type.changeDifficulty:return(({state:e})=>{const t=Ce({state:e});if(!t)return e;const a=[l.easy,l.medium,l.hard],n=a.findIndex((e=>e===t.customLevelSettings.difficulty)),r=-1===n?a[0]:a[n+1]??a[0];return e=(0,Oe.K)({state:e,entity:Ee,name:o.game,update:e=>({customLevelSettings:{...e.customLevelSettings,difficulty:r}})}),bt("setUIState",e),Et(e),e})({state:e,event:t});case we.Type.changeQuickStart:return(({state:e})=>(e=(0,Oe.K)({state:e,entity:Ee,name:o.game,update:e=>({customLevelSettings:{...e.customLevelSettings,quickStart:!e.customLevelSettings.quickStart}})}),bt("setUIState",e),Et(e),e))({state:e,event:t});case we.Type.changeColorBlindMode:return(({state:e})=>(e=(0,Oe.K)({state:e,entity:Ee,name:o.game,update:e=>({colorBlindMode:!e.colorBlindMode})}),bt("setUIState",e),Et(e),e))({state:e,event:t});case we.Type.changeMapType:return(({state:e,event:{payload:{gameMapEntity:t}}})=>(e=(0,Oe.K)({state:e,entity:Ee,name:o.game,update:e=>({customLevelSettings:{...e.customLevelSettings,mapType:t}})}),bt("setUIState",e),Et(e),e))({state:e,event:t});case we.Type.showNewVersion:return(({state:e})=>e)({state:e,event:t});case we.Type.reload:return(({state:e})=>(window.location.reload(),e))({state:e,event:t});case we.Type.shakeAiBoxes:return(({state:e,event:{payload:{ai:t}}})=>{const a=Ce({state:e}),n=(0,Ht.hK)({state:e});if(!1===(null==a?void 0:a.gameStarted))return e;const r=(null==a?void 0:a.lastBoxClickTimestamp)||0;return((null==n?void 0:n.timeNow)||0)>r+6e3&&(null==a||a.grid.forEach((a=>{const n=(0,c.X)({state:e,name:o.box,entity:a});if(!(0,c.X)({state:e,name:y.f.animation,entity:a})&&(null==n?void 0:n.player)===t.entity&&(0,c.X)({state:e,name:y.f.transform,entity:a})){const t=Math.PI/16;e=(0,p.L)({state:e,data:{name:y.f.animation,entity:a,deleteWhenFinished:!0,isPlaying:!0,isFinished:!1,currentTime:0,wrapMode:Je.f.WrapMode.once,timingMode:Je.f.TimingMode.smooth,properties:[{path:"rotation",component:y.f.transform,entity:a,keyframes:[{duration:150,timingFunction:"Linear",valueRange:[[0,0,0],[0,0,t]]},{duration:300,timingFunction:"Linear",valueRange:[[0,0,t],[0,0,-t]]},{duration:300,timingFunction:"Linear",valueRange:[[0,0,-t],[0,0,0]]},{duration:50,timingFunction:"Linear",valueRange:[[0,0,0],[0,0,0]]}]}]}})}}))),setTimeout((()=>{(0,je.Kn)({type:we.Type.shakeAiBoxes,payload:{ai:t}})}),3e3),e})({state:e,event:t});case we.Type.playAgainCustomLevel:return e=Bt({state:e,event:{type:we.Type.cleanScene,payload:{newPage:s.customLevel}}}),aa({state:e,event:{type:we.Type.startCustomLevel,payload:null}});case $e.Type.rotationEnd:return(({state:e,event:t})=>{const a=e.babylonjs.sceneRef,{boxEntity:n,texture:r,color:s,nextTurn:l,shouldExplode:i}=t.payload,d=(0,c.X)({state:e,name:o.box,entity:n}),p=(0,c.X)({state:e,name:y.f.transform,entity:n});if(!d||!a||!p)return e;e=(({entity:e,state:t})=>(0,Oe.K)({state:t,name:o.game,entity:Ee,update:t=>({boxRotationQueue:t.boxRotationQueue.filter((t=>t!==e))})}))({entity:d.entity,state:e}),e=(0,Oe.K)({state:e,name:y.f.transform,entity:n,update:()=>({rotation:[0,0,0]})});const u=a.getTransformNodeByUniqueId(parseInt(d.entity));u&&u.getChildren().forEach((e=>{const t=a.getMeshByUniqueId(e.uniqueId);t&&Me({mesh:t,color:s,texture:r,scene:a})})),e=(0,Oe.K)({state:e,name:o.box,entity:n,update:()=>({isAnimating:!1})});const m=Ce({state:e}),g=(0,c.X)({state:e,name:o.ai,entity:(null==d?void 0:d.player)||""});return l&&g&&m&&d&&(i?e=(({state:e,ai:t,box:a})=>{const{gridPosition:[n,o]}=a,r=Ae({state:e});return[At(r,o,n-1),At(r,o,n+1),At(r,o-1,n),At(r,o+1,n)].filter((e=>void 0!==e)).reduce(((e,a)=>(e=zt({ai:t,box:a,state:e}),Ut({entity:a.entity,state:e}))),e)})({state:e,box:d,ai:g}):0===m.boxRotationQueue.length&&(e=Vt({state:e}))),e})({state:e,event:t});case $e.Type.rotateStart:return(({state:e,event:t})=>et({state:e,boxUniqueId:t.payload.boxEntity,texture:t.payload.texture,color:t.payload.color,direction:t.payload.direction,nextTurn:!1}))({state:e,event:t});case at.Type.appearAnimationEnd:return(({state:e})=>(0,Oe.K)({state:e,entity:tt,name:y.f.transform,update:()=>({position:[9999,9999,1]})}))({state:e,event:t});case na.Type.enable:return(({state:e,event:{payload:{debugSystem:t}}})=>t(e,"devtools"))({state:e,event:t})}return e},ra=[{entity:"gameMap-1",players:[],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},{entity:"gameMap-2",players:[],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]},{entity:"gameMap-3",players:[],grid:[[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0],[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0],[void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0]]},{entity:"gameMap-4",players:[],grid:[[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},void 0,void 0,{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}],[{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0},{player:-1,dots:0}]]}],sa=()=>{};var la=a(4155);const ia=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function da(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}la.env.PUBLIC_URL="/kostki";var ca=a(3935),pa=a(7294),ya=a(6744);const{styled:ua,css:ma}=(0,ya.Th)({theme:{colors:{outline:"#595cff"},space:{},fontSizes:{},fonts:{},fontWeights:{},lineHeights:{},letterSpacings:{},sizes:{},borderWidths:{},borderStyles:{},radii:{},shadows:{},zIndices:{modal:1},transitions:{}},media:{bp1:"(min-width: 1024px)"}}),ga=ua("button",{border:"5px solid black",background:"white",padding:"10px 7px",fontSize:"1rem",whiteSpace:"nowrap",cursor:"pointer",transition:"0.2s transform",pointerEvents:"auto","&:hover":{transform:"scale(1.05)"},"&:focus":{transform:"scale(0.98)"}}),fa=ua("div",{display:"flex"}),va=ua("div",{display:"grid",maxWidth:"1920px",margin:"0 auto",padding:"0.5rem"}),ha=ua("div",{color:"Black",fontSize:"1.5rem"});let ba;const xa=()=>{const[e,t]=(0,pa.useState)(void 0);return(0,pa.useEffect)((()=>{const e=e=>{e&&(ba=e,t(e))};return((e,t)=>{document.addEventListener("setUIState",(e=>t(e.detail)))})(0,e),()=>{((e,t)=>{document.removeEventListener("setUIState",t)})(0,e)}}),[]),e||ba},Ea=()=>{const e=xa(),t=e&&Ce({state:e});return pa.createElement(va,{css:{gridTemplateRows:"20% 70% 10%",gridTemplateColumns:"20% 60% 20%",flex:1}},pa.createElement(fa,{css:{flexDirection:"column",justifyContent:"center",alignItems:"center",gridRow:"2 / 2",gridColumn:"2 / 3"}},pa.createElement(ga,{css:{maxWidth:"500px",width:"100%"},onClick:()=>{(0,je.Kn)({type:we.Type.cleanScene,payload:{newPage:s.customLevelSettings}})}},"Start"),pa.createElement(ga,{css:{marginTop:"100px",maxWidth:"500px",width:"100%"},onClick:()=>{(0,je.Kn)({type:we.Type.cleanScene,payload:{newPage:s.customLevelSettings}})}},"Custom Level")),pa.createElement(ha,{css:{flexDirection:"column",justifyContent:"center",gridRow:"3 / 4",gridColumn:"3 / 3",color:"white",fontSize:"1rem"}},null==t?void 0:t.version))},wa=e=>{var t;"Tab"===e.key&&(null===(t=document.body)||void 0===t||t.classList.add("enable-outline"))},Ta=()=>{var e;null===(e=document.body)||void 0===e||e.classList.remove("enable-outline")},Ca=ua("div",{display:"grid"}),Sa=()=>pa.createElement("svg",{width:"30",height:"30",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{margin:"-9px"}},pa.createElement("path",{d:"M11.4669 3.72684C11.7558 3.91574 11.8369 4.30308 11.648 4.59198L7.39799 11.092C7.29783 11.2452 7.13556 11.3467 6.95402 11.3699C6.77247 11.3931 6.58989 11.3355 6.45446 11.2124L3.70446 8.71241C3.44905 8.48022 3.43023 8.08494 3.66242 7.82953C3.89461 7.57412 4.28989 7.55529 4.5453 7.78749L6.75292 9.79441L10.6018 3.90792C10.7907 3.61902 11.178 3.53795 11.4669 3.72684Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})),La=()=>pa.createElement("svg",{width:"30",height:"30",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{margin:"-9px"}},pa.createElement("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})),Ma=(0,ya.zo)(fa,{overflowX:"auto",cursor:"grab",gap:"10px",userSelect:"all",pointerEvents:"all",padding:"10px",width:"100%"}),Pa=(0,ya.zo)("div",{display:"grid",gap:"3px",maxHeight:"100%",margin:"0 auto"}),ka=(0,ya.zo)("div",{borderWidth:"2px",borderStyle:"solid",borderColor:"black",boxSizing:"border-box",backgroundColor:"white"}),Ra=()=>{const e=xa(),t=Object.values(e?(0,Rt.C)({state:e,name:o.gameMap})??{}:{});(0,pa.useEffect)((()=>{const e=document.querySelector("#mapList");if(!e)return;const t=t=>{e.scrollLeft+=t.deltaY};return null==e||e.addEventListener("wheel",t),()=>{null==e||e.removeEventListener("wheel",t)}}),[]);const a=e?Ce({state:e}):null,n=null==a?void 0:a.customLevelSettings.mapType;return pa.createElement(Ma,{id:"mapList"},t.map((e=>{var t,a,o,r,s,l;return pa.createElement(ga,{key:e.entity,css:{padding:"5px",aspectRatio:"1 / 1",height:"100%",border:"none",transition:"0.2s transform, 0.2s background-color",backgroundColor:n===e.entity?"rgba(255,255,255,0.5)":"rgba(255,255,255,0.0)"},onClick:()=>{return t=e.entity,(0,je.Kn)({type:we.Type.changeMapType,payload:{gameMapEntity:t}});var t}},pa.createElement(Pa,{css:{gridTemplateColumns:`repeat(${null===(t=e.grid)||void 0===t?void 0:t.length}, 1fr)`,gridTemplateRows:`repeat(${(null===(a=e.grid)||void 0===a||null===(o=a[0])||void 0===o?void 0:o.length)||0}, 1fr)`,aspectRatio:`${null===(r=e.grid)||void 0===r?void 0:r.length} / ${null===(s=e.grid)||void 0===s||null===(l=s[0])||void 0===l?void 0:l.length}`}},e.grid.map(((e,t)=>e.reduce(((e,a,n)=>a?[...e,pa.createElement(ka,{key:`${n}-${t}`,css:{gridColumn:`${n+1} / ${n+1}`,gridRow:`${t+1} / ${t+1}`}})]:e),[]))).flat()))})))},Ia=()=>{var e;const t=xa(),a=t&&Ce({state:t});return a?pa.createElement(va,{css:{gridTemplateRows:"1fr 1fr 1fr",gridTemplateColumns:"1fr 1fr",gridGap:"1rem",flex:1}},pa.createElement(fa,{css:{gridRow:"1 / 1",gridColumn:"1 / 3"}},pa.createElement(Ra,null)),pa.createElement(Ca,{css:{gridTemplateRows:"1fr 1fr 1fr 1fr",gridTemplateColumns:"1fr","@bp1":{gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr 1fr"},gridGap:"0.5rem",gridRow:"2 / 2",gridColumn:"1 / 3"}},pa.createElement(ga,{css:{display:"flex",justifyContent:"space-between",gridRow:"1 / 1",gridColumn:"1 / 1",alignSelf:"center"},onClick:()=>(0,je.Kn)({type:we.Type.changeDifficulty,payload:null})},pa.createElement("div",null,"Difficulty"),pa.createElement("div",null,(e=>{switch(e){case l.disabled:return"Disabled";case l.random:return"Random";case l.easy:return"Easy";case l.medium:return"Medium";case l.hard:return"Hard"}})(a.customLevelSettings.difficulty))),pa.createElement(ga,{css:{display:"flex",justifyContent:"space-between",gridRow:"2 / 2",gridColumn:"1 / 1",alignSelf:"center","@bp1":{gridRow:"1 / 1",gridColumn:"2 / 2"}},onClick:()=>(0,je.Kn)({type:we.Type.changePlayers,payload:null})},pa.createElement("div",null,"Players"),pa.createElement("div",null,null===(e=a.customLevelSettings.players)||void 0===e?void 0:e.length)),pa.createElement(ga,{css:{display:"flex",justifyContent:"space-between",gridRow:"3 / 3",gridColumn:"1 / 1",alignSelf:"center","@bp1":{gridRow:"2 / 2",gridColumn:"1 / 1"}},onClick:()=>(0,je.Kn)({type:we.Type.changeQuickStart,payload:null})},pa.createElement("div",null,"Quick Start"),pa.createElement("div",null,a.customLevelSettings.quickStart?pa.createElement(Sa,null):pa.createElement(La,null))),pa.createElement(ga,{css:{display:"flex",justifyContent:"space-between",gridRow:"4 / 4",gridColumn:"1 / 1",alignSelf:"center","@bp1":{gridRow:"2 / 2",gridColumn:"2 / 2"}},onClick:()=>(0,je.Kn)({type:we.Type.changeColorBlindMode,payload:null})},pa.createElement("div",null,"Color Blind Mode"),pa.createElement("div",null,a.colorBlindMode?pa.createElement(Sa,null):pa.createElement(La,null)))),pa.createElement(fa,{css:{flexDirection:"column",justifyContent:"center",gridRow:"3 / 3",gridColumn:"1 / 1"}},pa.createElement(ga,{onClick:()=>(0,je.Kn)({type:we.Type.cleanScene,payload:{newPage:s.mainMenu}})},"Back")),pa.createElement(fa,{css:{flexDirection:"column",justifyContent:"center",gridRow:"3 / 3",gridColumn:"2 / 2"}},pa.createElement(ga,{onClick:()=>(0,je.Kn)({type:we.Type.startCustomLevel,payload:null})},"Start"))):null},Ba=()=>pa.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},pa.createElement("path",{d:"M1.5 3C1.22386 3 1 3.22386 1 3.5C1 3.77614 1.22386 4 1.5 4H13.5C13.7761 4 14 3.77614 14 3.5C14 3.22386 13.7761 3 13.5 3H1.5ZM1 7.5C1 7.22386 1.22386 7 1.5 7H13.5C13.7761 7 14 7.22386 14 7.5C14 7.77614 13.7761 8 13.5 8H1.5C1.22386 8 1 7.77614 1 7.5ZM1 11.5C1 11.2239 1.22386 11 1.5 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7761 13.7761 12 13.5 12H1.5C1.22386 12 1 11.7761 1 11.5Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})),qa=ua("div",{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"auto"}),Ka=ua("div",{border:"5px solid black",background:"white"}),ja=({children:e,css:t})=>pa.createElement(qa,null,pa.createElement(Ka,{css:t},e)),Aa=({ai:e})=>pa.createElement(fa,{css:{flexDirection:"column"}},e.map((({entity:e,name:t,color:a,hasCurrentTurn:n,active:o})=>pa.createElement(fa,{key:e,css:{alignItems:"center",padding:"0.125rem",paddingRight:"1rem",backgroundColor:n?"rgba(255,255,255,0.6)":""}},pa.createElement(fa,{css:{position:"relative",width:"0.5rem",height:"0.5rem",border:"0.125rem solid black","@bp1":{width:"2rem",height:"2rem",border:"0.25rem solid black"},marginRight:"0.5rem",backgroundColor:`rgb(${255*a[0]}, ${255*a[1]}, ${255*a[2]})`}}),pa.createElement(ha,{css:{fontSize:"0.75rem",textDecoration:o?"":"line-through","@bp1":{fontSize:"1.5rem"}}},t))))),Ga=({onClose:e})=>pa.createElement(ja,{css:{width:"70%",height:"40%",display:"flex",flexDirection:"column",justifyContent:"space-around"}},pa.createElement(ha,{css:{textAlign:"center"}},"Are you sure you want to finish the game?"),pa.createElement(fa,{css:{justifyContent:"space-evenly"}},pa.createElement(ga,{onClick:()=>{e(!1)}},"No"),pa.createElement(ga,{onClick:()=>{(0,je.Kn)({type:we.Type.cleanScene,payload:{newPage:s.mainMenu}})}},"Yes"))),Oa=()=>pa.createElement(ja,{css:{width:"70%",height:"40%",display:"flex",flexDirection:"column",justifyContent:"space-around"}},pa.createElement(ha,{css:{textAlign:"center"}},"You lost"),pa.createElement(fa,{css:{justifyContent:"space-evenly"}},pa.createElement(ga,{onClick:()=>{(0,je.Kn)({type:we.Type.cleanScene,payload:{newPage:s.mainMenu}})}},"Back to main menu"),pa.createElement(ga,{onClick:()=>{(0,je.Kn)({type:we.Type.playAgainCustomLevel,payload:null})}},"Play again"))),Ua=()=>pa.createElement(ja,{css:{width:"70%",height:"40%",display:"flex",flexDirection:"column",justifyContent:"space-around"}},pa.createElement(ha,{css:{textAlign:"center"}},"You won"),pa.createElement(fa,{css:{justifyContent:"space-evenly"}},pa.createElement(ga,{onClick:()=>{(0,je.Kn)({type:we.Type.cleanScene,payload:{newPage:s.mainMenu}})}},"Back to main menu"),pa.createElement(ga,{onClick:()=>{(0,je.Kn)({type:we.Type.playAgainCustomLevel,payload:null})}},"Play again")));var Wa;!function(e){e.playerWon="playerWon",e.playerLost="playerLost",e.gameInProgress="gameInProgress"}(Wa||(Wa={}));const za=()=>{const e=xa(),t=e&&Ce({state:e}),a=e?(e=>{const t=Ce({state:e});return(null==t?void 0:t.playersQueue.map((t=>(0,c.X)({state:e,name:o.ai,entity:t}))).filter((e=>!!e))).map((e=>({entity:e.entity,color:e.color,active:e.active,human:e.human,hasCurrentTurn:(null==t?void 0:t.currentPlayer)===e.entity,name:e.human?"Player":"Computer"})))})(e):[],[n,r]=(0,pa.useState)(!1),s=t&&e?(({aiList:e,game:t,state:a})=>{if(!0===t.gameStarted)return Wa.gameInProgress;const n=e.find((e=>e.human)),r=t.grid.reduce(((e,t)=>{const r=(0,c.X)({state:a,name:o.box,entity:t});return(null==r?void 0:r.player)===(null==n?void 0:n.entity)?e+1:e}),0);return 0===r?Wa.playerLost:r===t.grid.length?Wa.playerWon:Wa.gameInProgress})({game:t,aiList:a,state:e}):Wa.gameInProgress;return pa.createElement(va,{css:{gridTemplateRows:"4rem 1fr",gridTemplateColumns:"1fr 4rem",flex:1}},n&&pa.createElement(Ga,{onClose:()=>r(!1)}),s===Wa.playerWon&&pa.createElement(Ua,null),s===Wa.playerLost&&pa.createElement(Oa,null),pa.createElement(fa,{css:{gridRow:"1 / 3",gridColumn:"1 / 1"}},pa.createElement(Aa,{ai:a})),pa.createElement(ga,{css:{gridRow:"1 / 1",gridColumn:"2 / 2",display:"flex",alignContent:"center",alignItems:"center",padding:"0.75rem"},onClick:()=>{r(!0)}},pa.createElement(Ba,null)))},Da=(0,ya.zY)({"*":{fontFamily:"Sans-serif",userSelect:"none"},".enable-outline *:focus":{outlineWidth:"10px",outlineStyle:"solid",outlineColor:"$outline"}}),Fa=({state:e})=>{var t;(0,pa.useEffect)((()=>(window.addEventListener("keydown",wa),()=>{window.removeEventListener("keydown",wa)})),[]),(0,pa.useEffect)((()=>(window.addEventListener("click",Ta),()=>{window.removeEventListener("click",Ta)})),[]),Da();const a=xa();switch(null===(t=Ce({state:a||e}))||void 0===t?void 0:t.page){case s.mainMenu:return pa.createElement(Ea,null);case s.customLevelSettings:return pa.createElement(Ia,null);case s.customLevel:return pa.createElement(za,null);case void 0:return null}};var Qa=a(7307),Xa=(a(2920),a(2031)),Na=a(9469),$a=a(3607),Ha=a(2587),Ja=a(9509);const Va=document.getElementById("game"),Ya="humanPlayer",_a=new Qa.D(Va,!0,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1}),Za=new Xa.x(_a);_a.runRenderLoop((()=>{Za&&Za.activeCamera&&Za.render()}));const en=new Na.x("UniversalCamera",new Re.P(0,0,-1),Za);en.mode=$a.V.ORTHOGRAPHIC_CAMERA;const tn=new Ha.e("light",new Re.P(0,0,1),Za);tn.intensity=1,tn.diffuse=new Le.Wo(1,1,1),tn.specular=new Le.Wo(1,1,1),tn.groundColor=new Le.Wo(1,1,1);{var an;"serviceWorker"in navigator&&function(e){if("serviceWorker"in navigator){if(new URL(la.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t=`${la.env.PUBLIC_URL??""}/service-worker.js`;ia?(function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((a=>{const n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()})).catch(sa)})).catch(sa):da(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")})).catch(sa)):da(t,e)}))}}({onUpdate:sa,onSuccess:sa}),Za.clearColor=new Le.HE(0,0,0,0),null===(an=document.querySelector("#loader"))||void 0===an||an.remove();let e=(({scene:e,camera:t,Vector3:a})=>{let r=(0,Kt.y0)({scene:e,camera:t,Vector3:a,StandardMaterial:Ie.K,MeshBuilder:Be.V,Texture:m.x,Color3:Le.Wo});(0,je.Ib)(oa),r=(e=>(0,n.FI)({state:e,name:o.box,componentName:o.box,create:Qe,remove:Xe}))(r),r=(e=>(0,n.FI)({state:e,name:o.ai,componentName:o.ai}))(r),r=(e=>(0,n.FI)({state:e,name:o.game,componentName:o.game,create:xe}))(r),r=(e=>(0,n.FI)({state:e,name:o.marker,componentName:o.marker,create:({state:e,component:t})=>{if(!e.babylonjs.sceneRef)return e;const a=1.4;e=(0,p.L)({state:e,data:(0,Ve.$e)({entity:t.entity,position:[9999,9999,9999],scale:[a,a,1]})});const n=We();return e=(0,p.L)({state:e,data:{entity:t.entity,name:y.f.material,uniqueId:n,diffuseTexture:He,diffuseColor:[1,0,1,0]}}),(0,p.L)({state:e,data:{entity:t.entity,name:y.f.mesh,type:Je.o.plane,uniqueId:n,width:a,height:a,updatable:!1,sideOrientation:0,materialEntity:[t.entity]}})},remove:({state:e})=>(0,Ye.S)({state:e,entity:tt})}))(r),r=(e=>(0,n.FI)({state:e,name:o.logo,componentName:o.logo,create:Lt,remove:Mt}))(r),r=(0,St.J)({state:r,entity:Ya}),r=(0,p.L)({state:r,data:{entity:Ya,name:o.ai,human:!0,level:l.hard,color:[0,0,1],textureSet:["","","","","","",""],active:!0}});const i=JSON.parse(localStorage.getItem(xt)||"null");r=(({state:e})=>(ra.forEach((t=>{e=(0,St.J)({state:e,entity:t.entity}),e=(0,p.L)({state:e,data:{name:o.gameMap,...t}})})),e))({state:r});const d=(0,Rt.C)({state:r,name:o.gameMap}),c=Object.keys(d||{})[0]??"";return r=(0,St.J)({state:r,entity:Ee}),r=(0,p.L)({state:r,data:{version:"0.0.15",page:s.mainMenu,lastBoxClickTimestamp:0,entity:Ee,name:o.game,moves:0,grid:[],round:0,currentPlayer:Ya,gameStarted:!1,playersQueue:[],boxRotationQueue:[],colorBlindMode:(null==i?void 0:i.colorBlindMode)??!1,customLevelSettings:{players:(null==i?void 0:i.players)??Ct().slice(0,4),difficulty:(null==i?void 0:i.difficulty)??l.medium,quickStart:(null==i?void 0:i.quickStart)??!0,mapType:(null==i?void 0:i.mapType)??c}}}),e&&(r=(0,p.L)({state:r,data:{entity:Ge.lw,name:y.f.camera,position:[0,0],distance:5,...jt(5,e)}})),r=qt({state:r,page:s.mainMenu}),r})({scene:Za,camera:en,Vector3:Re.P});if((({state:e})=>{ca.render(pa.createElement(pa.StrictMode,null,pa.createElement(Fa,{state:e})),document.getElementById("gameUi"))})({state:e}),e.babylonjs.sceneRef){const t=()=>{e=(0,Ja.P)({state:e})};e.babylonjs.sceneRef.registerBeforeRender(t)}window.addEventListener("resize",(()=>{(0,je.Kn)({type:Ge.tP.Type.resize,payload:{}}),_a.resize()}))}}},e=>{e.O(0,[216],(()=>(2304,e(e.s=2304)))),e.O()}]);