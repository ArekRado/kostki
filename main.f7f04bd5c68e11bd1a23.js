"use strict";(self.webpackChunkkostki=self.webpackChunkkostki||[]).push([[179],{705:(e,t,n)=>{n.d(t,{nS:()=>er,$z:()=>$n,Ah:()=>Xn});var r,a,o=n(385),i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},s=function(e,t){return t.find((function(t){return t.name===e}))};(a=r||(r={})).event="event",a.box="box",a.ai="ai",a.game="game",a.camera="camera",a.marker="marker",a.background="background",a.logo="logo";var c,l,u,d=function(e){var t,n,r=e.state,a=e.data,o=i(i({},r),{component:i(i({},r.component),(t={},t[a.name]=i(i({},r.component[a.name]),(n={},n[a.entity]=a,n)),t))}),c=s(a.name,r.system);if(void 0!==c){if(void 0===r.component[a.name]||void 0===r.component[a.name][a.entity])return c.create({state:o,component:a});if(c.update)return c.update({state:o,component:a})}return o},p=function(e){var t=e.state,n=e.name,r=m({state:t,name:n});return r?Object.keys(r).reduce((function(e,t){return function(e){var t,n=e.name,r=e.entity,a=e.state,o=a.component[n],c=r,l=(o[c],function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(o,["symbol"==typeof c?c:c+""])),u=i(i({},a),{component:i(i({},a.component),(t={},t[n]=l,t))}),d=f({name:n,state:a,entity:r}),p=s(n,u.system);return p&&d?p.remove({state:u,component:d}):u}({name:n,entity:t,state:e})}),t):t},f=function(e){var t=e.name,n=e.entity,r=e.state.component[t];return r?r[n]:void 0},m=function(e){var t=e.name;return e.state.component[t]},v=function(e){var t=e.entity,n=e.name,r=function(e){var r=e.state;return f({state:r,entity:t,name:n})};return{getComponent:r,setComponent:function(e){var a=e.state,o=e.data,s=r({state:a});return s?a=d({state:a,data:i(i({entity:t,name:n},s),o)}):a}}},y={entity:{},component:(c={},c[r.event]={},c[r.box]={},c[r.ai]={},c[r.game]={},c[r.camera]={},c[r.marker]={},c[r.background]={},c[r.logo]={},c),system:[]};!function(e){e.mainMenu="mainMenu",e.customLevel="customLevel",e.customLevelSettings="customLevelSettings"}(l||(l={})),function(e){e.mainMenu="mainMenu",e.customLevel="customLevel",e.customLevelSettings="customLevelSettings"}(u||(u={}));var g,h=function(){return(h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},b=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},w=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e};!function(e){e[e.last=3]="last",e[e.time=3]="time",e[e.io=2]="io",e[e.transform=1]="transform",e[e.zero=0]="zero",e[e.sprite=-1]="sprite",e[e.draw=-2]="draw"}(g||(g={}));var x,T,E=function(e){return e.state},C=function(e){var t=e.state,n=e.tick,r=b(e,["state","tick"]),a={name:r.name,priority:r.priority||g.zero,initialize:r.initialize||E,create:r.create||E,tick:function(e){var t=e.state,a=(e.eventBuffer,t.component[r.name]);return a?Object.values(a).reduce((function(e,t){return n?n({state:e,component:t}):e}),t):t},update:r.update,remove:r.remove||E,event:r.event||E};return h(h({},t),{system:w(w([],t.system),[a])})};!function(e){e.disabled="disabled",e.random="random",e.easy="easy",e.medium="medium",e.hard="hard"}(x||(x={})),function(e){e[e.less=-1]="less",e[e.equal=0]="equal",e[e.more=1]="more"}(T||(T={}));var P={},O=function(e){var t=e.textureUrl,n=e.scene,r=new o.Texture(t,n,void 0,void 0,o.Texture.NEAREST_NEAREST_MIPLINEAR);return P[t]=r,r};const S=n.p+"57365b6b32a38acad399fa24be970b62.png",k=n.p+"86711768640182ba9774e66c59e43713.png",M=n.p+"d5fd50f6577249e4bd0a6cedc07b855c.png",L=n.p+"1cece826ef3290f02e8ab121defa70e5.png",I=n.p+"04486ea103fd49156ce128e43c00f4af.png",B=n.p+"4c8888485f10730f523694c6ac7449e4.png",R=n.p+"3bb45fa09a5eb9cd805c7f32aab31591.png",j=n.p+"289b33e3a3e1c125f813747944282bbb.png",A=n.p+"e7015b6db11decc2aa7f722b6eaaa343.png",q=n.p+"7e6aabd8e3d92edca81c0207761816f0.png",U=n.p+"1a202abfbdfbb945f566e890f0e0fa7f.png",G=n.p+"ad7c3be816ce34c76152ecc6c61d263b.png",V=n.p+"8711d0d55135c6a04bf3e76aa6287504.png",z=n.p+"717e6eb5fb82bedfc88f6dc0c65b6f12.png",N=n.p+"16c7f9cc6c2acada16547b3befe94a91.png",F=n.p+"2d2b2519ce6d9ed0c93cd7ed21aed043.png",W=n.p+"7fa7abdc3e479f97ee5f6b283630df03.png",Q=n.p+"f3941c38549dddc4a8cb586591e36996.png",D=n.p+"62bd7e3778d77e5ca308fcb5f4b0da78.png",_=n.p+"2f30a46bdc58014e8ba857f895bbe5b8.png",H=n.p+"de0b87223c2e5708366657b7da01c941.png",Y=n.p+"54b2699e76fca159c5797b2b93b10bd4.png",Z=n.p+"3d713800c02422e02fe02e70f53e9771.png",K=n.p+"2f9682e3f7d362cc3087ef4dcbbdfd2b.png",$=n.p+"62f6adca2ae3c6e088aac66bc47cb54e.png",J=n.p+"9bb2d886948bbd78603ec224904774fd.png",X=n.p+"2d9f8ec02b7087dc45bf61208aacf7a8.png",ee=n.p+"4fd5888696b352601fd6c1f7a1420e1f.png",te=n.p+"d62f41f971620bf90529571efed25c8e.png",ne=n.p+"2c7434786497b8ccb02757089a53015a.png",re=n.p+"51f16b6b18086fcc295f8bc02e6c8c45.png",ae=n.p+"0dfd6a6b5e5120be13c81ddc1d84a1df.png",oe=n.p+"301a367840edef78b86808852d0c067e.png",ie=n.p+"d854a7c9f810ebe5be07e17990bd0ee4.png",se=n.p+"777079c111d24a4a0402f5afbc95b175.png",ce=n.p+"e1b39772fd20282e80743b1f04be6795.png",le=n.p+"24075b75ce25b7869e6559cccca76b75.png",ue=n.p+"698b6e6ce4fcc13dd8ac2cdb9bb484fe.png",de=n.p+"38ca2b18556222743ee8778742514d73.png",pe=n.p+"aebe569c1bf5190e0038b7098791359c.png",fe=n.p+"d1390ce752b5ee52126d21de796a81f8.png",me=n.p+"d54421100963619575d7b3f35876fdfe.png",ve=n.p+"cde379b0a92320968a3826f29eff20fc.png",ye=n.p+"d1b88dc4aa017270afbb48ce8c2d93ee.png",ge=n.p+"f07f0db4072406727dc668f8f643b725.png",he=n.p+"f60fcf550b1112ec6a6bb8c80cc4b142.png",be=n.p+"5fded717b6adc588c2dcdedd900f3bea.png",we=n.p+"ed032e786ebb26ea79c773fd85684876.png",xe=n.p+"7960efbc05f46d226a4e232b391a79ea.png";var Te,Ee=[S,k,M,L,I,B,R],Ce=[S,j,A,q,U,G,V],Pe=[S,z,N,F,W,Q,D],Oe=[S,_,H,Y,Z,K,$],Se=[S,J,X,ee,te,ne,re],ke=[S,ae,oe,ie,se,ce,le],Me=[S,ue,de,pe,fe,me,ve],Le=[S,ye,ge,he,be,we,xe],Ie=function(e){var t=e.state;return setTimeout((function(){Ee.forEach((function(e){var t=new Image;t.src=e,t.onload=function(){O({textureUrl:e,scene:Xn})}}))}),2e3*Math.random()+1e3),t},Be="game";!function(e){var t;(t=e.Type||(e.Type={})).startCustomLevel="GameEvent-startCustomLevel",t.nextTurn="GameEvent-nextTurn",t.boxExplosion="GameEvent-boxExplosion",t.playerClick="GameEvent-playerClick",t.cleanScene="GameEvent-cleanScene",t.changePlayers="GameEvent-changePlayers",t.changeDifficulty="GameEvent-changeDifficulty",t.changeQuickStart="GameEvent-changeQuickStart",t.changeColorBlindMode="GameEvent-changeColorBlindMode",t.changeMapType="GameEvent-changeMapType",t.showNewVersion="GameEvent-showNewVersion",t.reload="GameEvent-reload"}(Te||(Te={}));var Re,je=v({entity:Be,name:r.game}),Ae=je.getComponent,qe=je.setComponent,Ue=function(e){var t=e.mesh,n=e.texture,r=e.scene,a=e.color;a&&(t.material.diffuseColor=new o.Color3(a[0],a[1],a[2]));var i=function(e){var t=e.textureUrl,n=e.scene;return P[t]?P[t]:O({textureUrl:t,scene:n})}({textureUrl:n,scene:r});return t.material.diffuseTexture=i,i},Ge=function(e){var t=e.state,n=e.ai,r=Ae({state:t});return n&&(null==r?void 0:r.colorBlindMode)?n.textureSet:Ee},Ve=function(e){return e>2*Math.PI||e<-2*Math.PI?-2*Math.PI:e},ze=function(e){var t=e.boxUniqueId,n=e.animationEndCallback,r=(e.direction,e.color),a=e.texture,i=Xn.getTransformNodeByUniqueId(parseInt(t));if(i){var s=o.Tools.ToRadians(90)*(Math.random()>.5?1:-1),c=Math.random()>.5?"x":"y",l=i.rotation,u=new o.Vector3("x"===c?s:0,"y"===c?s:0,0).add(l),d=new o.Vector3(Ve(u.x),Ve(u.y),Ve(u.z)),p=new o.Animation("rotateAnimation","rotation",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),f=new o.AnimationEvent(.5,n,!0);p.addEvent(f);var m=[];m.push({frame:0,value:l}),m.push({frame:.5,value:d}),p.setKeys(m),i.animations[i.animations.length]=p,Xn.beginAnimation(i,0,1,!1);var v=i.getChildren();v.slice(1,v.length).forEach((function(e){var t=Xn.getMeshByUniqueId(e.uniqueId);t&&Ue({mesh:t,color:r,texture:a,scene:Xn})}))}},Ne=function(e){var t=e.boxUniqueId,n=e.texture,r=e.color,a=Xn.getTransformNodeByUniqueId(parseInt(t));a&&(a.rotation.x=0,a.rotation.y=0,a.getChildren().forEach((function(e){var t=Xn.getMeshByUniqueId(e.uniqueId);t&&Ue({mesh:t,color:r,texture:n,scene:Xn})})))},Fe=function(){return(Fe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},We=function(e,t,n){return e&&e[n]?e[n][t]:void 0},Qe=function(e){return[e[1][0],e[0][1],e[1][2],e[2][1]]},De=function(e,t){var n=t[0],r=t[1];return[[We(e,r-1,n-1),We(e,r,n-1),We(e,r+1,n-1)],[We(e,r-1,n),We(e,r,n),We(e,r+1,n)],[We(e,r-1,n+1),We(e,r,n+1),We(e,r+1,n+1)]]},_e=function(){return(_e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},He=function(e){var t=e.state,n=Ae({state:t});return n?n.grid.reduce((function(e,n){var a=f({name:r.box,state:t,entity:n});if(a){var o=a.gridPosition[0],i=a.gridPosition[1];e[o]||(e[o]=[]),e[o][i]=_e(_e({},a),{points:0})}return e}),[]):[]},Ye=function(){return(Ye=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ze=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e},Ke=function(e){var t=e.entity,n=e.state,r=Ae({state:n});return r?d({state:n,data:Ye(Ye({},r),{boxRotationQueue:Ze(Ze([],r.boxRotationQueue),[t])})}):n},$e=function(){return($e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Je=function(e){return 6===e?1:e+1},Xe=function(e){var t=e.state,n=e.ai,r=e.box,a=r.entity,o=r.dots;return n&&(o=Je(r.dots),ze({boxUniqueId:a,animationEndCallback:function(){yn({type:Jt.Type.rotationEnd,payload:{ai:n,shouldExplode:6===r.dots,boxEntity:a}})},texture:Ge({state:t,ai:n})[o],color:n.color}),t=Ke({entity:a,state:t})),d({state:t,data:$e($e({},r),{isAnimating:!0,player:(null==n?void 0:n.entity)||"",dots:o})})},et=function(){return(et=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},tt=function(){return(tt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},nt=function(e){var t=e.value,n=e.min,r=e.max;return t<=n?n:t>=r?r:t},rt=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},at=[1,1,1],ot=[.6,.6,.6],it=[.11,.79,.29],st=[.09,.84,1],ct=[1,.73,.29],lt=[.99,.97,.32],ut=[.99,.42,.45],dt=[.99,.47,.94],pt=[.67,.23,.94],ft=function(e,t){return e+Math.random()*t-Math.random()*t},mt=function(e){var t=function(e){var t,n,r=e[0],a=e[1],o=e[2],i=Math.max(r,a,o),s=Math.min(r,a,o),c=(i+s)/2;if(i==s)t=n=0;else{var l=i-s;switch(n=c>.5?l/(2-i-s):l/(i+s),i){case r:t=(a-o)/l+(a<o?6:0);break;case a:t=(o-r)/l+2;break;case o:t=(r-a)/l+4}t/=6}return[t,n,c]}(e),n=[t[0],nt({value:ft(t[1],.2),min:0,max:1}),nt({value:ft(t[2],.2),min:0,max:1})];return function(e){var t,n,r,a=e[0],o=e[1],i=e[2];if(0==o)t=n=r=i;else{var s=i<.5?i*(1+o):i+o-i*o,c=2*i-s;t=rt(c,s,a+1/3),n=rt(c,s,a),r=rt(c,s,a-1/3)}return[t,n,r]}([n[0],n[1],n[2]])},vt=function(e){return[mt(e),mt(e),mt(e),mt(e),mt(e),mt(e),mt(e),mt(e),mt(e),mt(e)]},yt=(vt(ot),vt(it),vt(st)),gt=(vt(ct),vt(lt),vt(ut),vt(dt),vt(pt),function(){return(gt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)}),ht=function(e,t,n,a,o){return void 0===a&&(a=!1),void 0===o&&(o=x.easy),{entity:e,name:r.ai,human:a,level:o,color:t,textureSet:n,active:!0}},bt=function(){return[ht($n,st,Ee,!0,x.easy),ht("2",ut,Ce,!1,x.easy),ht("3",it,Pe,!1,x.easy),ht("4",lt,Oe,!1,x.easy),ht("5",ct,Se,!1,x.easy),ht("6",dt,ke,!1,x.easy),ht("7",ot,Me,!1,x.easy),ht("8",pt,Le,!1,x.easy)]},wt=function(e){var t=Xn.getMeshByUniqueId(parseFloat(Tt)),n=Gt({state:e});if(t&&n){var r=zt(n.distance,Xn);t.position.x=n.position[0],t.position.y=n.position[1],t.scaling=new o.Vector3(Math.abs(r.left)+Math.abs(r.right),Math.abs(r.bottom)+Math.abs(r.top),1)}return e},xt=function(e){var t=e.state;e.component,o.Effect.ShadersStore.customVertexShader=" \n    precision highp float;\n    precision highp int;\n\n    // Attributes\n    attribute vec3 position;\n    attribute vec2 uv;\n\n    // Uniforms\n    uniform mat4 worldViewProjection;\n\n    // Varying\n    varying vec2 vUV;\n\n    void main(void) {\n        gl_Position = worldViewProjection * vec4(position, 1);\n        vUV = uv;\n    }\n  ",o.Effect.ShadersStore.customFragmentShader="\n    precision highp float;\n    precision highp int;\n\n    uniform highp float iTime;\n    uniform vec2 iResolution;\n    uniform highp float[30] iColors;\n\n    // const vec2 iResolution = vec2(512, 512);\n    \n    struct RadialGradient {\n        float radius;\n        vec4 color;\n        vec2 point;\n    };\n  \n    void main(void) {\n        float w = iResolution.x / 2.;\n        float h = iResolution.y / 2.;\n  \n        float fill = max(iResolution.x, iResolution.y);\n        // float contain = min(iResolution.x, iResolution.y);\n\n        highp vec4 colors[10];\n        colors[0] = vec4(iColors[0],iColors[1],iColors[2], 0.7);\n        colors[1] = vec4(iColors[3],iColors[4],iColors[5], 0.7);\n        colors[2] = vec4(iColors[6],iColors[7],iColors[8], 0.7);\n        colors[3] = vec4(iColors[9],iColors[10],iColors[11], 0.7);\n        colors[4] = vec4(iColors[12],iColors[13],iColors[14], 0.7);\n        colors[5] = vec4(iColors[15],iColors[16],iColors[17], 0.7);\n        colors[6] = vec4(iColors[18],iColors[19],iColors[20], 0.7);\n        colors[7] = vec4(iColors[21],iColors[22],iColors[23], 0.7);\n        colors[8] = vec4(iColors[24],iColors[25],iColors[26], 0.7);\n        colors[9] = vec4(iColors[27],iColors[28],iColors[29], 0.7);\n        \n  \n        // gradients\n        RadialGradient gradients[] = RadialGradient[](\n            RadialGradient(1.0, colors[0], vec2(0.5 * w * sin(.13 * iTime - 0.44) + w, 0.5 * h * sin(.34 * iTime - 2.41) + h)),\n            RadialGradient(1.0, colors[1], vec2(0.5 * w * sin(.93 * iTime - 5.58) + w, 1.0 * h * sin(.82 * iTime - 3.04) + h)),\n            RadialGradient(1.0, colors[2], vec2(1.0 * w * sin(.45 * iTime - 2.70) + w, 0.5 * h * sin(.94 * iTime - 5.24) + h)),\n            RadialGradient(1.0, colors[3], vec2(1.0 * w * sin(.15 * iTime - 3.59) + w, 1.0 * h * sin(.96 * iTime - 5.11) + h)),\n            RadialGradient(1.0, colors[4], vec2(0.5 * w * sin(.35 * iTime - 4.73) + w, 0.5 * h * sin(.42 * iTime - 3.87) + h)),\n            RadialGradient(1.0, colors[5], vec2(0.5 * w * sin(.62 * iTime - 4.81) + w, 1.0 * h * sin(.19 * iTime - 1.17) + h)),\n            RadialGradient(1.0, colors[6], vec2(1.0 * w * sin(.58 * iTime - 5.13) + w, 0.5 * h * sin(.10 * iTime - 2.08) + h)),\n            RadialGradient(0.5, colors[7], vec2(1.5 * w * sin(.12 * iTime - 4.36) + w * 2., 0.5 * h * sin(.08 * iTime - 1.48) + h * 2.)),\n            RadialGradient(0.6, colors[8], vec2(1.5 * w * sin(.07 * iTime - 3.94) + w * 2., 0.6 * h * sin(.03 * iTime - 2.03) + h * 2.)),\n            RadialGradient(0.5, colors[9], vec2(1.5 * w * sin(.01 * iTime - 3.74) + w * 2., 0.5 * h * sin(.12 * iTime - 0.62) + h * 2.))\n        );\n  \n        vec3 color = vec3(0.);\n  \n        for(int i = 0; i < gradients.length(); ++i) {\n            color = mix(\n                gradients[i].color.rgb,\n                color,\n                gradients[i].color.a * distance(gradients[i].point, gl_FragCoord.xy) / ( fill * gradients[i].radius)\n            );\n        }\n  \n        gl_FragColor = vec4(color,1.0);\n    }\n  ";var n=new o.ShaderMaterial("shader",Xn,{vertex:"custom",fragment:"custom"},{attributes:["position","normal","uv"],uniforms:["worldViewProjection","time","resolution","gridSize","colors","gridColors"]});n.setFloat("time",performance.now()),n.setVector3("resolution",new o.Vector3(window.innerWidth,window.innerHeight,0)),n.backFaceCulling=!1;var r=o.MeshBuilder.CreatePlane(Tt,{size:1},Xn);r.uniqueId=parseFloat(Tt),r.material=n;var a=bt();return r.material.setColor3Array("colors",a.map((function(e){var t=e.color,n=t[0],r=t[1],a=t[2];return new o.Color3(n,r,a)}))),wt(t)},Tt="17818552155683748",Et=v({entity:Tt,name:r.background}),Ct=(Et.getComponent,function(e){var t=e.percentage;return e.total*t}),Pt=1.2,Ot=function(){return Math.floor(1e17*Math.random())},St=[[1,0,0,1,0,0,1,1,0,0,0,1,1,0,1,1,1,0,1,0,0,1,0,1],[1,0,1,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,1,0,1,0,0,1],[1,1,0,0,0,1,0,0,1,0,1,1,1,0,0,1,0,0,1,1,0,0,0,1],[1,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0,1],[1,0,0,1,0,0,1,1,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,1]].reduce((function(e,t,n){return e[n]=t.reduce((function(e,t,n){if(0===t)e[n]="";else{var r=Ot().toString();e[n]=r}return e}),[]),e}),[]),kt=function(e){var t=e.state,n=Xn.getTransformNodeByUniqueId(parseFloat(It)),r=Gt({state:t});if(n&&r){var a=function(e){var t=e.boxScaleFactor,n=Gt({state:e.state});return n?{leftEdge:n.position[0]+n.left,topEdge:n.position[1]+n.top,boxSize:Pt/t,screenSize:[2*n.right,2*n.top]}:{leftEdge:0,topEdge:0,boxSize:0,screenSize:[0,0]}}({state:t,boxScaleFactor:3.2}),o=a.topEdge,i=a.boxSize,s=a.screenSize,c=[St[0].length*i,St.length*i],l=[r.position[0]-c[0]/2,o-Ct({total:s[1],percentage:.1})];St.forEach((function(e,t){return e.forEach((function(e,r){if(""!==e){var a=Xn.getTransformNodeByUniqueId(parseFloat(e));if(a){var o=[l[0]+r*i,l[1]+-t*i];a.position.x=n.position.x+o[0],a.position.y=n.position.y+o[1]}}}))}))}},Mt=function(e){var t=e.state,n=new o.TransformNode("logo",Xn);return n.uniqueId=parseFloat(It),n.position.x=0,n.position.y=0,function(e){var t=e.state;St.forEach((function(e,n){return e.forEach((function(e,n){""!==e&&hn({scene:Xn,name:"logo box",uniqueId:parseFloat(e),position:[0,0],color:[1,1,1],state:t,ai:void 0,dots:0,isClickable:!1,scaleFactor:3.2})}))}))}({state:t}),kt({state:t}),yn({type:Re.Type.rotateBox,payload:{}}),t},Lt=function(e){var t=e.state,n=Xn.getTransformNodeByUniqueId(parseFloat(It));return null==n||n.dispose(),St.flat().forEach((function(e){var t=Xn.getTransformNodeByUniqueId(parseFloat(e));null==t||t.dispose()})),t},It="8523773494048061";!function(e){(e.Type||(e.Type={})).rotateBox="rotateBox"}(Re||(Re={}));var Bt,Rt=v({entity:It,name:r.logo}),jt=Rt.getComponent,At=function(){return(At=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},qt="cameraEntity";!function(e){(e.Type||(e.Type={})).resize="CameraEvent-resize"}(Bt||(Bt={}));var Ut=v({entity:qt,name:r.camera}),Gt=Ut.getComponent,Vt=function(e){var t,n=e.state,r=e.data,a=function(e){var t,n=e.component;n.position&&(er.position.x=n.position[1],er.position.y=n.position[0],er.position.z=-10,er.setTarget(new o.Vector3(n.position[1],n.position[0])));var r=zt(null!==(t=n.distance)&&void 0!==t?t:0,Xn);return er.orthoLeft=r.left,er.orthoRight=r.right,er.orthoBottom=r.bottom,er.orthoTop=r.top,r}({component:r});return n=function(e){var t=e.state,n=e.data;return wt(t),Et.setComponent({state:t,data:n})}({state:n=Ut.setComponent({state:n,data:At(At({},r),a)}),data:{}}),kt({state:(t={state:n,data:{}}).state}),Rt.setComponent(t)},zt=function(e,t){var n=function(e){var t=e.getEngine().getRenderingCanvasClientRect();return null!==t?t.height/t.width:1}(t);return n>1?{left:-e,right:e,bottom:-e*n,top:e*n}:{bottom:-e,top:e,left:-e/n,right:e/n}},Nt=function(e){var t=e.state;return e.page===u.mainMenu&&(t=d({state:t,data:{entity:It,name:r.logo}})),t},Ft="localDbKey",Wt={emptyBox:50,preferEmptyBoxes:15,advancedAttack:7,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:10,playerLessThanOponent:-10,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:-15,sixToSix:50,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:2,playerLessThanOponent:7,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:0,toBorder:0}},Qt={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:2,playerLessThanOponent:-2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:1,playerLessThanOponent:2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:0,toBorder:0}},Dt={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:0,playerLessThanOponent:-2,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:5,playerEqualToOponent:0,playerLessThanOponent:5,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:0,toBorder:0}},_t=function(){return(_t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ht=function(){return(Ht=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Yt=function(){return(Yt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Zt=function(e){var t,n=e.state,r=e.ai,a=e.preferEmptyBoxes,o=r.entity,i=(t={},t[x.disabled]=Dt,t[x.random]=Dt,t[x.easy]=Dt,t[x.medium]=Qt,t[x.hard]=Wt,t)[r.level],s=He({state:n});if(s=function(e){var t=e.dataGrid,n=e.currentPlayer,r=e.preferEmptyBoxes,a=e.aIGridPoints;return t.reduce((function(e,o,i){return e[i]=o.reduce((function(e,o,s){if(o.player!==n.entity&&void 0!==o.player)return e;var c=De(t,[i,s]),l=function(e){var t=e.grid3x3,n=e.preferEmptyBoxes,r=e.currentPlayer,a=e.aIGridPoints,o=t[1][1];return Qe(t).reduce((function(e,t){if(!t)return e+a.adjacted.toBorder;var i=o.dots===t.dots?T.equal:o.dots>t.dots?T.more:T.less;if(t.player!==o.player&&void 0!==t.player){if(n&&void 0===o.player&&t.player===r.entity)return Math.random()>.5?e+a.preferEmptyBoxes:e;if(i===T.more){var s=o.dots-t.dots;return e+a.adjacted.playerMoreThanOponent-s}if(i===T.equal)return e+a.adjacted.playerEqualToOponent*o.dots;if(i===T.less)return s=o.dots-t.dots-t.dots,e+a.adjacted.playerLessThanOponent*Math.abs(s)}else{if(6===o.dots)return e;if(i===T.more)return e+a.adjacted.playerMoreThanPlayer;if(i===T.equal)return 6===t.dots&&6===o.dots?e+a.adjacted.sixToSix:e+a.adjacted.playerEqualToPlayer;if(i===T.less)return 6===t.dots?e+2*a.adjacted.playerLessThanPlayer:e+a.adjacted.playerLessThanPlayer}return e}),0)}({grid3x3:c,preferEmptyBoxes:r,currentPlayer:n,aIGridPoints:a})+function(e){var t=e.grid3x3,n=e.aIGridPoints,r=t[1][1];return function(e){return[e[0][0],e[0][2],e[2][0],e[2][2]]}(t).reduce((function(e,t){if(!t)return e+n.diagonall.toBorder;var a=r.dots===t.dots?T.equal:r.dots>t.dots?T.more:T.less;if(t.player!==r.player&&void 0!==t.player){if(a===T.more)return e+n.diagonall.playerMoreThanOponent;if(a===T.equal)return 6===t.dots?e+-10*n.diagonall.playerEqualToOponent:e+n.diagonall.playerEqualToOponent;if(a===T.less)return 6===t.dots?e+2*n.diagonall.playerLessThanOponent:e+n.diagonall.playerLessThanOponent}else{if(6===r.dots)return e;if(a===T.more)return e+n.diagonall.playerMoreThanPlayer;if(a===T.equal)return e+n.diagonall.playerEqualToPlayer;if(a===T.less){var o=t.dots-r.dots;return e+n.diagonall.playerLessThanPlayer+Math.pow(o,2)}}return e}),0)}({grid3x3:c,preferEmptyBoxes:r,currentPlayer:n,aIGridPoints:a});return e[s]=Fe(Fe({},o),{points:o.points+l}),e}),o),e}),t)}({currentPlayer:r,dataGrid:s=function(e){var t=e.dataGrid,n=e.aIGridPoints;return t.reduce((function(e,t,r){return e[r]=t.reduce((function(e,t,r){var a=void 0===t.player?t.points+n.emptyBox:t.points;return e[r]=Ht(Ht({},t),{points:a}),e}),t),e}),t)}({dataGrid:s,aIGridPoints:i}),preferEmptyBoxes:!!a,aIGridPoints:i}),!a)switch(r.level){case x.disabled:s=function(e){var t=e.dataGrid;return t.reduce((function(e,t,n){return e[n]=t.reduce((function(e,t,n){return e[n].player="-1",e}),t),e}),t)}({dataGrid:s});break;case x.random:s=function(e){var t=e.dataGrid,n=e.currentPlayer;return t.reduce((function(e,t,r){return e[r]=t.reduce((function(e,t,r){return t.player!==n||void 0===t.player||(e[r]=Yt(Yt({},t),{points:100*Math.random()})),e}),t),e}),t)}({dataGrid:s,currentPlayer:o});break;case x.hard:s=function(e){var t=e.dataGrid,n=e.currentPlayer;return t.reduce((function(e,r,a){return e[a]=r.reduce((function(e,r,o){if(r.player!==n)return e;var i=De(t,[a,o]),s=Qe(i);if(s.some((function(e){return 6===(null==e?void 0:e.dots)})))return e;var c=s.reduce((function(e,a){if(!a)return e;var o=void 0!==a.player&&a.player!==n,i=r.dots>=a.dots;if(o&&i&&function(e){var t=e.currentPlayer,n=e.adjactedBox,r=e.dataGrid,a=e.position,o=a[0],i=a[1],s=De(r,[o,i]);return Qe(s).every((function(e){return void 0===e||e.player===t||void 0===e.player||e.dots<=n.dots}))}({currentPlayer:n,adjactedBox:a,dataGrid:t,position:a.gridPosition})){var s=6/r.dots;e+=a.dots*Wt.advancedAttack/s}return e}),0);return e[o]=_t(_t({},r),{points:r.points+c}),e}),r),e}),t)}({dataGrid:s,currentPlayer:o})}return function(e){var t=e.currentPlayer,n=-1/0,r=[];e.dataGrid.forEach((function(e){e.forEach((function(e){var a=void 0===e.player,o=e.player===t;(a||o)&&(e.points>n&&(r=[]),e.points>=n&&(n=e.points,r.push(e)))}))}));var a=Math.floor(Math.random()*r.length);return r[a]}({currentPlayer:o,dataGrid:s})};const Kt=n.p+"de1ab0613214552916d369d2014d1d95.png";var $t,Jt,Xt,en,tn,nn="38127445920450264",rn=v({entity:nn,name:r.marker}),an=(rn.getComponent,rn.setComponent),on=function(e){var t=e.playersQueue,n=e.index,a=e.state,o=f({state:a,name:r.ai,entity:t[n]});return(null==o?void 0:o.active)?o:on({playersQueue:t,index:n>=t.length?0:n+1,state:a})},sn=function(e){var t=e.state,n=Ae({state:t});if(n){var r=n.playersQueue.findIndex((function(e){return n.currentPlayer===e}));return on({playersQueue:n.playersQueue,index:r+1,state:t})}},cn=function(){return(cn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ln=function(e){var t=e.state,n=Ae({state:t});if(!n)return t;var a=n.gameStarted,o=n.boxRotationQueue;if(a&&0===o.length){var i=sn({state:t});if(!i)return t;var s=f({name:r.ai,state:t,entity:i.entity});if(!s)return t;if(t=d({state:t,data:cn(cn({},n),{currentPlayer:s.entity})}),!s.human&&s.active){var c=Zt({state:t,ai:s});c?(t=an({state:t,data:{color:s.color,position:[c.gridPosition[0]*Pt,c.gridPosition[1]*Pt]}}),t=Xe({box:c,state:t,ai:s}),t=Ke({state:t,entity:c.entity})):t=function(e){var t=e.state,n=e.ai,a=e.component;t=d({state:t,data:cn(cn({},n),{active:!1})});var o=m({state:t,name:r.ai});return 1===Object.values(o||{}).reduce((function(e,t){return t.active?e+1:e}),0)?(localStorage.removeItem(Ft),d({state:t,data:cn(cn({},a),{gameStarted:!1})})):(yn({type:Te.Type.nextTurn,payload:{ai:n}}),t)}({state:t,component:n,ai:s})}}return function(e){localStorage.setItem(Ft,JSON.stringify(e))}(t),t},un=function(){return(un=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},dn=function(e){return console.trace("Wrong path",e),e},pn=function(){return(pn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},fn=function(e){var t=e.state,n=e.game,a=function(e){var t=e.state,n=He({state:t}),r=n[0]?1.2*n[0].length:1,a=1.2*n.length;return{width:r,height:a,center:[(r-1-.2)/2,(a-1-.2)/2],cameraDistance:(r>a?r:a)/2+.2}}({state:t=function(e){var t=e.state,n=e.ai;t=p({state:t,name:r.ai});var a=Ae({state:t});return a&&(t=d({state:t,data:un(un({},a),{playersQueue:n.map((function(e){return e.entity}))})})),n.reduce((function(e,t){return d({state:e,data:t})}),t)}({state:t=Array.from({length:8}).reduce((function(e,t,n){return Array.from({length:8}).reduce((function(e,t,a){return d({state:e,data:{name:r.box,entity:Ot().toString(),isAnimating:!1,dots:0,gridPosition:[a,n],player:void 0}})}),e)}),t),ai:n.customLevelSettings.players.map((function(e){return pn(pn({},e),{level:n.customLevelSettings.difficulty})}))})}),o=a.center,i=a.cameraDistance;return Vt({state:t,data:{position:[o[0],o[1]],distance:i}})},mn=function(e,t){document.dispatchEvent(new CustomEvent(e,{detail:t}))},vn=(Xt="first",en=[],tn=[],{emitEvent:function(e){"first"===Xt?en.push(e):tn.push(e)},eventSystem:function(e){return function(e){var t=e.state,n=e.initialize,r=e.tick,a=b(e,["state","initialize","tick"]),o={name:a.name,priority:a.priority||g.zero,update:void 0,tick:r||E,initialize:n||E,create:E,remove:function(e){return e.state}};return h(h({},t),{system:w(w([],t.system),[o])})}({state:e,name:r.event,tick:function(e){var t=e.state;return Xt="second",tn=[],t=en.reduce((function(e,t){return function(e){var t=e.state,n=e.event;switch(n.type){case Bt.Type.resize:t=function(e){var t=e.state,n=Gt({state:t});return Vt({state:t,data:n||{}})}({state:t,event:n});break;case Re.Type.rotateBox:t=function(e){var t=e.state;if(!jt({state:t}))return t;var n,r,a,o=(n=St.flat().filter((function(e){return""!==e})))[Math.floor(n.length*Math.random())],i=(r=Math.floor(Ee.length*Math.random()),Ee[r]),s=(a=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e}([at],bt().map((function(e){return e.color}))))[Math.floor(a.length*Math.random())];return ze({boxUniqueId:o,animationEndCallback:function(){Ne({boxUniqueId:o,texture:i,color:s})},texture:i,color:s}),setTimeout((function(){yn({type:Re.Type.rotateBox,payload:{}})}),500*Math.random()+500),t}({state:t,event:n});break;case Te.Type.startCustomLevel:t=function(e){var t=e.state,n=Ae({state:t});if(!n)return t;t=fn({state:t,game:n});var a=sn({state:t});if(!a)return dn(t);t=qe({state:t,data:{currentPlayer:a.entity}});var o=Ae({state:t});if(!o)return dn(t);if(o.customLevelSettings.quickStart&&function(e){var t=e.state,n=Ae({state:t});n&&n.grid.forEach((function(e){var n=f({state:t,entity:e,name:r.box}),a=f({state:t,entity:(null==n?void 0:n.player)||"",name:r.ai});n&&a&&yn({type:Jt.Type.rotate,payload:{color:a.color,texture:Ge({state:t,ai:a})[n.dots],direction:$t.up,boxEntity:e}})}))}({state:t=function(e){var t,n=e.state,a=(null===(t=Ae({state:n}))||void 0===t?void 0:t.grid.length)||1;return Array.from({length:2*a}).reduce((function(e){var t=Ae({state:e}),n=f({state:e,name:r.ai,entity:(null==t?void 0:t.currentPlayer)||""});if(!t||!n)return dn(e);var a=Zt({state:e,ai:n,preferEmptyBoxes:!0});if(!a)return dn(e);e=d({state:e,data:pn(pn({},a),{player:n.entity,dots:Je(a.dots)})});var o=sn({state:e});return o?e=d({state:e,data:pn(pn({},t),{currentPlayer:o.entity})}):e}),n)||n}({state:t})}),t=qe({state:t,data:{gameStarted:!0,page:u.customLevel}}),!a.human){var i=Zt({state:t,ai:a});i&&(t=Xe({box:i,state:t,ai:a}))}return d({state:t,data:{entity:nn,name:r.marker,color:[1,1,1],position:[0,0]}})}({state:t,event:n}),mn("setUIState",t);break;case Te.Type.nextTurn:t=ln({state:t,event:n}),mn("setUIState",t);break;case Te.Type.playerClick:t=function(e){var t=e.state,n=e.event,a=Ae({state:t});if(!a)return t;var o=a.currentPlayer,i=a.gameStarted,s=a.boxRotationQueue,c=f({state:t,name:r.box,entity:n.payload.boxEntity}),l=void 0===(null==c?void 0:c.player)||(null==c?void 0:c.player)===o;if(i&&0===s.length&&l){var u=f({name:r.ai,state:t,entity:o});c&&(null==u?void 0:u.human)&&(t=an({state:t,data:{color:u.color,position:[c.gridPosition[0]*Pt,c.gridPosition[1]*Pt]}}),t=Xe({box:c,state:t,ai:u}))}return t}({state:t,event:n});break;case Te.Type.cleanScene:t=function(e){var t=e.state,n=e.event;return t=qe({state:t,data:{page:n.payload.newPage,round:0,grid:[],currentPlayer:"",playersQueue:[],boxRotationQueue:[],gameStarted:!1}}),t=p({name:r.box,state:t}),t=p({name:r.ai,state:t}),t=p({name:r.marker,state:t}),t=p({name:r.background,state:t}),t=p({name:r.logo,state:t}),Nt({state:t,page:n.payload.newPage})}({state:t,event:n}),mn("setUIState",t);break;case Te.Type.changePlayers:t=function(e){var t,n,r=e.state,a=Ae({state:r});if(!a)return r;var o=8===(null===(t=a.customLevelSettings.players)||void 0===t?void 0:t.length)?2:(null===(n=a.customLevelSettings.players)||void 0===n?void 0:n.length)+1;return qe({state:r,data:{customLevelSettings:gt(gt({},a.customLevelSettings),{players:bt().slice(0,o)})}})}({state:t,event:n}),mn("setUIState",t);break;case Te.Type.changeDifficulty:t=function(e){var t,n=e.state,r=Ae({state:n});if(!r)return n;var a=[x.easy,x.medium,x.hard],o=a.findIndex((function(e){return e===r.customLevelSettings.difficulty})),i=-1===o?a[0]:null!==(t=a[o+1])&&void 0!==t?t:a[0];return qe({state:n,data:{customLevelSettings:gt(gt({},r.customLevelSettings),{difficulty:i})}})}({state:t,event:n}),mn("setUIState",t);break;case Te.Type.changeQuickStart:t=function(e){var t=e.state,n=Ae({state:t});return n?t=qe({state:t,data:{customLevelSettings:gt(gt({},n.customLevelSettings),{quickStart:!n.customLevelSettings.quickStart})}}):t}({state:t,event:n}),mn("setUIState",t);break;case Te.Type.changeColorBlindMode:t=function(e){var t=e.state,n=Ae({state:t});return n?t=qe({state:t,data:{colorBlindMode:!n.colorBlindMode}}):t}({state:t,event:n}),mn("setUIState",t);break;case Te.Type.changeMapType:t=function(e){return e.state}({state:t,event:n}),mn("setUIState",t);break;case Te.Type.showNewVersion:t=function(e){var t=e.state;return qe({state:t,data:{newVersionAvailable:!0}})}({state:t,event:n});break;case Te.Type.reload:t=function(e){var t=e.state;return window.location.reload(),t}({state:t,event:n});break;case Jt.Type.rotationEnd:t=function(e){var t=e.state,n=e.event.payload,a=n.ai,o=n.shouldExplode,i=n.boxEntity,s=f({state:t,name:r.box,entity:i});if(!s)return t;t=function(e){var t=e.entity,n=e.state,r=Ae({state:n});return r?d({state:n,data:et(et({},r),{boxRotationQueue:r.boxRotationQueue.filter((function(e){return e!==t}))})}):n}({entity:s.entity,state:t}),Ne({boxUniqueId:s.entity,texture:Ge({state:t,ai:a})[s.dots],color:a.color});var c=Ae({state:t});if(!c)return t;o?t=function(e){var t=e.state,n=e.ai,r=e.box.gridPosition,a=r[0],o=r[1],i=He({state:t});return[We(i,o,a-1),We(i,o,a+1),We(i,o-1,a),We(i,o+1,a)].filter((function(e){return void 0!==e})).reduce((function(e,t,r){return e=Xe({ai:n,box:t,state:e}),Ke({entity:t.entity,state:e})}),t)}({state:t,box:s,ai:a}):0===c.boxRotationQueue.length&&yn({type:Te.Type.nextTurn,payload:{ai:a}});var l=Xn.getTransformNodeByUniqueId(parseInt(s.entity));return l&&(l.animations=[]),d({state:t,data:tt(tt({},s),{isAnimating:!1})})}({state:t,event:n});break;case Jt.Type.rotate:t=function(e){var t=e.state,n=e.event;return ze({boxUniqueId:n.payload.boxEntity,animationEndCallback:function(){Ne({boxUniqueId:n.payload.boxEntity,texture:n.payload.texture,color:n.payload.color})},texture:n.payload.texture,color:n.payload.color}),t}({state:t,event:n})}return t}({state:e,event:t})}),t),en=[],Xt="first",en=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e}([],tn),t}})}}),yn=vn.emitEvent,gn=vn.eventSystem,hn=function(e){var t=e.scene,n=e.name,r=e.uniqueId,a=e.position,i=e.color,s=e.state,c=e.ai,l=e.dots,u=e.isClickable,d=e.scaleFactor,p=1/(void 0===d?1:d),f=new o.TransformNode("box "+n,t);return f.uniqueId=r,f.position.x=a[0],f.position.y=a[1],[[new o.Vector3(0,0,-p/2),new o.Vector3(0,0,0)],[new o.Vector3(-p/2,0,0),new o.Vector3(0,Math.PI/2,0)],[new o.Vector3(0,0,p/2),new o.Vector3(0,Math.PI,0)],[new o.Vector3(p/2,0,0),new o.Vector3(0,-Math.PI/2,0)],[new o.Vector3(0,p/2,0),new o.Vector3(Math.PI/2,0,0)],[new o.Vector3(0,-p/2,0),new o.Vector3(-Math.PI/2,0,0)]].forEach((function(e,n){var a=e[0],d=e[1],m=o.MeshBuilder.CreatePlane("plane"+n,{size:p});m.parent=f,m.material=new o.StandardMaterial("mat",t),Ue({mesh:m,color:i,texture:Ge({state:s,ai:c})[l],scene:t}),m.material.alpha=1,m.position=a,m.rotation=d,u&&(m.actionManager=new o.ActionManager(t),m.actionManager.registerAction(new o.ExecuteCodeAction(o.ActionManager.OnPickUpTrigger,(function(){yn({type:Te.Type.playerClick,payload:{boxEntity:r.toString()}})}))))})),f},bn=function(){return(bn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},wn=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e},xn=function(e){var t=e.state,n=e.component,a=n.gridPosition,o=f({state:t,name:r.ai,entity:n.player||""});hn({scene:Xn,name:a[0]+"-"+a[1],position:[a[0]*Pt,a[1]*Pt],uniqueId:parseFloat(n.entity),color:(null==o?void 0:o.color)||[1,1,1],ai:o,dots:n.dots,state:t,isClickable:!0});var i=Ae({state:t});return i?t=d({state:t,data:bn(bn({},i),{grid:wn(wn([],i.grid),[n.entity])})}):t},Tn=function(e){var t=e.state,n=e.component,r=Xn.getTransformNodeByUniqueId(parseInt(n.entity));return null==r||r.dispose(),t};!function(e){e[e.up=0]="up",e[e.down=1]="down",e[e.left=2]="left",e[e.right=3]="right"}($t||($t={})),function(e){var t;(t=e.Type||(e.Type={})).onClick="BoxEvent-onClick",t.rotationEnd="BoxEvent-rotationEnd",t.rotate="BoxEvent-rotate"}(Jt||(Jt={}));var En=function(){return(En=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Cn=n(155),Pn=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function On(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}Cn.env.PUBLIC_URL="/kostki";var Sn,kn=n(935),Mn=n(294),Ln=n(744),In=(Sn=(0,Ln.Th)({theme:{colors:{outline:"#595cff"},space:{},fontSizes:{},fonts:{},fontWeights:{},lineHeights:{},letterSpacings:{},sizes:{},borderWidths:{},borderStyles:{},radii:{},shadows:{},zIndices:{},transitions:{}},media:{bp1:"(min-width: 1024px)"}})).styled,Bn=(Sn.css,In("button",{borderWidth:"5px",borderColor:"Black",borderStyle:"solid",background:"White",padding:"20px 15px",fontSize:"1.5rem",whiteSpace:"nowrap",cursor:"pointer",transition:"0.2s transform",pointerEvents:"auto","&:hover":{transform:"scale(1.05)"},"&:focus":{transform:"scale(0.98)"}})),Rn=In("div",{display:"flex"}),jn=In("div",{display:"grid",maxWidth:"1920px",margin:"0 auto",padding:"0.5rem"}),An=In("div",{color:"Black",fontSize:"1.5rem"}),qn=function(){return Mn.createElement(jn,{css:{gridTemplateRows:"20% 70% 10%",gridTemplateColumns:"20% 60% 20%",flex:1}},Mn.createElement(Rn,{css:{flexDirection:"column",justifyContent:"center",alignItems:"center",gridRow:"2 / 2",gridColumn:"2 / 3"}},Mn.createElement(Bn,{css:{maxWidth:"500px",width:"100%"},onClick:function(){yn({type:Te.Type.cleanScene,payload:{newPage:u.customLevelSettings}})}},"Start"),Mn.createElement(Bn,{css:{marginTop:"100px",maxWidth:"500px",width:"100%"},onClick:function(){yn({type:Te.Type.cleanScene,payload:{newPage:u.customLevelSettings}})}},"Custom Level")),Mn.createElement(An,{css:{flexDirection:"column",justifyContent:"center",gridRow:"3 / 4",gridColumn:"3 / 3"}},"0.0.2"))},Un=function(e){var t;"Tab"===e.key&&(null===(t=document.body)||void 0===t||t.classList.add("enable-outline"))},Gn=function(){var e;null===(e=document.body)||void 0===e||e.classList.remove("enable-outline")},Vn=void 0,zn=function(){var e=(0,Mn.useState)(void 0),t=e[0],n=e[1];return(0,Mn.useEffect)((function(){var e=function(e){e&&(Vn=e,n(e))};return function(e,t){document.addEventListener("setUIState",(function(e){return t(e.detail)}))}(0,e),function(){!function(e,t){document.removeEventListener("setUIState",t)}(0,e)}}),[]),t||Vn},Nn=In("div",{display:"grid"}),Fn=function(){return Mn.createElement("svg",{width:"40",height:"40",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{margin:"-9px"}},Mn.createElement("path",{d:"M11.4669 3.72684C11.7558 3.91574 11.8369 4.30308 11.648 4.59198L7.39799 11.092C7.29783 11.2452 7.13556 11.3467 6.95402 11.3699C6.77247 11.3931 6.58989 11.3355 6.45446 11.2124L3.70446 8.71241C3.44905 8.48022 3.43023 8.08494 3.66242 7.82953C3.89461 7.57412 4.28989 7.55529 4.5453 7.78749L6.75292 9.79441L10.6018 3.90792C10.7907 3.61902 11.178 3.53795 11.4669 3.72684Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))},Wn=function(){return Mn.createElement("svg",{width:"40",height:"40",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{margin:"-9px"}},Mn.createElement("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))},Qn=function(){var e,t=zn(),n=t&&Ae({state:t});return n?Mn.createElement(jn,{css:{gridTemplateRows:"3fr 1fr 1fr",gridTemplateColumns:"1fr",gridGap:"1rem",flex:1}},Mn.createElement(Rn,{css:{flexDirection:"column",justifyContent:"center",gridRow:"1 / 1",gridColumn:"1 / 1"}},"Select level"),Mn.createElement(Nn,{css:{gridTemplateRows:"1fr 1fr 1fr 1fr",gridTemplateColumns:"1fr","@bp1":{gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr 1fr"},gridGap:"1rem",gridRow:"2 / 2",gridColumn:"1 / 1"}},Mn.createElement(Bn,{css:{display:"flex",justifyContent:"space-between",gridRow:"1 / 1",gridColumn:"1 / 1",alignSelf:"center"},onClick:function(){return yn({type:Te.Type.changeDifficulty,payload:{}})}},Mn.createElement("div",null,"Difficulty"),Mn.createElement("div",null,function(e){switch(e){case x.disabled:return"Disabled";case x.random:return"Random";case x.easy:return"Easy";case x.medium:return"Medium";case x.hard:return"Hard"}}(n.customLevelSettings.difficulty))),Mn.createElement(Bn,{css:{display:"flex",justifyContent:"space-between",gridRow:"2 / 2",gridColumn:"1 / 1",alignSelf:"center","@bp1":{gridRow:"1 / 1",gridColumn:"2 / 2"}},onClick:function(){return yn({type:Te.Type.changePlayers,payload:{}})}},Mn.createElement("div",null,"Players"),Mn.createElement("div",null,null===(e=n.customLevelSettings.players)||void 0===e?void 0:e.length)),Mn.createElement(Bn,{css:{display:"flex",justifyContent:"space-between",gridRow:"3 / 3",gridColumn:"1 / 1",alignSelf:"center","@bp1":{gridRow:"2 / 2",gridColumn:"1 / 1"}},onClick:function(){return yn({type:Te.Type.changeQuickStart,payload:{}})}},Mn.createElement("div",null,"Quick Start"),Mn.createElement("div",null,n.customLevelSettings.quickStart?Mn.createElement(Fn,null):Mn.createElement(Wn,null))),Mn.createElement(Bn,{css:{display:"flex",justifyContent:"space-between",gridRow:"4 / 4",gridColumn:"1 / 1",alignSelf:"center","@bp1":{gridRow:"2 / 2",gridColumn:"2 / 2"}},onClick:function(){return yn({type:Te.Type.changeColorBlindMode,payload:{}})}},Mn.createElement("div",null,"Color Blind Mode"),Mn.createElement("div",null,n.colorBlindMode?Mn.createElement(Fn,null):Mn.createElement(Wn,null)))),Mn.createElement(Rn,{css:{flexDirection:"column",justifyContent:"center",gridRow:"3 / 3",gridColumn:"1 / 1"}},Mn.createElement(Bn,{onClick:function(){return yn({type:Te.Type.startCustomLevel,payload:{}})}},"Start"))):null},Dn=function(){return Mn.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Mn.createElement("path",{d:"M1.5 3C1.22386 3 1 3.22386 1 3.5C1 3.77614 1.22386 4 1.5 4H13.5C13.7761 4 14 3.77614 14 3.5C14 3.22386 13.7761 3 13.5 3H1.5ZM1 7.5C1 7.22386 1.22386 7 1.5 7H13.5C13.7761 7 14 7.22386 14 7.5C14 7.77614 13.7761 8 13.5 8H1.5C1.22386 8 1 7.77614 1 7.5ZM1 11.5C1 11.2239 1.22386 11 1.5 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7761 13.7761 12 13.5 12H1.5C1.22386 12 1 11.7761 1 11.5Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))},_n=function(e){var t=e.ai;return Mn.createElement(Rn,{css:{flexDirection:"column"}},t.map((function(e){var t=e.entity,n=e.name,r=e.color,a=e.isActive;return Mn.createElement(Rn,{key:t,css:{alignItems:"center",padding:"0.125rem",border:a?"black solid":"transparent solid",borderWidth:"0.125rem","@bp1":{borderWidth:"0.25rem"}}},Mn.createElement(Rn,{css:{position:"relative",width:"1rem",height:"1rem",border:"0.125rem solid black","@bp1":{width:"2rem",height:"2rem",border:"0.25rem solid black"},marginRight:"0.5rem",backgroundColor:"rgb("+255*r[0]+", "+255*r[1]+", "+255*r[2]+")"}}),Mn.createElement(An,{css:{fontSize:"0.75rem","@bp1":{fontSize:"1.5rem"}}},n))})))},Hn=function(){var e=zn(),t=e?function(e){var t=Ae({state:e});return(null==t?void 0:t.playersQueue.map((function(t){return f({state:e,name:r.ai,entity:t})})).filter((function(e){return!!e}))).map((function(e){return{entity:e.entity,color:e.color,isActive:(null==t?void 0:t.currentPlayer)===e.entity,name:e.human?"Player":"Computer"}}))}(e):[];return Mn.createElement(jn,{css:{gridTemplateRows:"100px 1fr",gridTemplateColumns:"1fr 100px",flex:1}},Mn.createElement(Rn,{css:{gridRow:"1 / 3",gridColumn:"1 / 1"}},Mn.createElement(_n,{ai:t})),Mn.createElement(Bn,{css:{gridRow:"1 / 1",gridColumn:"2 / 2",display:"flex",alignContent:"center",alignItems:"center",margin:"0.5rem"},onClick:function(){yn({type:Te.Type.cleanScene,payload:{newPage:u.mainMenu}})}},Mn.createElement(Dn,null)))},Yn=(0,Ln.zY)({"*":{fontFamily:"Sans-serif"},".enable-outline *:focus":{outlineWidth:"10px",outlineStyle:"solid",outlineColor:"$outline"}}),Zn=function(e){var t,n=e.state;(0,Mn.useEffect)((function(){return window.addEventListener("keydown",Un),function(){window.removeEventListener("keydown",Un)}}),[]),(0,Mn.useEffect)((function(){return window.addEventListener("click",Gn),function(){window.removeEventListener("click",Gn)}}),[]),Yn();var r=zn();switch(null===(t=Ae({state:r||n}))||void 0===t?void 0:t.page){case u.mainMenu:return Mn.createElement(qn,null);case u.customLevelSettings:return Mn.createElement(Qn,null);case u.customLevel:return Mn.createElement(Hn,null);case void 0:return null}},Kn=document.getElementById("game"),$n="humanPlayer",Jn=new o.Engine(Kn,!0,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1}),Xn=new o.Scene(Jn);Jn.runRenderLoop((function(){Xn&&Xn.activeCamera&&Xn.render()}));var er=new o.UniversalCamera("UniversalCamera",new o.Vector3(0,0,-1),Xn);er.mode=o.Camera.ORTHOGRAPHIC_CAMERA;var tr=new o.HemisphericLight("light",new o.Vector3(0,0,1),Xn);tr.intensity=1,tr.diffuse=new BABYLON.Color3(1,1,1),tr.specular=new BABYLON.Color3(1,1,1),tr.groundColor=new BABYLON.Color3(1,1,1),"serviceWorker"in navigator&&(function(e){if("serviceWorker"in navigator){if(new URL(Cn.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t=Cn.env.PUBLIC_URL+"/service-worker.js";Pn?(function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):On(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):On(t,e)}))}}({onUpdate:function(){},onSuccess:function(){}}),navigator.serviceWorker.addEventListener("message",(function(e){return t=void 0,n=void 0,a=function(){var t,n,r,a;return function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(o){switch(o.label){case 0:return"workbox-broadcast-update"!==e.data.meta?[3,4]:(t=e.data.payload,n=t.cacheName,r=t.updatedURL,[4,caches.open(n)]);case 1:return[4,o.sent().match(r)];case 2:return[4,null==(a=o.sent())?void 0:a.text()];case 3:o.sent(),yn({type:Te.Type.showNewVersion,payload:{}}),o.label=4;case 4:return[2]}}))},new((r=void 0)||(r=Promise))((function(e,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,s)}c((a=a.apply(t,n||[])).next())}));var t,n,r,a})));var nr,rr=(nr=function(e){return C({state:e,name:r.logo,create:Mt,remove:Lt})}(nr=function(e){return C({state:e,name:r.background,create:xt,tick:function(e){var t=e.state,n=e.component,r=Xn.getMeshByUniqueId(parseFloat(Tt));return r&&r.material&&(r.material.setFloat("iTime",performance.now()/1e3+n.gradientTime),r.material.setVector2("iResolution",new o.Vector2(window.innerWidth,window.innerHeight)),r.material.setFloats("iColors",yt.flat())),t}})}(nr=function(e){return C({state:e,name:r.camera,create:function(e){var t=e.state,n=e.component;return Vt({state:t,data:n})}})}(nr=function(e){return C({state:e,name:r.marker,create:function(e){var t,n,r=e.state,a=e.component,i=o.Mesh.CreatePlane(nn,1.4,Xn,!0);return i.uniqueId=parseInt(a.entity),i.position=new o.Vector3(9999,9999,9999),i.material=new o.StandardMaterial("material",Xn),i.material.useAlphaFromDiffuseTexture=!0,Ue({mesh:i,color:[1,1,1],texture:Kt,scene:Xn}),i.material.diffuseTexture.hasAlpha=!0,i.animations[0]=(t=new o.Animation("getScaleAnimation","scaling",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),(n=[]).push({frame:0,value:new o.Vector3(2,2,1)}),n.push({frame:.5,value:new o.Vector3(.9,.9,1)}),t.setKeys(n),t),i.animations[1]=function(){var e=new o.Animation("getAlphaAnimation","material.alpha",1,o.Animation.ANIMATIONTYPE_FLOAT,o.Animation.ANIMATIONLOOPMODE_RELATIVE),t=[];return t.push({frame:0,value:1}),t.push({frame:.5,value:0}),e.setKeys(t),e}(),r},update:function(e){var t=e.state,n=e.component,r=Xn.getMeshByUniqueId(parseInt(nn));return r&&(r.material.diffuseColor=new o.Color3(n.color[0],n.color[1],n.color[2]),Xn.beginAnimation(r,0,1,!1),r.position.x=n.position[0],r.position.y=n.position[1],r.position.z=-1),t}})}(nr=function(e){return C({state:e,name:r.game,create:Ie})}(nr=function(e){return C({state:e,name:r.ai})}(nr=function(e){return C({state:e,name:r.box,create:xn,remove:Tn})}(nr=gn(nr=y)))))))),nr=d({state:nr,data:{entity:$n,name:r.ai,human:!0,level:x.hard,color:[0,0,1],textureSet:["","","","","","",""],active:!0}}),nr=d({state:nr,data:{version:"0.0.1",page:u.mainMenu,newVersionAvailable:!1,entity:Be,name:r.game,grid:[],round:0,currentPlayer:$n,gameStarted:!1,playersQueue:[],boxRotationQueue:[],colorBlindMode:!1,customLevelSettings:{players:bt().slice(0,8),difficulty:x.easy,quickStart:!0,mapType:""},musicEnabled:!1}}),nr=d({state:nr,data:En({entity:qt,name:r.camera,position:[0,0],distance:5},zt(5,Xn))}),nr=d({state:nr,data:{entity:Tt,name:r.background,gradientTime:5e4*Math.random()}}),Nt({state:nr,page:u.mainMenu}));!function(e){var t=e.state;kn.render(Mn.createElement(Mn.StrictMode,null,Mn.createElement(Zn,{state:t})),document.getElementById("gameUi"))}({state:rr}),Xn.registerBeforeRender((function(){rr=function(e){var t=e.state;return t.system.concat().sort((function(e,t){return e>t?-1:1})).reduce((function(e,t){return t.tick({state:e,eventBuffer:{}})}),t)}({state:rr})})),window.addEventListener("resize",(function(){yn({type:Bt.Type.resize,payload:{}}),Jn.resize()}))}},e=>{e.O(0,[216],(()=>(705,e(e.s=705)))),e.O()}]);