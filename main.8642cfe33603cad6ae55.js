"use strict";(self.webpackChunkkostki=self.webpackChunkkostki||[]).push([[179],{60:(e,t,n)=>{n.d(t,{nS:()=>Ea,$z:()=>Pa,Ah:()=>Ca});var a,r,o=n(385),i=function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},s=function(e,t){return t.find((function(t){return t.name===e}))};(r=a||(a={})).event="event",r.box="box",r.ai="ai",r.game="game",r.camera="camera",r.marker="marker",r.ui="ui",r.uiButton="uiButton",r.uiImage="uiImage",r.uiText="uiText",r.background="background",r.turnIndicator="turnIndicator",r.logo="logo";var c,u,l=function(e){var t,n,a=e.state,r=e.data,o=i(i({},a),{component:i(i({},a.component),(t={},t[r.name]=i(i({},a.component[r.name]),(n={},n[r.entity]=r,n)),t))}),c=s(r.name,a.system);if(void 0!==c){if(void 0===a.component[r.name]||void 0===a.component[r.name][r.entity])return c.create({state:o,component:r});if(c.update)return c.update({state:o,component:r})}return o},d=function(e){var t,n=e.name,a=e.entity,r=e.state,o=r.component[n],c=a,u=(o[c],function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}(o,["symbol"==typeof c?c:c+""])),l=i(i({},r),{component:i(i({},r.component),(t={},t[n]=u,t))}),d=f({name:n,state:r,entity:a}),p=s(n,l.system);return p&&d?p.remove({state:l,component:d}):l},p=function(e){var t=e.state,n=e.name,a=v({state:t,name:n});return a?Object.keys(a).reduce((function(e,t){return d({name:n,entity:t,state:e})}),t):t},f=function(e){var t=e.name,n=e.entity,a=e.state.component[t];return a?a[n]:void 0},v=function(e){var t=e.name;return e.state.component[t]},y=function(e){var t=e.entity,n=e.name,a=function(e){var a=e.state;return f({state:a,entity:t,name:n})};return{getComponent:a,setComponent:function(e){var r=e.state,o=e.data,s=a({state:r});return s?r=l({state:r,data:i(i({entity:t,name:n},s),o)}):r}}},m={entity:{},component:(c={},c[a.event]={},c[a.box]={},c[a.ai]={},c[a.game]={},c[a.camera]={},c[a.marker]={},c[a.ui]={},c[a.uiButton]={},c[a.uiImage]={},c[a.uiText]={},c[a.background]={},c[a.turnIndicator]={},c[a.logo]={},c),system:[]};!function(e){e.mainMenu="mainMenu",e.customLevel="customLevel",e.customLevelSettings="customLevelSettings"}(u||(u={}));var g,h=function(){return(h=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},b=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},x=function(e,t){for(var n=0,a=t.length,r=e.length;n<a;n++,r++)e[r]=t[n];return e};!function(e){e[e.last=3]="last",e[e.time=3]="time",e[e.io=2]="io",e[e.transform=1]="transform",e[e.zero=0]="zero",e[e.sprite=-1]="sprite",e[e.draw=-2]="draw"}(g||(g={}));var T,w,O=function(e){return e.state},P=function(e){var t=e.state,n=e.tick,a=b(e,["state","tick"]),r={name:a.name,priority:a.priority||g.zero,initialize:a.initialize||O,create:a.create||O,tick:function(e){var t=e.state,r=(e.eventBuffer,t.component[a.name]);return r?Object.values(r).reduce((function(e,t){return n?n({state:e,component:t}):e}),t):t},update:a.update,remove:a.remove||O,event:a.event||O};return h(h({},t),{system:x(x([],t.system),[r])})};!function(e){e.disabled="disabled",e.random="random",e.easy="easy",e.medium="medium",e.hard="hard"}(T||(T={})),function(e){e[e.less=-1]="less",e[e.equal=0]="equal",e[e.more=1]="more"}(w||(w={}));var S={},C=function(e){var t=e.textureUrl,n=e.scene,a=new o.Texture(t,n,void 0,void 0,o.Texture.NEAREST_NEAREST_MIPLINEAR);return S[t]=a,a};const E=n.p+"57365b6b32a38acad399fa24be970b62.png",k=n.p+"86711768640182ba9774e66c59e43713.png",M=n.p+"d5fd50f6577249e4bd0a6cedc07b855c.png",B=n.p+"1cece826ef3290f02e8ab121defa70e5.png",I=n.p+"04486ea103fd49156ce128e43c00f4af.png",L=n.p+"4c8888485f10730f523694c6ac7449e4.png",j=n.p+"3bb45fa09a5eb9cd805c7f32aab31591.png",A=n.p+"289b33e3a3e1c125f813747944282bbb.png",U=n.p+"e7015b6db11decc2aa7f722b6eaaa343.png",q=n.p+"7e6aabd8e3d92edca81c0207761816f0.png",z=n.p+"1a202abfbdfbb945f566e890f0e0fa7f.png",R=n.p+"ad7c3be816ce34c76152ecc6c61d263b.png",G=n.p+"8711d0d55135c6a04bf3e76aa6287504.png",V=n.p+"717e6eb5fb82bedfc88f6dc0c65b6f12.png",N=n.p+"16c7f9cc6c2acada16547b3befe94a91.png",F=n.p+"2d2b2519ce6d9ed0c93cd7ed21aed043.png",Q=n.p+"7fa7abdc3e479f97ee5f6b283630df03.png",W=n.p+"f3941c38549dddc4a8cb586591e36996.png",D=n.p+"62bd7e3778d77e5ca308fcb5f4b0da78.png",_=n.p+"2f30a46bdc58014e8ba857f895bbe5b8.png",Y=n.p+"de0b87223c2e5708366657b7da01c941.png",H=n.p+"54b2699e76fca159c5797b2b93b10bd4.png",K=n.p+"3d713800c02422e02fe02e70f53e9771.png",$=n.p+"2f9682e3f7d362cc3087ef4dcbbdfd2b.png",J=n.p+"62f6adca2ae3c6e088aac66bc47cb54e.png",X=n.p+"9bb2d886948bbd78603ec224904774fd.png",Z=n.p+"2d9f8ec02b7087dc45bf61208aacf7a8.png",ee=n.p+"4fd5888696b352601fd6c1f7a1420e1f.png",te=n.p+"d62f41f971620bf90529571efed25c8e.png",ne=n.p+"2c7434786497b8ccb02757089a53015a.png",ae=n.p+"51f16b6b18086fcc295f8bc02e6c8c45.png",re=n.p+"0dfd6a6b5e5120be13c81ddc1d84a1df.png",oe=n.p+"301a367840edef78b86808852d0c067e.png",ie=n.p+"d854a7c9f810ebe5be07e17990bd0ee4.png",se=n.p+"777079c111d24a4a0402f5afbc95b175.png",ce=n.p+"e1b39772fd20282e80743b1f04be6795.png",ue=n.p+"24075b75ce25b7869e6559cccca76b75.png",le=n.p+"698b6e6ce4fcc13dd8ac2cdb9bb484fe.png",de=n.p+"38ca2b18556222743ee8778742514d73.png",pe=n.p+"aebe569c1bf5190e0038b7098791359c.png",fe=n.p+"d1390ce752b5ee52126d21de796a81f8.png",ve=n.p+"d54421100963619575d7b3f35876fdfe.png",ye=n.p+"cde379b0a92320968a3826f29eff20fc.png",me=n.p+"d1b88dc4aa017270afbb48ce8c2d93ee.png",ge=n.p+"f07f0db4072406727dc668f8f643b725.png",he=n.p+"f60fcf550b1112ec6a6bb8c80cc4b142.png",be=n.p+"5fded717b6adc588c2dcdedd900f3bea.png",xe=n.p+"ed032e786ebb26ea79c773fd85684876.png",Te=n.p+"7960efbc05f46d226a4e232b391a79ea.png";var we,Oe=[E,k,M,B,I,L,j],Pe=[E,A,U,q,z,R,G],Se=[E,V,N,F,Q,W,D],Ce=[E,_,Y,H,K,$,J],Ee=[E,X,Z,ee,te,ne,ae],ke=[E,re,oe,ie,se,ce,ue],Me=[E,le,de,pe,fe,ve,ye],Be=[E,me,ge,he,be,xe,Te],Ie=function(e){var t=e.state;return setTimeout((function(){Oe.forEach((function(e){var t=new Image;t.src=e,t.onload=function(){C({textureUrl:e,scene:Ca})}}))}),2e3*Math.random()+1e3),t},Le="game";!function(e){var t;(t=e.Type||(e.Type={})).startCustomLevel="GameEvent-startCustomLevel",t.nextTurn="GameEvent-nextTurn",t.boxExplosion="GameEvent-boxExplosion",t.playerClick="GameEvent-playerClick",t.cleanScene="GameEvent-cleanScene",t.changePlayers="GameEvent-changePlayers",t.changeDifficulty="GameEvent-changeDifficulty",t.changeQuickStart="GameEvent-changeQuickStart",t.changeColorBlindMode="GameEvent-changeColorBlindMode",t.changeMapType="GameEvent-changeMapType",t.changeNextMap="GameEvent-changeNextMap",t.changePrevMap="GameEvent-changePrevMap",t.showNewVersion="GameEvent-showNewVersion",t.reload="GameEvent-reload"}(we||(we={}));var je=y({entity:Le,name:a.game}),Ae=je.getComponent,Ue=je.setComponent,qe=function(e){var t=e.mesh,n=e.texture,a=e.scene,r=e.color;t.material.diffuseColor=new o.Color3(r[0],r[1],r[2]);var i=function(e){var t=e.textureUrl,n=e.scene;return S[t]?S[t]:C({textureUrl:t,scene:n})}({textureUrl:n,scene:a});return t.material.diffuseTexture=i,i},ze=function(e){var t=e.state,n=e.ai,a=Ae({state:t});return n&&(null==a?void 0:a.colorBlindMode)?n.textureSet:Oe},Re=function(e){return e>2*Math.PI||e<-2*Math.PI?-2*Math.PI:e},Ge=function(e){var t=e.boxUniqueId,n=e.animationEndCallback,a=(e.direction,e.color),r=e.texture,i=Ca.getTransformNodeByUniqueId(parseInt(t));if(i){var s=o.Tools.ToRadians(90)*(Math.random()>.5?1:-1),c=Math.random()>.5?"x":"y",u=i.rotation,l=new o.Vector3("x"===c?s:0,"y"===c?s:0,0).add(u),d=new o.Vector3(Re(l.x),Re(l.y),Re(l.z)),p=new o.Animation("rotateAnimation","rotation",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),f=new o.AnimationEvent(.5,n,!0);p.addEvent(f);var v=[];v.push({frame:0,value:u}),v.push({frame:.5,value:d}),p.setKeys(v),i.animations[i.animations.length]=p,Ca.beginAnimation(i,0,1,!1);var y=i.getChildren();y.slice(1,y.length).forEach((function(e){var t=Ca.getMeshByUniqueId(e.uniqueId);t&&qe({mesh:t,color:a,texture:r,scene:Ca})}))}},Ve=function(e){var t=e.boxUniqueId,n=e.texture,a=e.color,r=Ca.getTransformNodeByUniqueId(parseInt(t));r&&(r.rotation.x=0,r.rotation.y=0,r.getChildren().forEach((function(e){var t=Ca.getMeshByUniqueId(e.uniqueId);t&&qe({mesh:t,color:a,texture:n,scene:Ca})})))},Ne=function(){return(Ne=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Fe=function(e,t,n){return e&&e[n]?e[n][t]:void 0},Qe=function(e){return[e[1][0],e[0][1],e[1][2],e[2][1]]},We=function(e,t){var n=t[0],a=t[1];return[[Fe(e,a-1,n-1),Fe(e,a,n-1),Fe(e,a+1,n-1)],[Fe(e,a-1,n),Fe(e,a,n),Fe(e,a+1,n)],[Fe(e,a-1,n+1),Fe(e,a,n+1),Fe(e,a+1,n+1)]]},De=function(){return(De=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},_e=function(e){var t=e.state,n=Ae({state:t});return n?n.grid.reduce((function(e,n){var r=f({name:a.box,state:t,entity:n});if(r){var o=r.gridPosition[0],i=r.gridPosition[1];e[o]||(e[o]=[]),e[o][i]=De(De({},r),{points:0})}return e}),[]):[]},Ye=function(){return(Ye=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},He=function(e,t){for(var n=0,a=t.length,r=e.length;n<a;n++,r++)e[r]=t[n];return e},Ke=function(e){var t=e.entity,n=e.state,a=Ae({state:n});return a?l({state:n,data:Ye(Ye({},a),{boxRotationQueue:He(He([],a.boxRotationQueue),[t])})}):n},$e=function(){return($e=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Je=function(e){return 6===e?1:e+1},Xe=function(e){var t=e.state,n=e.ai,a=e.box,r=a.entity,o=a.dots;return n&&(o=Je(a.dots),Ge({boxUniqueId:r,animationEndCallback:function(){pa({type:Jn.Type.rotationEnd,payload:{ai:n,shouldExplode:6===a.dots,boxEntity:r}})},texture:ze({state:t,ai:n})[o],color:n.color}),t=Ke({entity:r,state:t})),l({state:t,data:$e($e({},a),{isAnimating:!0,player:(null==n?void 0:n.entity)||"",dots:o})})},Ze=function(){return(Ze=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},et=function(){return(et=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},tt=function(e){var t=e.getEngine().getRenderingCanvasClientRect();return null!==t?t.height/t.width:1},nt=function(e){var t=e.value,n=e.min,a=e.max;return t<=n?n:t>=a?a:t},at=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},rt=[1,1,1],ot=[.6,.6,.6],it=[.11,.79,.29],st=[.09,.84,1],ct=[1,.73,.29],ut=[.99,.97,.32],lt=[.99,.42,.45],dt=[.99,.47,.94],pt=[.67,.23,.94],ft=function(e,t){return e+Math.random()*t-Math.random()*t},vt=function(e){var t=function(e){var t,n,a=e[0],r=e[1],o=e[2],i=Math.max(a,r,o),s=Math.min(a,r,o),c=(i+s)/2;if(i==s)t=n=0;else{var u=i-s;switch(n=c>.5?u/(2-i-s):u/(i+s),i){case a:t=(r-o)/u+(r<o?6:0);break;case r:t=(o-a)/u+2;break;case o:t=(a-r)/u+4}t/=6}return[t,n,c]}(e),n=[t[0],nt({value:ft(t[1],.2),min:0,max:1}),nt({value:ft(t[2],.2),min:0,max:1})];return function(e){var t,n,a,r=e[0],o=e[1],i=e[2];if(0==o)t=n=a=i;else{var s=i<.5?i*(1+o):i+o-i*o,c=2*i-s;t=at(c,s,r+1/3),n=at(c,s,r),a=at(c,s,r-1/3)}return[t,n,a]}([n[0],n[1],n[2]])},yt=function(e){return[vt(e),vt(e),vt(e),vt(e),vt(e),vt(e),vt(e),vt(e),vt(e),vt(e)]},mt=(yt(ot),yt(it),yt(st)),gt=(yt(ct),yt(ut),yt(lt),yt(dt),yt(pt),null),ht=function(e){var t,n=e.entity;return null===(t=null==gt?void 0:gt.getChildren().find((function(e){return e.name===$t})))||void 0===t?void 0:t.getChildByName(n)},bt=[768,1200,1400],xt=function(e){return function(t){return t.find((function(t,n){return e<bt[n]}))||t[t.length-1]}},Tt=function(e){var t=e.state,n=e.elements,a=e.screenRatio,r=e.canvasWidth;return n&&(t=Object.entries(n).reduce((function(e,t){var n=t[0],o=function(e){var t,n=e.element,a=e.screenRatio,r=xt(e.canvasWidth),o=[100*((t=r(n.position))[0]-.5)+"%",100*(t[1]-.5)+"%"],i=o[0],s=o[1],c=r(n.size),u=n.aspectRatio&&r(n.aspectRatio)?[c[0],c[1]/a]:[c[0],c[1]],l=n.minSize?r(n.minSize):[0,0],d=n.maxSize?r(n.maxSize):[1,1];return{width:nt({value:u[0],min:l[0],max:d[0]}),height:nt({value:u[1],min:l[1],max:d[1]}),left:i,top:s}}({element:t[1],screenRatio:a,canvasWidth:r}),i=o.width,s=o.height,c=o.top,u=o.left,l=ht({entity:n});return l&&(l.width=i,l.height=s,l.top=c,l.left=u),e}),t)),t},wt=function(e){var t=e.state,n=e.scene,r=n.getEngine().getRenderingCanvasClientRect(),o=r?r.width:1,i=tt(n),s=v({state:t,name:a.uiButton}),c=v({state:t,name:a.uiText}),u=v({state:t,name:a.uiImage});t=Tt({elements:s,state:t,screenRatio:i,canvasWidth:o}),t=Tt({elements:c,state:t,screenRatio:i,canvasWidth:o}),t=Tt({elements:u,state:t,screenRatio:i,canvasWidth:o});var l=[24,24,24];return function(e){var t=e.state,n=e.elements,a=e.callback;return n&&(t=Object.entries(n).reduce((function(e,t){var n=ht({entity:t[0]});return n?a(e,t,n):e}),t)),t}({state:t,elements:c,callback:function(e,t,n){t[0];var a=t[1];if(a){var r=xt(o)(a.fontSize||l);n.fontSize=r}return e}})},Ot=function(e){var t,n=e.state;return null===(t=e.advancedTexture.getChildren().find((function(e){return e.name===$t})))||void 0===t||t.clearControls(),n=p({state:n,name:a.uiImage}),n=p({state:n,name:a.uiButton}),p({state:n,name:a.uiText})},Pt=(n(290),function(){return Math.floor(1e17*Math.random())}),St=function(e){var t,n=e.entity,a=e.advancedTexture,r=e.onPointerUpObservable,o=null===(t=a.getChildren().find((function(e){return e.name===$t})))||void 0===t?void 0:t.getChildByName(n);o&&o.onPointerUpObservable.add(r)},Ct=Pt().toString(),Et=Pt().toString(),kt=Pt().toString(),Mt=Pt().toString(),Bt=Pt().toString(),It=Pt().toString(),Lt=Pt().toString(),jt=Pt().toString(),At=function(e){switch(e){case T.disabled:return"Disabled";case T.random:return"Random";case T.easy:return"Easy";case T.medium:return"Medium";case T.hard:return"Hard"}},Ut="localDbKey",qt=function(){localStorage.removeItem(Ut)},zt=Pt().toString(),Rt=Pt().toString();const Gt=n.p+"806110d75fbc4c9b3598b4b81f2a4956.png",Vt=n.p+"d92d9a24479eeab673123ba21ca7f9b6.png",Nt=n.p+"c94ac6f5120115631e135dfe4054cb79.png";var Ft,Qt=Pt().toString(),Wt=Pt().toString(),Dt=Pt().toString(),_t=Pt().toString(),Yt=function(e){var t=e.state,n=e.advancedTexture,r=e.attachEvents;switch(e.uiType){case u.customLevel:t=function(e){var t=e.state,n=[E,E,E];return t=l({state:t,data:{src:n,entity:zt,name:a.uiButton,text:"X",size:[[.1,.1],[.1,.1],[.1,.1]],position:[[.95,.05],[.95,.05],[.95,.05]]}}),l({state:t,data:{src:n,entity:Rt,name:a.uiImage,size:[[.6,.6],[.6,.6],[.6,.6]],position:[[.2,.2],[.2,.2],[.2,.2]]}})}({state:t}),r&&function(e){St({advancedTexture:e.advancedTexture,entity:zt,onPointerUpObservable:function(){qt(),pa({type:we.Type.cleanScene,payload:{newScene:u.mainMenu}})}})}({advancedTexture:n});break;case u.mainMenu:t=function(e){var t=e.state,n=e.advancedTexture,r=[!0,!0,!0],o=[[.6,.2],[.4,.15],[.2,.1]],i=[[.6,.2],[.4,.15],[.2,.1]],s=[[.6,.1],[.4,.1],[.2,.1]],c=[Gt,Vt,Nt];t=l({state:t,data:{src:c,entity:Qt,name:a.uiButton,text:"Start",size:o,maxSize:i,minSize:s,aspectRatio:r,position:[[.5,.5],[.5,.5],[.5,.5]]}}),t=l({state:t,data:{src:c,entity:Wt,name:a.uiButton,text:"Custom level",size:o,maxSize:i,minSize:s,aspectRatio:r,position:[[.5,.7],[.5,.7],[.5,.7]]}});var u=Ae({state:t});return t=l({state:t,data:{entity:Dt,name:a.uiText,text:"version "+(null==u?void 0:u.version),size:o,color:"#444",fontSize:[24,24,24],position:[[.9,.9],[.9,.9],[.9,.9]]}}),(null==u?void 0:u.newVersionAvailable)&&(t=l({state:t,data:{src:c,entity:_t,name:a.uiButton,text:"New version available. Click here to reload",size:[[.2,.2],[.2,.2],[.2,.2]],position:[[.1,.1],[.1,.1],[.1,.1]]}}),St({advancedTexture:n,entity:_t,onPointerUpObservable:function(){pa({type:we.Type.reload,payload:{}})}})),t}({state:t,advancedTexture:n}),r&&function(e){var t=e.advancedTexture;St({advancedTexture:t,entity:Qt,onPointerUpObservable:function(){pa({type:we.Type.cleanScene,payload:{newScene:u.customLevelSettings}})}}),St({advancedTexture:t,entity:Wt,onPointerUpObservable:function(){pa({type:we.Type.cleanScene,payload:{newScene:u.customLevelSettings}})}})}({advancedTexture:n});break;case u.customLevelSettings:t=function(e){var t,n=e.state,r=Ae({state:n}),o=[[.5,.1],[.4,.1],[.3,.1]],i=[E,E,E];return n=l({state:n,data:{entity:Bt,name:a.uiText,text:"Map",size:[[.9,.1],[.4,.1],[.3,.1]],position:[[.5,.05],[.5,.05],[.5,.05]]}}),n=l({state:n,data:{src:i,entity:Lt,name:a.uiButton,text:"<",size:[[.1,.5],[.2,.5],[.2,.5]],position:[[.1,.25],[.2,.25],[.2,.25]]}}),n=l({state:n,data:{src:i,entity:It,name:a.uiButton,text:">",size:[[.1,.5],[.2,.5],[.2,.5]],position:[[.9,.25],[.8,.25],[.8,.25]]}}),n=l({state:n,data:{src:i,entity:jt,name:a.uiButton,text:"Start >",size:o,position:[[.5,.6],[.5,.6],[.5,.6]]}}),n=l({state:n,data:{src:i,entity:Et,name:a.uiButton,text:"Difficulty: "+((null==r?void 0:r.customLevelSettings.difficulty)?At(null==r?void 0:r.customLevelSettings.difficulty):"-"),size:o,position:[[.25,.75],[.25,.75],[.25,.75]]}}),n=l({state:n,data:{src:i,entity:Ct,name:a.uiButton,text:"Players: "+(null===(t=null==r?void 0:r.customLevelSettings.players)||void 0===t?void 0:t.length),size:o,position:[[.25,.85],[.25,.85],[.25,.85]]}}),n=l({state:n,data:{src:i,entity:kt,name:a.uiButton,text:"["+((null==r?void 0:r.customLevelSettings.quickStart)?"x":" ")+"] Quick Start",size:o,position:[[.75,.75],[.75,.75],[.75,.75]]}}),l({state:n,data:{src:i,entity:Mt,name:a.uiButton,text:"["+((null==r?void 0:r.colorBlindMode)?"x":" ")+"] Color blind mode",size:o,position:[[.75,.85],[.75,.85],[.75,.85]]}})}({state:t}),r&&function(e){var t=e.advancedTexture;St({advancedTexture:t,entity:Ct,onPointerUpObservable:function(){pa({type:we.Type.changePlayers,payload:{}})}}),St({advancedTexture:t,entity:Et,onPointerUpObservable:function(){pa({type:we.Type.changeDifficulty,payload:{}})}}),St({advancedTexture:t,entity:kt,onPointerUpObservable:function(){pa({type:we.Type.changeQuickStart,payload:{}})}}),St({advancedTexture:t,entity:Mt,onPointerUpObservable:function(){pa({type:we.Type.changeColorBlindMode,payload:{}})}}),St({advancedTexture:t,entity:Bt,onPointerUpObservable:function(){pa({type:we.Type.changeMapType,payload:{}})}}),St({advancedTexture:t,entity:It,onPointerUpObservable:function(){pa({type:we.Type.changeNextMap,payload:{}})}}),St({advancedTexture:t,entity:Lt,onPointerUpObservable:function(){pa({type:we.Type.changePrevMap,payload:{}})}}),St({advancedTexture:t,entity:jt,onPointerUpObservable:function(){pa({type:we.Type.startCustomLevel,payload:{}})}})}({advancedTexture:n})}return t},Ht=function(e){var t,n,a=e.state;return n=BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI("ui",!0,Ca),a=Ot({advancedTexture:gt=n,state:a}),a=Yt({state:a,advancedTexture:gt,attachEvents:!0,uiType:(null===(t=Zt({state:a}))||void 0===t?void 0:t.type)||u.mainMenu}),wt({state:a,scene:Ca}),a},Kt="23505760496063488",$t="root";!function(e){(e.Type||(e.Type={})).changeUrl="UIEvent-changeUrl"}(Ft||(Ft={}));var Jt,Xt=y({entity:Kt,name:a.ui}),Zt=Xt.getComponent,en=function(e){var t,n=e.state,a=e.data,r=e.cleanControls;if(gt){var o=(null==a?void 0:a.type)||(null===(t=Zt({state:n}))||void 0===t?void 0:t.type)||u.mainMenu;r?(n=Ot({advancedTexture:gt,state:n}),n=Yt({state:n,advancedTexture:gt,attachEvents:!0,uiType:o})):n=Yt({state:n,advancedTexture:gt,attachEvents:!1,uiType:o})}return wt({state:n,scene:Ca}),Xt.setComponent({state:n,data:a})},tn=function(){return(tn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},nn=function(e,t,n,r,o){return void 0===r&&(r=!1),void 0===o&&(o=T.easy),{entity:e,name:a.ai,human:r,level:o,color:t,textureSet:n,active:!0}},an=function(){return[nn(Pa,st,Oe,!0,T.easy),nn("2",lt,Pe,!1,T.easy),nn("3",it,Se,!1,T.easy),nn("4",ut,Ce,!1,T.easy),nn("5",ct,Ee,!1,T.easy),nn("6",dt,ke,!1,T.easy),nn("7",ot,Me,!1,T.easy),nn("8",pt,Be,!1,T.easy)]},rn=function(e){var t=Ca.getMeshByUniqueId(parseFloat(sn)),n=Rn({state:e});if(t&&n){var a=Vn(n.distance,Ca);t.position.x=n.position[0],t.position.y=n.position[1],t.scaling=new o.Vector3(Math.abs(a.left)+Math.abs(a.right),Math.abs(a.bottom)+Math.abs(a.top),1)}return e},on=function(e){var t=e.state;e.component,o.Effect.ShadersStore.customVertexShader=" \n    precision highp float;\n    precision highp int;\n\n    // Attributes\n    attribute vec3 position;\n    attribute vec2 uv;\n\n    // Uniforms\n    uniform mat4 worldViewProjection;\n\n    // Varying\n    varying vec2 vUV;\n\n    void main(void) {\n        gl_Position = worldViewProjection * vec4(position, 1);\n        vUV = uv;\n    }\n  ",o.Effect.ShadersStore.customFragmentShader="\n    precision highp float;\n    precision highp int;\n\n    uniform highp float iTime;\n    uniform vec2 iResolution;\n    uniform highp float[30] iColors;\n\n    // const vec2 iResolution = vec2(512, 512);\n    \n    struct RadialGradient {\n        float radius;\n        vec4 color;\n        vec2 point;\n    };\n  \n    void main(void) {\n        float w = iResolution.x / 2.;\n        float h = iResolution.y / 2.;\n  \n        float fill = max(iResolution.x, iResolution.y);\n        // float contain = min(iResolution.x, iResolution.y);\n\n        highp vec4 colors[10];\n        colors[0] = vec4(iColors[0],iColors[1],iColors[2], 0.7);\n        colors[1] = vec4(iColors[3],iColors[4],iColors[5], 0.7);\n        colors[2] = vec4(iColors[6],iColors[7],iColors[8], 0.7);\n        colors[3] = vec4(iColors[9],iColors[10],iColors[11], 0.7);\n        colors[4] = vec4(iColors[12],iColors[13],iColors[14], 0.7);\n        colors[5] = vec4(iColors[15],iColors[16],iColors[17], 0.7);\n        colors[6] = vec4(iColors[18],iColors[19],iColors[20], 0.7);\n        colors[7] = vec4(iColors[21],iColors[22],iColors[23], 0.7);\n        colors[8] = vec4(iColors[24],iColors[25],iColors[26], 0.7);\n        colors[9] = vec4(iColors[27],iColors[28],iColors[29], 0.7);\n        \n  \n        // gradients\n        RadialGradient gradients[] = RadialGradient[](\n            RadialGradient(1.0, colors[0], vec2(0.5 * w * sin(.13 * iTime - 0.44) + w, 0.5 * h * sin(.34 * iTime - 2.41) + h)),\n            RadialGradient(1.0, colors[1], vec2(0.5 * w * sin(.93 * iTime - 5.58) + w, 1.0 * h * sin(.82 * iTime - 3.04) + h)),\n            RadialGradient(1.0, colors[2], vec2(1.0 * w * sin(.45 * iTime - 2.70) + w, 0.5 * h * sin(.94 * iTime - 5.24) + h)),\n            RadialGradient(1.0, colors[3], vec2(1.0 * w * sin(.15 * iTime - 3.59) + w, 1.0 * h * sin(.96 * iTime - 5.11) + h)),\n            RadialGradient(1.0, colors[4], vec2(0.5 * w * sin(.35 * iTime - 4.73) + w, 0.5 * h * sin(.42 * iTime - 3.87) + h)),\n            RadialGradient(1.0, colors[5], vec2(0.5 * w * sin(.62 * iTime - 4.81) + w, 1.0 * h * sin(.19 * iTime - 1.17) + h)),\n            RadialGradient(1.0, colors[6], vec2(1.0 * w * sin(.58 * iTime - 5.13) + w, 0.5 * h * sin(.10 * iTime - 2.08) + h)),\n            RadialGradient(0.5, colors[7], vec2(1.5 * w * sin(.12 * iTime - 4.36) + w * 2., 0.5 * h * sin(.08 * iTime - 1.48) + h * 2.)),\n            RadialGradient(0.6, colors[8], vec2(1.5 * w * sin(.07 * iTime - 3.94) + w * 2., 0.6 * h * sin(.03 * iTime - 2.03) + h * 2.)),\n            RadialGradient(0.5, colors[9], vec2(1.5 * w * sin(.01 * iTime - 3.74) + w * 2., 0.5 * h * sin(.12 * iTime - 0.62) + h * 2.))\n        );\n  \n        vec3 color = vec3(0.);\n  \n        for(int i = 0; i < gradients.length(); ++i) {\n            color = mix(\n                gradients[i].color.rgb,\n                color,\n                gradients[i].color.a * distance(gradients[i].point, gl_FragCoord.xy) / ( fill * gradients[i].radius)\n            );\n        }\n  \n        gl_FragColor = vec4(color,1.0);\n    }\n  ";var n=new o.ShaderMaterial("shader",Ca,{vertex:"custom",fragment:"custom"},{attributes:["position","normal","uv"],uniforms:["worldViewProjection","time","resolution","gridSize","colors","gridColors"]});n.setFloat("time",performance.now()),n.setVector3("resolution",new o.Vector3(window.innerWidth,window.innerHeight,0)),n.backFaceCulling=!1;var a=o.MeshBuilder.CreatePlane(sn,{size:1},Ca);a.uniqueId=parseFloat(sn),a.material=n;var r=an();return a.material.setColor3Array("colors",r.map((function(e){var t=e.color,n=t[0],a=t[1],r=t[2];return new o.Color3(n,a,r)}))),rn(t)},sn="17818552155683748",cn=y({entity:sn,name:a.background}),un=(cn.getComponent,function(e,t){return void 0===t&&(t={}),Pt().toString()}),ln=1.2,dn=function(e){var t=e.state,n=_e({state:t}),a=n[0]?1.2*n[0].length:1,r=1.2*n.length;return{width:a,height:r,center:[(a-1-.2)/2,(r-1-.2)/2],cameraDistance:(a>r?a:r)/2+.2}},pn=function(e){var t=e.state,n=e.boxScaleFactor,a=Rn({state:t});return a?{leftEdge:a.position[0]+a.left,topEdge:a.position[1]+a.top,boxSize:ln/n,screenSize:[2*a.right,2*a.top]}:{leftEdge:0,topEdge:0,boxSize:0,screenSize:[0,0]}},fn=function(){return(fn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},vn=function(e){var t=e.state,n=Sn({state:t});if(!n)return t;var r=function(e){var t=e.state,n=e.component,a=pn({state:t,boxScaleFactor:3}),r=a.boxSize,o=a.screenSize,i=tt(Ca),s=n.boxes.length*r,c=dn({state:t}),u=c.width,l=c.height,d=(o[0]-u)/2+u,p=(o[1]-l)/2+l,f=[i<1&&o[0]-d-2<=0,i>1&&o[1]-p-s<=0];return f[0]||f[1]}({state:t,component:n});if(!0===n.isVisible&&!0===r||!1===n.isVisible&&!1===r){var o=!n.isVisible;t=l({state:t,data:fn(fn({},n),{isVisible:o})}),n.boxes.forEach((function(e,t){var n=Ca.getTransformNodeByUniqueId(parseFloat(e));null==n||n.setEnabled(o)}));var i=Ca.getMeshByUniqueId(parseFloat(On));null==i||i.setEnabled(o),!o&&n.texts.forEach((function(e){var n=f({state:t,name:a.uiText,entity:e});n&&(t=l({state:t,data:fn(fn({},n),{position:[[-1,-1],[-1,-1],[-1,-1]]})}))}))}return t},yn=function(e){var t=e.state,n=(Sn({state:t}),Ae({state:t})),a=pn({state:t,boxScaleFactor:3}),r=a.leftEdge,o=a.topEdge,i=a.boxSize,s=tt(Ca),c=Ca.getMeshByUniqueId(parseFloat(On));if(c&&n){var u=n.playersQueue.findIndex((function(e){return e===n.currentPlayer}))+1;c.position.x=r+1,c.position.y=o-u*i,c.scaling.x=s<1?2:5,c.scaling.y=i}return t},mn=function(){return(mn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},gn=function(e){var t=e.state,n=e.scene,r=Sn({state:t});if(!r||!1===r.isVisible)return t;var o=pn({state:t,boxScaleFactor:3}),i=o.leftEdge,s=o.topEdge,c=o.boxSize,u=o.screenSize;return r.boxes.forEach((function(e,o){var d=[i+c,s-o*c-c],p=[(d[0]-i+c)/u[0],(s-d[1])/u[1]],v=n.getTransformNodeByUniqueId(parseFloat(e));v?(v.position.x=d[0],v.position.y=d[1]):console.log("mesh doesnt exist",e);var y=f({state:t,name:a.uiText,entity:r.texts[o]});if(y){var m=p[0]+y.size[0][0]/2;t=l({state:t,data:mn(mn({},y),{position:[[m,p[1]],[m,p[1]],[m,p[1]]]})})}})),t=yn({state:t})},hn=function(){return(hn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},bn=function(e){var t=e.state,n=e.component,r=Ae({state:t}),i=Rn({state:t});if(!r||!i)return t;var s=null==r?void 0:r.playersQueue.map((function(e,n){var r=f({state:t,name:a.ai,entity:e}),o=un(),i=va({scene:Ca,name:"turnIndicatorBox-"+n,position:[0,0],uniqueId:parseFloat(o),color:(null==r?void 0:r.color)||[1,1,1],ai:r,dots:1,state:t,isClickable:!1});return i.scaling.x=1/3,i.scaling.y=1/3,o})),c=null==r?void 0:r.playersQueue.map((function(e,n){var r=f({state:t,name:a.ai,entity:e}),o=un();return t=l({state:t,data:{entity:o,name:a.uiText,text:(null==r?void 0:r.human)?"Player":"Computer",size:[[.8,.1],[.8,.1],[.8,.1]],color:"#444",fontSize:[18,20,24],position:[[0,0],[0,0],[0,0]]}}),o}));!function(e){var t=e.scene,n=e.entity,a=o.Mesh.CreatePlane("highlighter",1,t,!1);a.material=new o.StandardMaterial("mat",t),a.material.diffuseColor=new o.Color3(1,1,1),a.material.alpha=.8,a.uniqueId=parseFloat(n)}({scene:Ca,entity:On});var u=hn(hn({},n),{boxes:s,texts:c});return t=l({state:t,data:u}),t=vn({state:t}),t=gn({state:t,scene:Ca}),t=yn({state:t}),t=wt({state:t,scene:Ca})},xn=function(e){var t=e.state,n=e.component;n.boxes.forEach((function(e,t){var n=Ca.getTransformNodeByUniqueId(parseFloat(e));null==n||n.dispose()})),n.texts.forEach((function(e,n){t=d({state:t,name:a.uiText,entity:e})}));var r=Ca.getMeshByUniqueId(parseFloat(On));return null==r||r.dispose(),t},Tn=function(){return(Tn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},wn="68127445920450266",On="6614618891614099",Pn=y({entity:wn,name:a.turnIndicator}),Sn=Pn.getComponent,Cn=function(e){var t=e.percentage;return e.total*t},En=[[1,0,0,1,0,0,1,1,0,0,0,1,1,0,1,1,1,0,1,0,0,1,0,1],[1,0,1,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,1,0,1,0,0,1],[1,1,0,0,0,1,0,0,1,0,1,1,1,0,0,1,0,0,1,1,0,0,0,1],[1,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0,1],[1,0,0,1,0,0,1,1,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,1]].reduce((function(e,t,n){return e[n]=t.reduce((function(e,t,n){if(0===t)e[n]="";else{var a=Pt().toString();e[n]=a}return e}),[]),e}),[]),kn=function(e){var t=e.state,n=Ca.getTransformNodeByUniqueId(parseFloat(In)),a=Rn({state:t});if(n&&a){var r=pn({state:t,boxScaleFactor:3.2}),o=r.topEdge,i=r.boxSize,s=r.screenSize,c=[En[0].length*i,En.length*i],u=[a.position[0]-c[0]/2,o-Cn({total:s[1],percentage:.1})];En.forEach((function(e,t){return e.forEach((function(e,a){if(""!==e){var r=Ca.getTransformNodeByUniqueId(parseFloat(e));if(r){var o=[u[0]+a*i,u[1]+-t*i];r.position.x=n.position.x+o[0],r.position.y=n.position.y+o[1]}}}))}))}},Mn=function(e){var t=e.state,n=new o.TransformNode("logo",Ca);return n.uniqueId=parseFloat(In),n.position.x=0,n.position.y=0,function(e){var t=e.state;En.forEach((function(e,n){return e.forEach((function(e,n){""!==e&&va({scene:Ca,name:"logo box",uniqueId:parseFloat(e),position:[0,0],color:[1,1,1],state:t,ai:void 0,dots:0,isClickable:!1,scaleFactor:3.2})}))}))}({state:t}),kn({state:t}),pa({type:Jt.Type.rotateBox,payload:{}}),t},Bn=function(e){var t=e.state,n=Ca.getTransformNodeByUniqueId(parseFloat(In));return null==n||n.dispose(),En.flat().forEach((function(e){var t=Ca.getTransformNodeByUniqueId(parseFloat(e));null==t||t.dispose()})),t},In="8523773494048061";!function(e){(e.Type||(e.Type={})).rotateBox="rotateBox"}(Jt||(Jt={}));var Ln,jn=y({entity:In,name:a.logo}),An=jn.getComponent,Un=function(){return(Un=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},qn="cameraEntity";!function(e){(e.Type||(e.Type={})).resize="CameraEvent-resize"}(Ln||(Ln={}));var zn=y({entity:qn,name:a.camera}),Rn=zn.getComponent,Gn=function(e){var t,n=e.state,a=e.data,r=function(e){var t,n=e.component;n.position&&(Ea.position.x=n.position[1],Ea.position.y=n.position[0],Ea.position.z=-10,Ea.setTarget(new o.Vector3(n.position[1],n.position[0])));var a=Vn(null!==(t=n.distance)&&void 0!==t?t:0,Ca);return Ea.orthoLeft=a.left,Ea.orthoRight=a.right,Ea.orthoBottom=a.bottom,Ea.orthoTop=a.top,a}({component:a});return n=function(e){var t=e.state,n=e.data;t=vn({state:t}),t=gn({state:t,scene:Ca});var a=Sn({state:t});return Pn.setComponent({state:t,data:Tn(Tn({},n),a||{})})}({state:n=function(e){var t=e.state,n=e.data;return rn(t),cn.setComponent({state:t,data:n})}({state:n=zn.setComponent({state:n,data:Un(Un({},a),r)}),data:{}}),data:{}}),kn({state:(t={state:n,data:{}}).state}),jn.setComponent(t)},Vn=function(e,t){var n=tt(t);return n>1?{left:-e,right:e,bottom:-e*n,top:e*n}:{bottom:-e,top:e,left:-e/n,right:e/n}},Nn=function(e){var t=e.state;return e.scene===u.mainMenu&&(t=l({state:t,data:{entity:In,name:a.logo}})),t},Fn={emptyBox:50,preferEmptyBoxes:15,advancedAttack:7,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:10,playerLessThanOponent:-10,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:-15,sixToSix:50,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:2,playerLessThanOponent:7,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:0,toBorder:0}},Qn={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:2,playerLessThanOponent:-2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:1,playerLessThanOponent:2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:0,toBorder:0}},Wn={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:0,playerLessThanOponent:-2,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:5,playerEqualToOponent:0,playerLessThanOponent:5,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:0,toBorder:0}},Dn=function(){return(Dn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},_n=function(){return(_n=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Yn=function(){return(Yn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Hn=function(e){var t,n=e.state,a=e.ai,r=e.preferEmptyBoxes,o=a.entity,i=(t={},t[T.disabled]=Wn,t[T.random]=Wn,t[T.easy]=Wn,t[T.medium]=Qn,t[T.hard]=Fn,t)[a.level],s=_e({state:n});if(s=function(e){var t=e.dataGrid,n=e.currentPlayer,a=e.preferEmptyBoxes,r=e.aIGridPoints;return t.reduce((function(e,o,i){return e[i]=o.reduce((function(e,o,s){if(o.player!==n.entity&&void 0!==o.player)return e;var c=We(t,[i,s]),u=function(e){var t=e.grid3x3,n=e.preferEmptyBoxes,a=e.currentPlayer,r=e.aIGridPoints,o=t[1][1];return Qe(t).reduce((function(e,t){if(!t)return e+r.adjacted.toBorder;var i=o.dots===t.dots?w.equal:o.dots>t.dots?w.more:w.less;if(t.player!==o.player&&void 0!==t.player){if(n&&void 0===o.player&&t.player===a.entity)return Math.random()>.5?e+r.preferEmptyBoxes:e;if(i===w.more){var s=o.dots-t.dots;return e+r.adjacted.playerMoreThanOponent-s}if(i===w.equal)return e+r.adjacted.playerEqualToOponent*o.dots;if(i===w.less)return s=o.dots-t.dots-t.dots,e+r.adjacted.playerLessThanOponent*Math.abs(s)}else{if(6===o.dots)return e;if(i===w.more)return e+r.adjacted.playerMoreThanPlayer;if(i===w.equal)return 6===t.dots&&6===o.dots?e+r.adjacted.sixToSix:e+r.adjacted.playerEqualToPlayer;if(i===w.less)return 6===t.dots?e+2*r.adjacted.playerLessThanPlayer:e+r.adjacted.playerLessThanPlayer}return e}),0)}({grid3x3:c,preferEmptyBoxes:a,currentPlayer:n,aIGridPoints:r})+function(e){var t=e.grid3x3,n=e.aIGridPoints,a=t[1][1];return function(e){return[e[0][0],e[0][2],e[2][0],e[2][2]]}(t).reduce((function(e,t){if(!t)return e+n.diagonall.toBorder;var r=a.dots===t.dots?w.equal:a.dots>t.dots?w.more:w.less;if(t.player!==a.player&&void 0!==t.player){if(r===w.more)return e+n.diagonall.playerMoreThanOponent;if(r===w.equal)return 6===t.dots?e+-10*n.diagonall.playerEqualToOponent:e+n.diagonall.playerEqualToOponent;if(r===w.less)return 6===t.dots?e+2*n.diagonall.playerLessThanOponent:e+n.diagonall.playerLessThanOponent}else{if(6===a.dots)return e;if(r===w.more)return e+n.diagonall.playerMoreThanPlayer;if(r===w.equal)return e+n.diagonall.playerEqualToPlayer;if(r===w.less){var o=t.dots-a.dots;return e+n.diagonall.playerLessThanPlayer+Math.pow(o,2)}}return e}),0)}({grid3x3:c,preferEmptyBoxes:a,currentPlayer:n,aIGridPoints:r});return e[s]=Ne(Ne({},o),{points:o.points+u}),e}),o),e}),t)}({currentPlayer:a,dataGrid:s=function(e){var t=e.dataGrid,n=e.aIGridPoints;return t.reduce((function(e,t,a){return e[a]=t.reduce((function(e,t,a){var r=void 0===t.player?t.points+n.emptyBox:t.points;return e[a]=_n(_n({},t),{points:r}),e}),t),e}),t)}({dataGrid:s,aIGridPoints:i}),preferEmptyBoxes:!!r,aIGridPoints:i}),!r)switch(a.level){case T.disabled:s=function(e){var t=e.dataGrid;return t.reduce((function(e,t,n){return e[n]=t.reduce((function(e,t,n){return e[n].player="-1",e}),t),e}),t)}({dataGrid:s});break;case T.random:s=function(e){var t=e.dataGrid,n=e.currentPlayer;return t.reduce((function(e,t,a){return e[a]=t.reduce((function(e,t,a){return t.player!==n||void 0===t.player||(e[a]=Yn(Yn({},t),{points:100*Math.random()})),e}),t),e}),t)}({dataGrid:s,currentPlayer:o});break;case T.hard:s=function(e){var t=e.dataGrid,n=e.currentPlayer;return t.reduce((function(e,a,r){return e[r]=a.reduce((function(e,a,o){if(a.player!==n)return e;var i=We(t,[r,o]),s=Qe(i);if(s.some((function(e){return 6===(null==e?void 0:e.dots)})))return e;var c=s.reduce((function(e,r){if(!r)return e;var o=void 0!==r.player&&r.player!==n,i=a.dots>=r.dots;if(o&&i&&function(e){var t=e.currentPlayer,n=e.adjactedBox,a=e.dataGrid,r=e.position,o=r[0],i=r[1],s=We(a,[o,i]);return Qe(s).every((function(e){return void 0===e||e.player===t||void 0===e.player||e.dots<=n.dots}))}({currentPlayer:n,adjactedBox:r,dataGrid:t,position:r.gridPosition})){var s=6/a.dots;e+=r.dots*Fn.advancedAttack/s}return e}),0);return e[o]=Dn(Dn({},a),{points:a.points+c}),e}),a),e}),t)}({dataGrid:s,currentPlayer:o})}return function(e){var t=e.currentPlayer,n=-1/0,a=[];e.dataGrid.forEach((function(e){e.forEach((function(e){var r=void 0===e.player,o=e.player===t;(r||o)&&(e.points>n&&(a=[]),e.points>=n&&(n=e.points,a.push(e)))}))}));var r=Math.floor(Math.random()*a.length);return a[r]}({currentPlayer:o,dataGrid:s})};const Kn=n.p+"de1ab0613214552916d369d2014d1d95.png";var $n,Jn,Xn,Zn,ea,ta="38127445920450264",na=y({entity:ta,name:a.marker}),aa=(na.getComponent,na.setComponent),ra=function(e){var t=e.playersQueue,n=e.index,r=e.state,o=f({state:r,name:a.ai,entity:t[n]});return(null==o?void 0:o.active)?o:ra({playersQueue:t,index:n>=t.length?0:n+1,state:r})},oa=function(e){var t=e.state,n=Ae({state:t});if(n){var a=n.playersQueue.findIndex((function(e){return n.currentPlayer===e}));return ra({playersQueue:n.playersQueue,index:a+1,state:t})}},ia=function(){return(ia=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},sa=function(){return(sa=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},ca=function(e){return console.trace("Wrong path",e),e},ua=function(){return(ua=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},la=function(e){var t=e.state,n=Ae({state:t});if(!n)return t;t=function(e){var t=e.state,n=e.game;t=function(e){var t=e.state,n=e.ai;t=p({state:t,name:a.ai});var r=Ae({state:t});return r&&(t=l({state:t,data:sa(sa({},r),{playersQueue:n.map((function(e){return e.entity}))})})),n.reduce((function(e,t){return l({state:e,data:t})}),t)}({state:t=Array.from({length:8}).reduce((function(e,t,n){return Array.from({length:8}).reduce((function(e,t,r){return l({state:e,data:{name:a.box,entity:Pt().toString(),isAnimating:!1,dots:0,gridPosition:[r,n],player:void 0}})}),e)}),t),ai:n.customLevelSettings.players.map((function(e){return ua(ua({},e),{level:n.customLevelSettings.difficulty})}))});var r=dn({state:t}),o=r.center,i=r.cameraDistance;return t=Gn({state:t,data:{position:[o[0],o[1]],distance:i}}),en({state:t,data:{type:u.customLevel},cleanControls:!0})}({state:t,game:n});var r=oa({state:t});if(!r)return ca(t);t=Ue({state:t,data:{currentPlayer:r.entity}});var o=Ae({state:t});if(!o)return ca(t);if(o.customLevelSettings.quickStart&&function(e){var t=e.state,n=Ae({state:t});n&&n.grid.forEach((function(e){var n=f({state:t,entity:e,name:a.box}),r=f({state:t,entity:(null==n?void 0:n.player)||"",name:a.ai});n&&r&&pa({type:Jn.Type.rotate,payload:{color:r.color,texture:ze({state:t,ai:r})[n.dots],direction:$n.up,boxEntity:e}})}))}({state:t=function(e){var t,n=e.state,r=(null===(t=Ae({state:n}))||void 0===t?void 0:t.grid.length)||1;return Array.from({length:2*r}).reduce((function(e){var t=Ae({state:e}),n=f({state:e,name:a.ai,entity:(null==t?void 0:t.currentPlayer)||""});if(!t||!n)return ca(e);var r=Hn({state:e,ai:n,preferEmptyBoxes:!0});if(!r)return ca(e);e=l({state:e,data:ua(ua({},r),{player:n.entity,dots:Je(r.dots)})});var o=oa({state:e});return o?e=l({state:e,data:ua(ua({},t),{currentPlayer:o.entity})}):e}),n)||n}({state:t})}),t=Ue({state:t,data:{gameStarted:!0}}),!r.human){var i=Hn({state:t,ai:r});i&&(t=Xe({box:i,state:t,ai:r}))}return t=l({state:t,data:{entity:wn,name:a.turnIndicator,position:[0,0],boxes:[],texts:[],isVisible:!0}}),l({state:t,data:{entity:ta,name:a.marker,color:[1,1,1],position:[0,0]}})},da=(Xn="first",Zn=[],ea=[],{emitEvent:function(e){"first"===Xn?Zn.push(e):ea.push(e)},eventSystem:function(e){return function(e){var t=e.state,n=e.initialize,a=e.tick,r=b(e,["state","initialize","tick"]),o={name:r.name,priority:r.priority||g.zero,update:void 0,tick:a||O,initialize:n||O,create:O,remove:function(e){return e.state}};return h(h({},t),{system:x(x([],t.system),[o])})}({state:e,name:a.event,tick:function(e){var t=e.state;return Xn="second",ea=[],t=Zn.reduce((function(e,t){return function(e){var t=e.state,n=e.event;switch(n.type){case Ft.Type.changeUrl:t=en({state:t,data:{type:n.payload.uiType},cleanControls:!1});break;case Ln.Type.resize:t=function(e){var t=e.state,n=Rn({state:t});return t=Gn({state:t,data:n||{}}),en({state:t,data:{},cleanControls:!1})}({state:t,event:n});break;case Jt.Type.rotateBox:t=function(e){var t=e.state;if(!An({state:t}))return t;var n,a,r,o=(n=En.flat().filter((function(e){return""!==e})))[Math.floor(n.length*Math.random())],i=(a=Math.floor(Oe.length*Math.random()),Oe[a]),s=(r=function(e,t){for(var n=0,a=t.length,r=e.length;n<a;n++,r++)e[r]=t[n];return e}([rt],an().map((function(e){return e.color}))))[Math.floor(r.length*Math.random())];return Ge({boxUniqueId:o,animationEndCallback:function(){Ve({boxUniqueId:o,texture:i,color:s})},texture:i,color:s}),setTimeout((function(){pa({type:Jt.Type.rotateBox,payload:{}})}),500*Math.random()+500),t}({state:t,event:n});break;case we.Type.startCustomLevel:t=la({state:t,event:n});break;case we.Type.nextTurn:t=function(e){var t=e.state,n=Ae({state:t});if(!n)return t;var r=n.gameStarted,o=n.boxRotationQueue;if(r&&0===o.length){var i=oa({state:t});if(!i)return t;var s=f({name:a.ai,state:t,entity:i.entity});if(!s)return t;if(t=l({state:t,data:ia(ia({},n),{currentPlayer:s.entity})}),!s.human&&s.active){var c=Hn({state:t,ai:s});if(!c)return function(e){var t=e.state,n=e.ai,r=e.component;t=l({state:t,data:ia(ia({},n),{active:!1})});var o=v({state:t,name:a.ai});return 1===Object.values(o||{}).reduce((function(e,t){return t.active?e+1:e}),0)?(qt(),l({state:t,data:ia(ia({},r),{gameStarted:!1})})):(pa({type:we.Type.nextTurn,payload:{ai:n}}),t)}({state:t,component:n,ai:s});t=aa({state:t,data:{color:s.color,position:[c.gridPosition[0]*ln,c.gridPosition[1]*ln]}}),t=Xe({box:c,state:t,ai:s}),t=Ke({state:t,entity:c.entity})}}return function(e){localStorage.setItem(Ut,JSON.stringify(e))}(t),yn({state:t}),t}({state:t,event:n});break;case we.Type.playerClick:t=function(e){var t=e.state,n=e.event,r=Ae({state:t});if(!r)return t;var o=r.currentPlayer,i=r.gameStarted,s=r.boxRotationQueue,c=f({state:t,name:a.box,entity:n.payload.boxEntity}),u=void 0===(null==c?void 0:c.player)||(null==c?void 0:c.player)===o;if(i&&0===s.length&&u){var l=f({name:a.ai,state:t,entity:o});c&&(null==l?void 0:l.human)&&(t=aa({state:t,data:{color:l.color,position:[c.gridPosition[0]*ln,c.gridPosition[1]*ln]}}),t=Xe({box:c,state:t,ai:l}))}return t}({state:t,event:n});break;case we.Type.cleanScene:t=function(e){var t=e.state,n=e.event;return t=en({state:t,data:{type:n.payload.newScene},cleanControls:!0}),t=Ue({state:t,data:{round:0,grid:[],currentPlayer:"",playersQueue:[],boxRotationQueue:[],gameStarted:!1}}),t=p({name:a.box,state:t}),t=p({name:a.ai,state:t}),t=p({name:a.marker,state:t}),t=p({name:a.background,state:t}),t=p({name:a.turnIndicator,state:t}),t=p({name:a.logo,state:t}),Nn({state:t,scene:n.payload.newScene}),t}({state:t,event:n});break;case we.Type.changePlayers:t=function(e){var t,n,a=e.state,r=Ae({state:a});if(!r)return a;var o=8===(null===(t=r.customLevelSettings.players)||void 0===t?void 0:t.length)?2:(null===(n=r.customLevelSettings.players)||void 0===n?void 0:n.length)+1;return a=Ue({state:a,data:{customLevelSettings:tn(tn({},r.customLevelSettings),{players:an().slice(0,o)})}}),en({state:a,data:{},cleanControls:!1})}({state:t,event:n});break;case we.Type.changeDifficulty:t=function(e){var t,n=e.state,a=Ae({state:n});if(!a)return n;var r=[T.easy,T.medium,T.hard],o=r.findIndex((function(e){return e===a.customLevelSettings.difficulty})),i=-1===o?r[0]:null!==(t=r[o+1])&&void 0!==t?t:r[0];return n=Ue({state:n,data:{customLevelSettings:tn(tn({},a.customLevelSettings),{difficulty:i})}}),en({state:n,data:{},cleanControls:!1})}({state:t,event:n});break;case we.Type.changeQuickStart:t=function(e){var t=e.state,n=Ae({state:t});return n?(t=Ue({state:t,data:{customLevelSettings:tn(tn({},n.customLevelSettings),{quickStart:!n.customLevelSettings.quickStart})}}),en({state:t,data:{},cleanControls:!1})):t}({state:t,event:n});break;case we.Type.changeColorBlindMode:t=function(e){var t=e.state,n=Ae({state:t});return n?(t=Ue({state:t,data:{colorBlindMode:!n.colorBlindMode}}),en({state:t,data:{},cleanControls:!1})):t}({state:t,event:n});break;case we.Type.changeMapType:t=function(e){var t=e.state;return en({state:t,data:{},cleanControls:!1})}({state:t,event:n});break;case we.Type.changeNextMap:t=function(e){var t=e.state;return en({state:t,data:{},cleanControls:!1})}({state:t,event:n});break;case we.Type.changePrevMap:t=function(e){var t=e.state;return en({state:t,data:{},cleanControls:!1})}({state:t,event:n});break;case we.Type.showNewVersion:t=function(e){var t=e.state;return t=Ue({state:t,data:{newVersionAvailable:!0}}),en({state:t,data:{},cleanControls:!1})}({state:t,event:n});break;case we.Type.reload:t=function(e){var t=e.state;return window.location.reload(),t}({state:t,event:n});break;case Jn.Type.rotationEnd:t=function(e){var t=e.state,n=e.event.payload,r=n.ai,o=n.shouldExplode,i=n.boxEntity,s=f({state:t,name:a.box,entity:i});if(!s)return t;t=function(e){var t=e.entity,n=e.state,a=Ae({state:n});return a?l({state:n,data:Ze(Ze({},a),{boxRotationQueue:a.boxRotationQueue.filter((function(e){return e!==t}))})}):n}({entity:s.entity,state:t}),Ve({boxUniqueId:s.entity,texture:ze({state:t,ai:r})[s.dots],color:r.color});var c=Ae({state:t});if(!c)return t;o?t=function(e){var t=e.state,n=e.ai,a=e.box.gridPosition,r=a[0],o=a[1],i=_e({state:t});return[Fe(i,o,r-1),Fe(i,o,r+1),Fe(i,o-1,r),Fe(i,o+1,r)].filter((function(e){return void 0!==e})).reduce((function(e,t,a){return e=Xe({ai:n,box:t,state:e}),Ke({entity:t.entity,state:e})}),t)}({state:t,box:s,ai:r}):0===c.boxRotationQueue.length&&pa({type:we.Type.nextTurn,payload:{ai:r}});var u=Ca.getTransformNodeByUniqueId(parseInt(s.entity));return u&&(u.animations=[]),l({state:t,data:et(et({},s),{isAnimating:!1})})}({state:t,event:n});break;case Jn.Type.rotate:t=function(e){var t=e.state,n=e.event;return Ge({boxUniqueId:n.payload.boxEntity,animationEndCallback:function(){Ve({boxUniqueId:n.payload.boxEntity,texture:n.payload.texture,color:n.payload.color})},texture:n.payload.texture,color:n.payload.color}),t}({state:t,event:n})}return t}({state:e,event:t})}),t),Zn=[],Xn="first",Zn=function(e,t){for(var n=0,a=t.length,r=e.length;n<a;n++,r++)e[r]=t[n];return e}([],ea),t}})}}),pa=da.emitEvent,fa=da.eventSystem,va=function(e){var t=e.scene,n=e.name,a=e.uniqueId,r=e.position,i=e.color,s=e.state,c=e.ai,u=e.dots,l=e.isClickable,d=e.scaleFactor,p=1/(void 0===d?1:d),f=new o.TransformNode("box "+n,t);return f.uniqueId=a,f.position.x=r[0],f.position.y=r[1],[[new o.Vector3(0,0,-p/2),new o.Vector3(0,0,0)],[new o.Vector3(-p/2,0,0),new o.Vector3(0,Math.PI/2,0)],[new o.Vector3(0,0,p/2),new o.Vector3(0,Math.PI,0)],[new o.Vector3(p/2,0,0),new o.Vector3(0,-Math.PI/2,0)],[new o.Vector3(0,p/2,0),new o.Vector3(Math.PI/2,0,0)],[new o.Vector3(0,-p/2,0),new o.Vector3(-Math.PI/2,0,0)]].forEach((function(e,n){var r=e[0],d=e[1],v=o.MeshBuilder.CreatePlane("plane"+n,{size:p});v.parent=f,v.material=new o.StandardMaterial("mat",t),qe({mesh:v,color:i,texture:ze({state:s,ai:c})[u],scene:t}),v.material.alpha=1,v.position=r,v.rotation=d,l&&(v.actionManager=new o.ActionManager(t),v.actionManager.registerAction(new o.ExecuteCodeAction(o.ActionManager.OnPickUpTrigger,(function(){pa({type:we.Type.playerClick,payload:{boxEntity:a.toString()}})}))))})),f},ya=function(){return(ya=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},ma=function(e,t){for(var n=0,a=t.length,r=e.length;n<a;n++,r++)e[r]=t[n];return e},ga=function(e){var t=e.state,n=e.component,r=n.gridPosition,o=f({state:t,name:a.ai,entity:n.player||""});va({scene:Ca,name:r[0]+"-"+r[1],position:[r[0]*ln,r[1]*ln],uniqueId:parseFloat(n.entity),color:(null==o?void 0:o.color)||[1,1,1],ai:o,dots:n.dots,state:t,isClickable:!0});var i=Ae({state:t});return i?t=l({state:t,data:ya(ya({},i),{grid:ma(ma([],i.grid),[n.entity])})}):t},ha=function(e){var t=e.state,n=e.component,a=Ca.getTransformNodeByUniqueId(parseInt(n.entity));return null==a||a.dispose(),t};!function(e){e[e.up=0]="up",e[e.down=1]="down",e[e.left=2]="left",e[e.right=3]="right"}($n||($n={})),function(e){var t;(t=e.Type||(e.Type={})).onClick="BoxEvent-onClick",t.rotationEnd="BoxEvent-rotationEnd",t.rotate="BoxEvent-rotate"}(Jn||(Jn={}));var ba=function(){return(ba=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},xa=n(155),Ta=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function wa(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}xa.env.PUBLIC_URL="/kostki";var Oa=document.getElementById("game"),Pa="humanPlayer",Sa=new o.Engine(Oa,!0,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1}),Ca=new o.Scene(Sa);Sa.runRenderLoop((function(){Ca&&Ca.activeCamera&&Ca.render()}));var Ea=new o.UniversalCamera("UniversalCamera",new o.Vector3(0,0,-1),Ca);Ea.mode=o.Camera.ORTHOGRAPHIC_CAMERA;var ka=new o.HemisphericLight("light",new o.Vector3(0,0,1),Ca);ka.intensity=1,ka.diffuse=new BABYLON.Color3(1,1,1),ka.specular=new BABYLON.Color3(1,1,1),ka.groundColor=new BABYLON.Color3(1,1,1),"serviceWorker"in navigator&&(function(e){if("serviceWorker"in navigator){if(new URL(xa.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t=xa.env.PUBLIC_URL+"/service-worker.js";Ta?(function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):wa(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):wa(t,e)}))}}({onUpdate:function(){},onSuccess:function(){}}),navigator.serviceWorker.addEventListener("message",(function(e){return t=void 0,n=void 0,r=function(){var t,n,a,r;return function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(o){switch(o.label){case 0:return"workbox-broadcast-update"!==e.data.meta?[3,4]:(t=e.data.payload,n=t.cacheName,a=t.updatedURL,[4,caches.open(n)]);case 1:return[4,o.sent().match(a)];case 2:return[4,null==(r=o.sent())?void 0:r.text()];case 3:o.sent(),pa({type:we.Type.showNewVersion,payload:{}}),o.label=4;case 4:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(i,s)}c((r=r.apply(t,n||[])).next())}));var t,n,a,r})));var Ma,Ba=(Ma=function(e){return P({state:e,name:a.logo,create:Mn,remove:Bn})}(Ma=function(e){return P({state:e,name:a.turnIndicator,create:bn,remove:xn})}(Ma=function(e){return P({state:e,name:a.background,create:on,tick:function(e){var t=e.state,n=e.component,a=Ca.getMeshByUniqueId(parseFloat(sn));return a&&a.material&&(a.material.setFloat("iTime",performance.now()/1e3+n.gradientTime),a.material.setVector2("iResolution",new o.Vector2(window.innerWidth,window.innerHeight)),a.material.setFloats("iColors",mt.flat())),t}})}(Ma=function(e){return P({state:e,name:a.uiText,create:function(e){var t=e.state;return function(e){var t,n=e.component,a=e.state,r=new BABYLON.GUI.TextBlock(n.entity);r.text=n.text,r.color=null!==(t=n.color)&&void 0!==t?t:"#fff",r.fontSize=n.fontSize?n.fontSize[0]:24,r.textHorizontalAlignment=0,null==gt||gt.addControl(r),wt({state:a,scene:Ca})}({component:e.component,state:t}),t},update:function(e){var t=e.state,n=e.component,a=ht({entity:n.entity});return a&&(a.text=n.text),t},remove:function(e){var t=e.state;return function(e){var t=ht({entity:e.entity});t&&t.dispose()}({entity:e.component.entity}),t}})}(Ma=function(e){return P({state:e,name:a.uiButton,create:function(e){var t,n,a,r=e.state,o=e.component,i=BABYLON.GUI.Button.CreateImageWithCenterTextButton(o.entity,o.text,o.src[0]);return i.color=null!==(t=o.color)&&void 0!==t?t:"black",i.fontSize=null!==(n=o.fontSize)&&void 0!==n?n:30,i.isPointerBlocker=null===(a=o.isPointerBlocker)||void 0===a||a,null==gt||gt.addControl(i),r},update:function(e){var t=e.state,n=e.component,a=ht({entity:n.entity});return a&&a.textBlock&&(a.textBlock.text=n.text),t},remove:function(e){var t=e.state,n=e.component,a=ht({entity:n.entity});return a&&a.dispose(),t}})}(Ma=function(e){return P({state:e,name:a.ui,create:Ht})}(Ma=function(e){return P({state:e,name:a.camera,create:function(e){var t=e.state,n=e.component;return Gn({state:t,data:n})}})}(Ma=function(e){return P({state:e,name:a.marker,create:function(e){var t,n,a=e.state,r=e.component,i=o.Mesh.CreatePlane(ta,1.4,Ca,!0);return i.uniqueId=parseInt(r.entity),i.position=new o.Vector3(9999,9999,9999),i.material=new o.StandardMaterial("material",Ca),i.material.useAlphaFromDiffuseTexture=!0,qe({mesh:i,color:[1,1,1],texture:Kn,scene:Ca}),i.material.diffuseTexture.hasAlpha=!0,i.animations[0]=(t=new o.Animation("getScaleAnimation","scaling",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),(n=[]).push({frame:0,value:new o.Vector3(2,2,1)}),n.push({frame:.5,value:new o.Vector3(.9,.9,1)}),t.setKeys(n),t),i.animations[1]=function(){var e=new o.Animation("getAlphaAnimation","material.alpha",1,o.Animation.ANIMATIONTYPE_FLOAT,o.Animation.ANIMATIONLOOPMODE_RELATIVE),t=[];return t.push({frame:0,value:1}),t.push({frame:.5,value:0}),e.setKeys(t),e}(),a},update:function(e){var t=e.state,n=e.component,a=Ca.getMeshByUniqueId(parseInt(ta));return a&&(a.material.diffuseColor=new o.Color3(n.color[0],n.color[1],n.color[2]),Ca.beginAnimation(a,0,1,!1),a.position.x=n.position[0],a.position.y=n.position[1],a.position.z=-1),t}})}(Ma=function(e){return P({state:e,name:a.game,create:Ie})}(Ma=function(e){return P({state:e,name:a.ai})}(Ma=function(e){return P({state:e,name:a.box,create:ga,remove:ha})}(Ma=fa(Ma=m)))))))))))),Ma=l({state:Ma,data:{entity:Pa,name:a.ai,human:!0,level:T.hard,color:[0,0,1],textureSet:["","","","","","",""],active:!0}}),Ma=l({state:Ma,data:{version:"0.0.0",newVersionAvailable:!1,entity:Le,name:a.game,grid:[],round:0,currentPlayer:Pa,gameStarted:!1,playersQueue:[],boxRotationQueue:[],colorBlindMode:!1,customLevelSettings:{players:an().slice(0,8),difficulty:T.easy,quickStart:!0,mapType:""},musicEnabled:!1}}),Ma=l({state:Ma,data:{entity:Kt,name:a.ui,type:u.mainMenu}}),Ma=l({state:Ma,data:ba({entity:qn,name:a.camera,position:[0,0],distance:5},Vn(5,Ca))}),Ma=l({state:Ma,data:{entity:sn,name:a.background,gradientTime:5e4*Math.random()}}),Nn({state:Ma,scene:u.mainMenu}));Ca.registerBeforeRender((function(){Ba=function(e){var t=e.state;return t.system.concat().sort((function(e,t){return e>t?-1:1})).reduce((function(e,t){return t.tick({state:e,eventBuffer:{}})}),t)}({state:Ba})})),window.addEventListener("resize",(function(){pa({type:Ln.Type.resize,payload:{}}),Sa.resize()}))}},e=>{e.O(0,[216],(()=>(60,e(e.s=60)))),e.O()}]);