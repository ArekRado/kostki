"use strict";(self.webpackChunkkostki=self.webpackChunkkostki||[]).push([[179],{369:(t,e,n)=>{n.d(e,{nS:()=>In,$z:()=>Pn,Ah:()=>En});var a,r,o=n(385),i=function(){return(i=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},c=function(t,e){return e.find((function(e){return e.name===t}))};(r=a||(a={})).box="box",r.ai="ai",r.game="game",r.camera="camera",r.marker="marker",r.ui="ui",r.uiButton="uiButton",r.uiImage="uiImage",r.uiText="uiText";var u,s=function(t){var e,n,a=t.state,r=t.data,o=i(i({},a),{component:i(i({},a.component),(e={},e[r.name]=i(i({},a.component[r.name]),(n={},n[r.entity]=r,n)),e))}),u=c(r.name,a.system);if(void 0!==u){if(void 0===a.component[r.name]||void 0===a.component[r.name][r.entity])return u.create({state:o,component:r});if(u.update)return u.update({state:o,component:r})}return o},d=function(t){var e=t.state,n=t.name,a=p({state:e,name:n});return a?Object.keys(a).reduce((function(t,e){return function(t){var e,n=t.name,a=t.entity,r=t.state,o=r.component[n],u=a,s=(o[u],function(t,e){var n={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(n[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(t);r<a.length;r++)e.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(t,a[r])&&(n[a[r]]=t[a[r]])}return n}(o,["symbol"==typeof u?u:u+""])),d=i(i({},r),{component:i(i({},r.component),(e={},e[n]=s,e))}),p=l({name:n,state:r,entity:a}),f=c(n,d.system);return f&&p?f.remove({state:d,component:p}):d}({name:n,entity:e,state:t})}),e):e},l=function(t){var e=t.name,n=t.entity,a=t.state.component[e];return a?a[n]:void 0},p=function(t){var e=t.name;return t.state.component[e]},f=function(t){var e=t.entity,n=t.name,a=function(t){var a=t.state;return l({state:a,entity:e,name:n})};return{getComponent:a,setComponent:function(t){var r=t.state,o=t.data,c=a({state:r});return c?r=s({state:r,data:i(i({entity:e,name:n},c),o)}):r}}},v=function(){return(v=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},m=function(t,e){for(var n=0,a=e.length,r=t.length;n<a;n++,r++)t[r]=e[n];return t};!function(t){t[t.last=3]="last",t[t.time=3]="time",t[t.io=2]="io",t[t.transform=1]="transform",t[t.zero=0]="zero",t[t.sprite=-1]="sprite",t[t.draw=-2]="draw"}(u||(u={}));var y,g,b=function(t){return t.state},h=function(t){var e=t.state,n=t.tick,a=function(t,e){var n={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(n[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(t);r<a.length;r++)e.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(t,a[r])&&(n[a[r]]=t[a[r]])}return n}(t,["state","tick"]),r={name:a.name,priority:a.priority||u.zero,initialize:a.initialize||b,create:a.create||b,tick:function(t){var e=t.state,r=t.eventBuffer,o=e.component[a.name];return o?Object.values(o).reduce((function(t,e){var o=function(t){var e=t.entity,n=t.eventBuffer,a=t.state,r=t.eventHandler,o=t.component;return n[e]?n[e].reduce((function(t,n){if(r){var a=l({state:t,entity:e,name:o.name});return a?r({state:t,event:n,component:a}):t}return t}),a):a}({eventHandler:a.event,state:t,eventBuffer:r,entity:e.entity,component:e});return n?n({state:o,component:e}):o}),e):e},update:a.update,remove:a.remove||b,event:a.event||b};return v(v({},e),{system:m(m([],e.system),[r])})},x=function(t){var e=t.getEngine().getRenderingCanvasClientRect();return null!==e?e.height/e.width:1},T=function(t,e){var n=x(e),a=e.activeCamera;a&&(n>1?(a.orthoLeft=-t,a.orthoRight=t,a.orthoBottom=a.orthoLeft*n,a.orthoTop=a.orthoRight*n):(a.orthoBottom=-t,a.orthoTop=t,a.orthoLeft=a.orthoBottom/n,a.orthoRight=a.orthoTop/n))},w="cameraEntity",O=f({entity:w,name:a.camera}),S=(O.getComponent,O.setComponent),P=1.2,C=function(t){var e=t[0]?1.2*t[0].length:1,n=1.2*t.length;return{center:[(e-1-.2)/2,(n-1-.2)/2],cameraDistance:(e>n?e:n)/2+.2}},E=function(){return(E=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},I="first",B={},A={},k=function(t){"first"===I?(B[t.entity]||(B[t.entity]=[]),B[t.entity].push(t)):(A[t.entity]||(A[t.entity]=[]),A[t.entity].push(t))},L={entity:{},component:(y={},y[a.box]={},y[a.ai]={},y[a.game]={},y[a.camera]={},y[a.marker]={},y[a.ui]={},y[a.uiButton]={},y[a.uiImage]={},y[a.uiText]={},y),system:[]};!function(t){t[t.mainMenu=0]="mainMenu",t[t.customLevel=1]="customLevel",t[t.customLevelSettings=2]="customLevelSettings"}(g||(g={}));const M=n.p+"57365b6b32a38acad399fa24be970b62.png",z=n.p+"86711768640182ba9774e66c59e43713.png",U=n.p+"d5fd50f6577249e4bd0a6cedc07b855c.png",R=n.p+"1cece826ef3290f02e8ab121defa70e5.png",N=n.p+"04486ea103fd49156ce128e43c00f4af.png",j=n.p+"4c8888485f10730f523694c6ac7449e4.png",V=n.p+"3bb45fa09a5eb9cd805c7f32aab31591.png",q=n.p+"289b33e3a3e1c125f813747944282bbb.png",Q=n.p+"e7015b6db11decc2aa7f722b6eaaa343.png",D=n.p+"7e6aabd8e3d92edca81c0207761816f0.png",G=n.p+"1a202abfbdfbb945f566e890f0e0fa7f.png",_=n.p+"ad7c3be816ce34c76152ecc6c61d263b.png",W=n.p+"8711d0d55135c6a04bf3e76aa6287504.png",Y=n.p+"717e6eb5fb82bedfc88f6dc0c65b6f12.png",H=n.p+"16c7f9cc6c2acada16547b3befe94a91.png",F=n.p+"2d2b2519ce6d9ed0c93cd7ed21aed043.png",K=n.p+"7fa7abdc3e479f97ee5f6b283630df03.png",J=n.p+"f3941c38549dddc4a8cb586591e36996.png",$=n.p+"62bd7e3778d77e5ca308fcb5f4b0da78.png",X=n.p+"2f30a46bdc58014e8ba857f895bbe5b8.png",Z=n.p+"de0b87223c2e5708366657b7da01c941.png",tt=n.p+"54b2699e76fca159c5797b2b93b10bd4.png",et=n.p+"3d713800c02422e02fe02e70f53e9771.png",nt=n.p+"2f9682e3f7d362cc3087ef4dcbbdfd2b.png",at=n.p+"62f6adca2ae3c6e088aac66bc47cb54e.png",rt=n.p+"9bb2d886948bbd78603ec224904774fd.png",ot=n.p+"2d9f8ec02b7087dc45bf61208aacf7a8.png",it=n.p+"4fd5888696b352601fd6c1f7a1420e1f.png",ct=n.p+"d62f41f971620bf90529571efed25c8e.png",ut=n.p+"2c7434786497b8ccb02757089a53015a.png",st=n.p+"51f16b6b18086fcc295f8bc02e6c8c45.png",dt=n.p+"0dfd6a6b5e5120be13c81ddc1d84a1df.png",lt=n.p+"301a367840edef78b86808852d0c067e.png",pt=n.p+"d854a7c9f810ebe5be07e17990bd0ee4.png",ft=n.p+"777079c111d24a4a0402f5afbc95b175.png",vt=n.p+"e1b39772fd20282e80743b1f04be6795.png",mt=n.p+"24075b75ce25b7869e6559cccca76b75.png",yt=n.p+"698b6e6ce4fcc13dd8ac2cdb9bb484fe.png",gt=n.p+"38ca2b18556222743ee8778742514d73.png",bt=n.p+"aebe569c1bf5190e0038b7098791359c.png",ht=n.p+"d1390ce752b5ee52126d21de796a81f8.png",xt=n.p+"d54421100963619575d7b3f35876fdfe.png",Tt=n.p+"cde379b0a92320968a3826f29eff20fc.png",wt=n.p+"d1b88dc4aa017270afbb48ce8c2d93ee.png",Ot=n.p+"f07f0db4072406727dc668f8f643b725.png",St=n.p+"f60fcf550b1112ec6a6bb8c80cc4b142.png",Pt=n.p+"5fded717b6adc588c2dcdedd900f3bea.png",Ct=n.p+"ed032e786ebb26ea79c773fd85684876.png",Et=n.p+"7960efbc05f46d226a4e232b391a79ea.png";var It,Bt,At=[M,z,U,R,N,j,V],kt=[M,q,Q,D,G,_,W],Lt=[M,Y,H,F,K,J,$],Mt=[M,X,Z,tt,et,nt,at],zt=[M,rt,ot,it,ct,ut,st],Ut=[M,dt,lt,pt,ft,vt,mt],Rt=[M,yt,gt,bt,ht,xt,Tt],Nt=[M,wt,Ot,St,Pt,Ct,Et],jt={},Vt=function(t){var e=t.textureUrl,n=t.scene,a=new o.Texture(e,n,void 0,void 0,o.Texture.NEAREST_NEAREST_MIPLINEAR);return jt[e]=a,a},qt=function(t){var e=t.mesh,n=t.texture,a=t.scene,r=t.color;e.material.diffuseColor=new o.Color3(r[0],r[1],r[2]);var i=function(t){var e=t.textureUrl,n=t.scene;return jt[e]?jt[e]:Vt({textureUrl:e,scene:n})}({textureUrl:n,scene:a});return e.material.diffuseTexture=i,i},Qt=function(){return(Qt=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Dt=function(t,e){for(var n=0,a=e.length,r=t.length;n<a;n++,r++)t[r]=e[n];return t};!function(t){t[t.up=0]="up",t[t.down=1]="down",t[t.left=2]="left",t[t.right=3]="right"}(It||(It={})),function(t){var e;(e=t.Type||(t.Type={}))[e.onClick=0]="onClick",e[e.rotationEnd=1]="rotationEnd",e[e.rotate=2]="rotate"}(Bt||(Bt={}));var Gt=function(t){return t>2*Math.PI||t<-2*Math.PI?-2*Math.PI:t},_t=function(t){var e=t.state,n=t.ai,a=_e({state:e});return n&&(null==a?void 0:a.colorBlindMode)?n.textureSet:At},Wt=function(t){var e=t.entity,n=t.state,a=_e({state:n});return a?s({state:n,data:Qt(Qt({},a),{boxRotationQueue:Dt(Dt([],a.boxRotationQueue),[e])})}):n},Yt=function(t){var e=t.entity,n=t.animationEndCallback,a=(t.direction,t.color),r=t.texture,i=En.getTransformNodeByUniqueId(parseInt(e));if(i){var c=o.Tools.ToRadians(90)*(Math.random()>.5?1:-1),u=Math.random()>.5?"x":"y",s=i.rotation,d=new o.Vector3("x"===u?c:0,"y"===u?c:0,0).add(s),l=new o.Vector3(Gt(d.x),Gt(d.y),Gt(d.z)),p=new o.Animation("rotateAnimation","rotation",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),f=new o.AnimationEvent(.5,n,!0);p.addEvent(f);var v=[];v.push({frame:0,value:s}),v.push({frame:.5,value:l}),p.setKeys(v),i.animations[i.animations.length]=p,En.beginAnimation(i,0,1,!1);var m=i.getChildren();m.slice(1,m.length).forEach((function(t){var e=En.getMeshByUniqueId(t.uniqueId);e&&qt({mesh:e,color:a,texture:r,scene:En})}))}},Ht=function(t){return 6===t?1:t+1},Ft=function(t){var e=t.state,n=t.ai,a=t.box,r=a.entity,o=a.dots;return n&&(o=Ht(a.dots),Yt({entity:r,animationEndCallback:function(){k({type:Bt.Type.rotationEnd,entity:r,payload:{ai:n,shouldExplode:6===a.dots}})},texture:_t({state:e,ai:n})[o],color:n.color}),e=Wt({entity:r,state:e})),s({state:e,data:Qt(Qt({},a),{isAnimating:!0,player:(null==n?void 0:n.entity)||"",dots:o})})},Kt=function(t){var e=t.boxEntity,n=t.texture,a=t.color,r=En.getTransformNodeByUniqueId(parseInt(e));r&&(r.rotation.x=0,r.rotation.y=0,r.getChildren().forEach((function(t){var e=En.getMeshByUniqueId(t.uniqueId);e&&qt({mesh:e,color:a,texture:n,scene:En})})))},Jt=function(t){return h({state:t,name:a.box,create:function(t){var e=t.state,n=t.component,r=n.gridPosition,i=l({state:e,name:a.ai,entity:n.player||""});!function(t){var e=t.scene,n=t.name,a=t.uniqueId,r=t.position,i=t.color,c=t.state,u=t.ai,s=t.box,d=new o.TransformNode("box "+n,e);d.uniqueId=a,d.position.x=r[0],d.position.y=r[1],[[new o.Vector3(0,0,-.5),new o.Vector3(0,0,0)],[new o.Vector3(-.5,0,0),new o.Vector3(0,Math.PI/2,0)],[new o.Vector3(0,0,.5),new o.Vector3(0,Math.PI,0)],[new o.Vector3(.5,0,0),new o.Vector3(0,-Math.PI/2,0)],[new o.Vector3(0,.5,0),new o.Vector3(Math.PI/2,0,0)],[new o.Vector3(0,-.5,0),new o.Vector3(-Math.PI/2,0,0)]].forEach((function(t,n){var r=t[0],l=t[1],p=0===n;setTimeout((function(){var t=o.Mesh.CreatePlane("plane"+n,1,e,!1);t.parent=d,t.material=new o.StandardMaterial("mat",e),p&&qt({mesh:t,color:i,texture:_t({state:c,ai:u})[s.dots],scene:e}),t.material.alpha=1,t.position=r,t.rotation=l,t.setParent(d),t.actionManager=new o.ActionManager(e),t.actionManager.registerAction(new o.ExecuteCodeAction(o.ActionManager.OnPickUpTrigger,(function(){k({entity:Qe,type:ce.Type.playerClick,payload:{boxEntity:a.toString()}})})))}),p?0:400*Math.random()+100)}))}({scene:En,name:r[0]+"-"+r[1],position:[r[0]*P,r[1]*P],uniqueId:parseFloat(n.entity),texture:(null==i?void 0:i.textureSet[n.dots])||M,color:(null==i?void 0:i.color)||[1,1,1],ai:i,box:n,state:e});var c=_e({state:e});return c?e=s({state:e,data:Qt(Qt({},c),{grid:Dt(Dt([],c.grid),[n.entity])})}):e},remove:function(t){var e=t.state,n=t.component,a=En.getTransformNodeByUniqueId(parseInt(n.entity));return null==a||a.dispose(),e},event:function(t){var e=t.state,n=t.component,a=t.event;switch(a.type){case Bt.Type.rotationEnd:return function(t){var e=t.state,n=t.component,a=t.event.payload,r=a.ai,o=a.shouldExplode;e=function(t){var e=t.entity,n=t.state,a=_e({state:n});return a?s({state:n,data:Qt(Qt({},a),{boxRotationQueue:a.boxRotationQueue.filter((function(t){return t!==e}))})}):n}({entity:n.entity,state:e}),Kt({boxEntity:n.entity,texture:_t({state:e,ai:r})[n.dots],color:r.color});var i=_e({state:e});if(!i)return e;o?e=function(t){var e=t.state,n=t.ai,a=t.box.gridPosition,r=a[0],o=a[1],i=vn({state:e});return[$e(i,o,r-1),$e(i,o,r+1),$e(i,o-1,r),$e(i,o+1,r)].filter((function(t){return void 0!==t})).reduce((function(t,e,a){return t=Ft({ai:n,box:e,state:t}),Wt({entity:e.entity,state:t})}),e)}({state:e,box:n,ai:r}):0===i.boxRotationQueue.length&&k({type:ce.Type.nextTurn,entity:Qe,payload:{ai:r}});var c=En.getTransformNodeByUniqueId(parseInt(n.entity));return c&&(c.animations=[]),s({state:e,data:Qt(Qt({},n),{isAnimating:!1})})}({state:e,component:n,event:a});case Bt.Type.rotate:return function(t){var e=t.state,n=t.component,a=t.event;return Yt({entity:n.entity,animationEndCallback:function(){Kt({boxEntity:n.entity,texture:a.payload.texture,color:a.payload.color})},texture:a.payload.texture,color:a.payload.color}),e}({state:e,component:n,event:a})}}})},$t="localDbKey",Xt=function(){localStorage.removeItem($t)};const Zt=n.p+"de1ab0613214552916d369d2014d1d95.png";var te="38127445920450264",ee=f({entity:te,name:a.marker}),ne=(ee.getComponent,ee.setComponent),ae=(n(290),function(){return Math.floor(1e17*Math.random())}),re=function(t){var e,n=t.entity,a=t.advancedTexture,r=t.onPointerUpObservable,o=null===(e=a.getChildren().find((function(t){return t.name===Oe})))||void 0===e?void 0:e.getChildByName(n);o&&o.onPointerUpObservable.add(r)},oe=ae().toString();const ie=n.p+"8b1469fe19d1d6c3811ef4ef5c6df926.png";var ce,ue=ae().toString(),se=ae().toString(),de=ae().toString(),le=ae().toString(),pe=ae().toString(),fe=ae().toString(),ve=ae().toString(),me=ae().toString(),ye=ae().toString(),ge=ae().toString(),be=ae().toString(),he=ae().toString(),xe=ae().toString(),Te=ae().toString(),we="23505760496063488",Oe="root",Se=f({entity:we,name:a.ui}),Pe=(Se.getComponent,Se.setComponent),Ce=function(t){var e,n=t.state;return null===(e=t.advancedTexture.getChildren().find((function(t){return t.name===Oe})))||void 0===e||e.clearControls(),n=d({state:n,name:a.uiImage}),n=d({state:n,name:a.uiButton}),d({state:n,name:a.uiText})},Ee=function(t){var e=t.state,n=t.ui,r=t.advancedTexture,o=t.attachEvents;switch(n.type){case g.customLevel:e=function(t){return s({state:t.state,data:{entity:oe,name:a.uiButton,text:"X",size:[[.1,.1],[.1,.1],[.1,.1]],position:[[.95,.05],[.95,.05],[.95,.05]]}})}({state:e}),o&&function(t){re({advancedTexture:t.advancedTexture,entity:oe,onPointerUpObservable:function(){Xt(),k({type:ce.Type.cleanScene,entity:Qe,payload:{newScene:g.mainMenu}})}})}({advancedTexture:r});break;case g.mainMenu:e=function(t){var e=t.state;e=s({state:e,data:{entity:ue,name:a.uiImage,url:ie,size:[[.5,.3],[.5,.3],[.5,.3]],position:[[.5,.15],[.5,.15],[.5,.15]]}});var n=[[.6,.1],[.4,.1],[.2,.1]];e=s({state:e,data:{entity:se,name:a.uiButton,text:"Start",size:n,position:[[.5,.4],[.5,.4],[.5,.4]]}}),e=s({state:e,data:{entity:de,name:a.uiButton,text:"Select level",size:n,position:[[.5,.6],[.5,.6],[.5,.6]]}}),e=s({state:e,data:{entity:le,name:a.uiButton,text:"Mute",size:n,position:[[.5,.8],[.5,.8],[.5,.8]]}});var r=_e({state:e});return e=s({state:e,data:{entity:pe,name:a.uiText,text:"version "+(null==r?void 0:r.version),size:n,color:"#444",fontSize:24,position:[[.5,.9],[.5,.9],[.5,.9]]}}),s({state:e,data:{entity:fe,name:a.uiText,text:"created by Arek Rado",size:n,color:"#444",fontSize:24,position:[[.5,.95],[.5,.95],[.5,.95]]}})}({state:e}),o&&function(t){var e=t.advancedTexture;re({advancedTexture:e,entity:se,onPointerUpObservable:function(){k({type:ce.Type.cleanScene,entity:Qe,payload:{newScene:g.customLevelSettings}})}}),re({advancedTexture:e,entity:de,onPointerUpObservable:function(){k({type:ce.Type.cleanScene,entity:Qe,payload:{newScene:g.customLevelSettings}})}}),re({advancedTexture:e,entity:le,onPointerUpObservable:function(){k({type:ce.Type.cleanScene,entity:Qe,payload:{newScene:g.customLevelSettings}})}})}({advancedTexture:r});break;case g.customLevelSettings:e=function(t){var e=t.state,n=[[.5,.1],[.4,.1],[.3,.1]];return e=s({state:e,data:{entity:be,name:a.uiText,text:"Map",size:[[.9,.1],[.4,.1],[.3,.1]],position:[[.5,.05],[.5,.05],[.5,.05]]}}),e=s({state:e,data:{entity:xe,name:a.uiButton,text:"<",size:[[.1,.5],[.2,.5],[.2,.5]],position:[[.1,.25],[.4,.25],[.4,.25]]}}),e=s({state:e,data:{entity:he,name:a.uiButton,text:">",size:[[.1,.5],[.2,.5],[.2,.5]],position:[[.9,.25],[.8,.25],[.8,.25]]}}),e=s({state:e,data:{entity:Te,name:a.uiButton,text:"Start >",size:n,position:[[.5,.6],[.5,.6],[.5,.6]]}}),e=s({state:e,data:{entity:me,name:a.uiButton,text:"Difficulty: Hard",size:n,position:[[.25,.75],[.25,.75],[.25,.75]]}}),e=s({state:e,data:{entity:me,name:a.uiButton,text:"Difficulty: Hard",size:n,position:[[.25,.75],[.25,.75],[.25,.75]]}}),e=s({state:e,data:{entity:ve,name:a.uiButton,text:"Players: 6",size:n,position:[[.25,.85],[.25,.85],[.25,.85]]}}),e=s({state:e,data:{entity:ye,name:a.uiButton,text:"[x] Quick Start",size:n,position:[[.75,.75],[.75,.75],[.75,.75]]}}),s({state:e,data:{entity:ge,name:a.uiButton,text:"[x] Color blind mode",size:n,position:[[.75,.85],[.75,.85],[.75,.85]]}})}({state:e}),o&&function(t){var e=t.advancedTexture;re({advancedTexture:e,entity:ve,onPointerUpObservable:function(){k({type:ce.Type.startCustomLevel,entity:Qe,payload:{}})}}),re({advancedTexture:e,entity:me,onPointerUpObservable:function(){k({type:ce.Type.startCustomLevel,entity:Qe,payload:{}})}}),re({advancedTexture:e,entity:ye,onPointerUpObservable:function(){k({type:ce.Type.startCustomLevel,entity:Qe,payload:{}})}}),re({advancedTexture:e,entity:ge,onPointerUpObservable:function(){k({type:ce.Type.startCustomLevel,entity:Qe,payload:{}})}}),re({advancedTexture:e,entity:be,onPointerUpObservable:function(){k({type:ce.Type.startCustomLevel,entity:Qe,payload:{}})}}),re({advancedTexture:e,entity:Te,onPointerUpObservable:function(){k({type:ce.Type.startCustomLevel,entity:Qe,payload:{}})}})}({advancedTexture:r})}return e},Ie=null,Be=function(){return(Be=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Ae=[.6,.6,.6],ke=[.11,.79,.29],Le=[.09,.84,1],Me=[1,.73,.29],ze=[.99,.97,.32],Ue=[.99,.42,.45],Re=[.99,.47,.94],Ne=[.67,.23,.94],je=function(){return(je=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Ve=function(t){var e=t.state;e=function(t){var e=t.state,n=(t.scene,t.camera,function(t,e,n,r){return void 0===r&&(r=!1),{entity:t,name:a.ai,human:r,level:1,color:e,textureSet:n,active:!0}});e=function(t){var e=t.state,n=t.ai;e=d({state:e,name:a.ai});var r=_e({state:e});return r&&(e=s({state:e,data:Be(Be({},r),{playersQueue:n.map((function(t){return t.entity}))})})),n.reduce((function(t,e){return s({state:t,data:e})}),e)}({state:e=Array.from({length:8}).reduce((function(t,e,n){return Array.from({length:8}).reduce((function(t,e,r){return s({state:t,data:{name:a.box,entity:ae().toString(),isAnimating:!1,dots:0,gridPosition:[r,n],player:void 0}})}),t)}),e),ai:[n(Pn,Le,At,!0),n("2",Ue,kt),n("3",ke,Lt),n("4",ze,Mt),n("5",Me,zt),n("6",Re,Ut),n("7",Ae,Rt),n("8",Ne,Nt)]});var r=C(vn({state:e})),o=r.center,i=r.cameraDistance;return e=S({state:e,data:{position:[o[0],o[1]],distance:i}}),Pe({state:e,data:{type:g.customLevel}})}({state:e,scene:En,camera:In});var n=_e({state:e}),r=He({state:e});if(!r||!n)return e;if(e=We({state:e,data:{gameStarted:!0,currentPlayer:r.entity}}),n.quickStart&&(e=function(t){var e,n=t.state,r=(null===(e=_e({state:n}))||void 0===e?void 0:e.grid.length)||1;return Array.from({length:2*r}).reduce((function(t){var e=_e({state:t}),n=l({state:t,name:a.ai,entity:(null==e?void 0:e.currentPlayer)||""});if(!e||!n)return t;var r=yn({state:t,ai:n,preferEmptyBoxes:!0});if(!r)return t;t=s({state:t,data:je(je({},r),{player:n.entity,dots:Ht(r.dots)})});var o=He({state:t});return o?t=s({state:t,data:je(je({},e),{currentPlayer:o.entity})}):t}),n)||n}({state:e}),setTimeout((function(){!function(t){var e=t.state,n=_e({state:e});n&&n.grid.forEach((function(t){var n=l({state:e,entity:t,name:a.box}),r=l({state:e,entity:(null==n?void 0:n.player)||"",name:a.ai});n&&r&&k({type:Bt.Type.rotate,entity:t,payload:{color:r.color,texture:_t({state:e,ai:r})[n.dots],direction:It.up}})}))}({state:e})}),500)),e=We({state:e,data:{gameStarted:!0,currentPlayer:r.entity}}),!r.human){var o=yn({state:e,ai:r});o&&(e=Ft({box:o,state:e,ai:r}))}return e},qe=function(){return(qe=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Qe="game";!function(t){var e;(e=t.Type||(t.Type={}))[e.startCustomLevel=0]="startCustomLevel",e[e.nextTurn=1]="nextTurn",e[e.boxExplosion=2]="boxExplosion",e[e.playerClick=3]="playerClick",e[e.cleanScene=4]="cleanScene"}(ce||(ce={}));var De,Ge=f({entity:Qe,name:a.game}),_e=Ge.getComponent,We=Ge.setComponent,Ye=function(t){var e=t.playersQueue,n=t.index,r=t.state,o=l({state:r,name:a.ai,entity:e[n]});return(null==o?void 0:o.active)?o:Ye({playersQueue:e,index:n>=e.length?0:n+1,state:r})},He=function(t){var e=t.state,n=_e({state:e});if(n){var a=n.playersQueue.findIndex((function(t){return n.currentPlayer===t}));return Ye({playersQueue:n.playersQueue,index:a+1,state:e})}},Fe=function(t){return h({state:t,name:a.game,event:function(t){var e=t.state,n=t.component,r=t.event;switch(r.type){case ce.Type.startCustomLevel:return Ve({state:e,component:n,event:r});case ce.Type.nextTurn:return function(t){var e=t.state,n=t.component,r=n.gameStarted,o=n.boxRotationQueue;if(r&&0===o.length){var i=He({state:e});if(!i)return e;var c=l({name:a.ai,state:e,entity:i.entity});if(!c)return e;if(e=s({state:e,data:qe(qe({},n),{currentPlayer:c.entity})}),!c.human&&c.active){var u=yn({state:e,ai:c});if(!u)return function(t){var e=t.state,n=t.ai,r=t.component;e=s({state:e,data:qe(qe({},n),{active:!1})});var o=p({state:e,name:a.ai});return 1===Object.values(o||{}).reduce((function(t,e){return e.active?t+1:t}),0)?(Xt(),s({state:e,data:qe(qe({},r),{gameStarted:!1})})):(k({type:ce.Type.nextTurn,entity:Qe,payload:{ai:n}}),e)}({state:e,component:n,ai:c});e=ne({state:e,data:{color:c.color,position:[u.gridPosition[0]*P,u.gridPosition[1]*P]}}),e=Ft({box:u,state:e,ai:c}),e=Wt({state:e,entity:u.entity})}}return function(t){localStorage.setItem($t,JSON.stringify(t))}(e),e}({state:e,component:n,event:r});case ce.Type.playerClick:return function(t){var e=t.state,n=t.component,r=t.event,o=n.currentPlayer,i=n.gameStarted,c=n.boxRotationQueue,u=l({state:e,name:a.box,entity:r.payload.boxEntity}),s=void 0===(null==u?void 0:u.player)||(null==u?void 0:u.player)===o;if(i&&0===c.length&&s){var d=l({name:a.ai,state:e,entity:o});u&&(null==d?void 0:d.human)&&(e=ne({state:e,data:{color:d.color,position:[u.gridPosition[0]*P,u.gridPosition[1]*P]}}),e=Ft({box:u,state:e,ai:d}))}return e}({state:e,component:n,event:r});case ce.Type.cleanScene:return function(t){var e=t.state;return e=Pe({state:e,data:{type:t.event.payload.newScene}}),e=We({state:e,data:{round:0,grid:[],currentPlayer:"",playersQueue:[],boxRotationQueue:[],gameStarted:!1}}),e=d({state:e,name:a.box}),d({state:e,name:a.ai})}({state:e,component:n,event:r})}}})},Ke=function(){return(Ke=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};!function(t){t.Type||(t.Type={})}(De||(De={}));var Je,$e=function(t,e,n){return t&&t[n]?t[n][e]:void 0},Xe=0,Ze=10,tn=-10,en=-5,nn=-4,an=-15,rn=50,on=0,cn=1,un=2,sn=7,dn=-5,ln=-4,pn=0,fn=0;!function(t){t[t.less=-1]="less",t[t.equal=0]="equal",t[t.more=1]="more"}(Je||(Je={}));var vn=function(t){var e=t.state,n=_e({state:e});return n?n.grid.reduce((function(t,n){var r=l({name:a.box,state:e,entity:n});if(r){var o=r.gridPosition[0],i=r.gridPosition[1];t[o]||(t[o]=[]),t[o][i]=Ke(Ke({},r),{points:0})}return t}),[]):[]},mn=function(t){var e=t.dataGrid,n=t.currentPlayer,a=t.preferEmptyBoxes;return e.reduce((function(t,r,o){return t[o]=r.reduce((function(t,r,i){if(r.player!==n.entity&&void 0!==r.player)return t;var c=[[$e(e,i-1,o-1),$e(e,i,o-1),$e(e,i+1,o-1)],[$e(e,i-1,o),$e(e,i,o),$e(e,i+1,o)],[$e(e,i-1,o+1),$e(e,i,o+1),$e(e,i+1,o+1)]],u=function(t){var e=t.grid3x3,n=t.preferEmptyBoxes,a=t.currentPlayer,r=e[1][1];return function(t){return[t[1][0],t[0][1],t[1][2],t[2][1]]}(e).reduce((function(t,e){if(!e)return t+on;var o=r.dots===e.dots?Je.equal:r.dots>e.dots?Je.more:Je.less;if(e.player!==r.player&&void 0!==e.player){if(n&&void 0===r.player&&e.player===a.entity)return Math.random()>.5?t+15:t;if(o===Je.more){var i=r.dots-e.dots;return t+Xe-i}if(o===Je.equal)return t+Ze*r.dots;if(o===Je.less)return i=e.dots-r.dots,t+tn*i}else{if(6===r.dots)return t;if(o===Je.more)return t+en;if(o===Je.equal)return 6===e.dots&&6===r.dots?t+rn:t+nn;if(o===Je.less)return 6===e.dots?t+2*an:t+an}return t}),0)}({grid3x3:c,preferEmptyBoxes:a,currentPlayer:n})+function(t){var e=t.grid3x3,n=e[1][1];return function(t){return[t[0][0],t[0][2],t[2][0],t[2][2]]}(e).reduce((function(t,e){if(!e)return t+fn;var a=n.dots===e.dots?Je.equal:n.dots>e.dots?Je.more:Je.less;if(e.player!==n.player&&void 0!==e.player){if(a===Je.more)return t+cn;if(a===Je.equal)return 6===e.dots?t+-10*un:t+un;if(a===Je.less)return 6===e.dots?t+2*sn:t+sn}else{if(6===n.dots)return t;if(a===Je.more)return t+dn;if(a===Je.equal)return t+ln;if(a===Je.less){var r=e.dots-n.dots;return t+pn+Math.pow(r,2)}}return t}),0)}({grid3x3:c,preferEmptyBoxes:a,currentPlayer:n});return t[i]=Ke(Ke({},r),{points:r.points+u}),t}),r),t}),e)},yn=function(t){var e=t.state,n=t.ai,a=t.preferEmptyBoxes,r=n.entity,o=vn({state:e});return o=function(t){var e=t.dataGrid;return e.reduce((function(t,e,n){return t[n]=e.reduce((function(t,e,n){var a=void 0===e.player?e.points+50:e.points;return t[n]=Ke(Ke({},e),{points:a}),t}),e),t}),e)}({dataGrid:o}),function(t){var e=t.currentPlayer,n=-1/0,a=[];t.dataGrid.forEach((function(t){t.forEach((function(t){var r=void 0===t.player,o=t.player===e;(r||o)&&(t.points>n&&(a=[]),t.points>=n&&(n=t.points,a.push(t)))}))}));var r=Math.floor(Math.random()*a.length);return a[r]}({currentPlayer:r,dataGrid:o=mn({currentPlayer:n,dataGrid:o,preferEmptyBoxes:!!a})})},gn=[768,1200,1400],bn=function(t){var e=t.element,n=t.callback,a=t.scene,r=t.sizes,o=a.getEngine(),i=function(){var t=o.getRenderingCanvasClientRect(),e=function(t,e){return e.find((function(e,n){return t<gn[n]}))||e[e.length-1]}(t?t.width:1,r);n(e)};return i(),o.onResizeObservable.add(i),e.onDisposeObservable.add((function(){return o.onResizeObservable.removeCallback(i)})),e},hn=function(t){return[100*(t[0]-.5)+"%",100*(t[1]-.5)+"%"]},xn=function(){return(xn=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Tn=n(155),wn=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function On(t,e){navigator.serviceWorker.register(t).then((t=>{t.onupdatefound=()=>{var n=t.installing;null!=n&&(n.onstatechange=()=>{"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}})).catch((t=>{console.error("Error during service worker registration:",t)}))}Tn.env.PUBLIC_URL="";var Sn=document.getElementById("game"),Pn="humanPlayer",Cn=new o.Engine(Sn,!0,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1}),En=new o.Scene(Cn);Cn.runRenderLoop((function(){En&&En.activeCamera&&En.render()}));var In=new o.UniversalCamera("UniversalCamera",new o.Vector3(0,0,-1),En);In.mode=o.Camera.ORTHOGRAPHIC_CAMERA;var Bn=new o.HemisphericLight("light",new o.Vector3(0,0,1),En);Bn.intensity=1,Bn.diffuse=new BABYLON.Color3(1,1,1),Bn.specular=new BABYLON.Color3(1,1,1),Bn.groundColor=new BABYLON.Color3(1,1,1),"serviceWorker"in navigator&&function(t){if("serviceWorker"in navigator){if(new URL(Tn.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{var e="".concat(Tn.env.PUBLIC_URL,"/service-worker.js");wn?(function(t,e){fetch(t,{headers:{"Service-Worker":"script"}}).then((e=>{var n=e.headers.get("content-type");404===e.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((t=>{t.unregister().then((()=>{window.location.reload()}))})):On(t,undefined)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):On(e,t)}))}}();var An=function(){var t,e=L,n="0.0.0";e=function(t){return h({state:t,name:a.ai,create:function(t){var e=t.component,n=t.state;return setTimeout((function(){e.textureSet.forEach((function(t){var e=new Image;e.src=t,e.onload=function(){Vt({textureUrl:t,scene:En})}}))}),2e3*Math.random()+1e3),n}})}(e=Jt(e)),e=function(t){return h({state:t,name:a.uiText,create:function(t){var e,n,a=t.state,r=t.component,o=new BABYLON.GUI.TextBlock(r.entity);o.text=r.text,o.color=null!==(e=r.color)&&void 0!==e?e:"#fff",o.fontSize=null!==(n=r.fontSize)&&void 0!==n?n:24,bn({element:o,scene:En,sizes:r.size,callback:function(t){o.width=t[0];var e=x(En);o.height=t[1]/e}});var i=hn(r.position[0]),c=i[0],u=i[1];return o.top=u,o.left=c,null==Ie||Ie.addControl(o),a},remove:function(t){var e=t.state,n=t.component,a=null==Ie?void 0:Ie.getChildren().find((function(t){return t.name===n.entity}));return a&&a.dispose(),e}})}(e=function(t){return h({state:t,name:a.uiImage,create:function(t){var e=t.state,n=t.component,a=new BABYLON.GUI.Image(n.entity,n.url);bn({element:a,scene:En,sizes:n.size,callback:function(t){a.width=t[0];var e=x(En);a.height=t[1]/e}});var r=hn(n.position[0]),o=r[0],i=r[1];return a.top=i,a.left=o,null==Ie||Ie.addControl(a),e},remove:function(t){var e=t.state,n=t.component,a=null==Ie?void 0:Ie.getChildren().find((function(t){return t.name===n.entity}));return a&&a.dispose(),e}})}(e=function(t){return h({state:t,name:a.uiButton,create:function(t){var e,n,a,r,o,i=t.state,c=t.component,u=BABYLON.GUI.Button.CreateSimpleButton(c.entity,c.text);bn({element:u,scene:En,sizes:c.size,callback:function(t){u.width=t[0],u.height=t[1]}}),u.color=null!==(e=c.color)&&void 0!==e?e:"white",u.cornerRadius=null!==(n=c.cornerRadius)&&void 0!==n?n:0,u.background=null!==(a=c.background)&&void 0!==a?a:"transparent",u.fontSize=null!==(r=c.fontSize)&&void 0!==r?r:30,u.isPointerBlocker=null===(o=c.isPointerBlocker)||void 0===o||o;var s=hn(c.position[0]),d=s[0],l=s[1];return u.top=l,u.left=d,null==Ie||Ie.addControl(u),i},remove:function(t){var e=t.state,n=t.component,a=null==Ie?void 0:Ie.getChildren().find((function(t){return t.name===n.entity}));return a&&a.dispose(),e}})}(e=function(t){return h({state:t,name:a.ui,create:function(t){var e=t.state,n=t.component;return Ie=BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI("ui",!1,En),e=Ce({advancedTexture:Ie,state:e}),Ee({state:e,ui:n,advancedTexture:Ie,attachEvents:!0})},update:function(t){var e=t.state,n=t.component;return Ie&&(e=Ce({advancedTexture:Ie,state:e}),e=Ee({state:e,ui:n,advancedTexture:Ie,attachEvents:!0})),e},tick:function(t){var e=t.state,n=t.component;return Ie&&(e=Ee({state:e,ui:n,advancedTexture:Ie,attachEvents:!1})),e}})}(e=function(t){return h({state:t,name:a.camera,create:function(t){var e=t.state,n=t.component;return In.position.x=n.position[1],In.position.y=n.position[0],In.position.z=-10,In.setTarget(new o.Vector3(n.position[1],n.position[0])),T(n.distance,En),e},update:function(t){var e=t.state,n=t.component;return In.position.x=n.position[1],In.position.y=n.position[0],In.position.z=-10,In.setTarget(new o.Vector3(n.position[1],n.position[0])),T(n.distance,En),e}})}(e=function(t){return h({state:t,name:a.marker,create:function(t){var e,n,a=t.state,r=t.component,i=o.Mesh.CreatePlane(te,1.4,En,!0);return i.uniqueId=parseInt(r.entity),i.position=new o.Vector3(9999,9999,9999),i.material=new o.StandardMaterial("material",En),i.material.useAlphaFromDiffuseTexture=!0,qt({mesh:i,color:[1,1,1],texture:Zt,scene:En}),i.material.diffuseTexture.hasAlpha=!0,i.animations[0]=(e=new o.Animation("getScaleAnimation","scaling",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),(n=[]).push({frame:0,value:new o.Vector3(2,2,1)}),n.push({frame:.5,value:new o.Vector3(.9,.9,1)}),e.setKeys(n),e),i.animations[1]=function(){var t=new o.Animation("getAlphaAnimation","material.alpha",1,o.Animation.ANIMATIONTYPE_FLOAT,o.Animation.ANIMATIONLOOPMODE_RELATIVE),e=[];return e.push({frame:0,value:1}),e.push({frame:.5,value:0}),t.setKeys(e),t}(),a},update:function(t){var e=t.state,n=t.component,a=En.getMeshByUniqueId(parseInt(te));return a&&(a.material.diffuseColor=new o.Color3(n.color[0],n.color[1],n.color[2]),En.beginAnimation(a,0,1,!1),a.position.x=n.position[0],a.position.y=n.position[1],a.position.z=-1),e}})}(e=Fe(e))))))),e=s({state:e,data:{entity:Pn,name:a.ai,human:!0,level:0,color:[0,0,1],textureSet:["","","","","","",""],active:!0}}),e=s({state:e,data:{version:n,entity:Qe,name:a.game,grid:[],round:0,currentPlayer:Pn,gameStarted:!1,playersQueue:[],boxRotationQueue:[],quickStart:!0,colorBlindMode:!1,customLevelSettings:{ai:[],levelSize:0},musicEnabled:!1}}),e=s({state:e,data:{entity:we,name:a.ui,type:g.mainMenu}}),e=s({state:e,data:{entity:w,name:a.camera,position:[0,0],distance:0}}),e=s({state:e,data:{entity:te,name:a.marker,color:[1,1,1],position:[0,0]}});var r=JSON.parse(localStorage.getItem($t)||"null"),i=null===(t=_e({state:r||L}))||void 0===t?void 0:t.version;return r&&i===n&&(e=xn(xn({},e),{entity:r.entity,component:r.component})),Xt(),e}();En.registerBeforeRender((function(){An=function(t){var e=t.state;I="second",A={};var n=e.system.concat().sort((function(t,e){return t>e?-1:1})).reduce((function(t,e){return e.tick({state:t,eventBuffer:B})}),e);return B={},I="first",B=E({},A),n}({state:An})})),window.addEventListener("resize",(function(){T(C(vn({state:An})).cameraDistance,En),Cn.resize()}))}},t=>{t.O(0,[216],(()=>(369,t(t.s=369)))),t.O()}]);