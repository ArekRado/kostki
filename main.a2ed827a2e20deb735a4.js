"use strict";(self.webpackChunkkostki=self.webpackChunkkostki||[]).push([[179],{433:(e,t,n)=>{n.d(t,{nS:()=>Yn,$z:()=>Dn,Ah:()=>Wn});var a,r,o=n(385),i=function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},c="first",s={},u={},l=function(e){"first"===c?(s[e.entity]||(s[e.entity]=[]),s[e.entity].push(e)):(u[e.entity]||(u[e.entity]=[]),u[e.entity].push(e))},d=function(){return(d=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},p=function(e,t){return t.find((function(t){return t.name===e}))};(r=a||(a={})).box="box",r.ai="ai",r.game="game",r.camera="camera",r.marker="marker",r.ui="ui",r.uiButton="uiButton",r.uiImage="uiImage",r.uiText="uiText",r.background="background",r.turnIndicator="turnIndicator";var f,y,v=function(e){var t,n,a=e.state,r=e.data,o=d(d({},a),{component:d(d({},a.component),(t={},t[r.name]=d(d({},a.component[r.name]),(n={},n[r.entity]=r,n)),t))}),i=p(r.name,a.system);if(void 0!==i){if(void 0===a.component[r.name]||void 0===a.component[r.name][r.entity])return i.create({state:o,component:r});if(i.update)return i.update({state:o,component:r})}return o},m=function(e){var t=e.state,n=e.name,a=h({state:t,name:n});return a?Object.keys(a).reduce((function(e,t){return function(e){var t,n=e.name,a=e.entity,r=e.state,o=r.component[n],i=a,c=(o[i],function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}(o,["symbol"==typeof i?i:i+""])),s=d(d({},r),{component:d(d({},r.component),(t={},t[n]=c,t))}),u=g({name:n,state:r,entity:a}),l=p(n,s.system);return l&&u?l.remove({state:s,component:u}):s}({name:n,entity:t,state:e})}),t):t},g=function(e){var t=e.name,n=e.entity,a=e.state.component[t];return a?a[n]:void 0},h=function(e){var t=e.name;return e.state.component[t]},b=function(e){var t=e.entity,n=e.name,a=function(e){var a=e.state;return g({state:a,entity:t,name:n})};return{getComponent:a,setComponent:function(e){var r=e.state,o=e.data,i=a({state:r});return i?r=v({state:r,data:d(d({entity:t,name:n},i),o)}):r}}},x={entity:{},component:(f={},f[a.box]={},f[a.ai]={},f[a.game]={},f[a.camera]={},f[a.marker]={},f[a.ui]={},f[a.uiButton]={},f[a.uiImage]={},f[a.uiText]={},f[a.background]={},f[a.turnIndicator]={},f),system:[]};!function(e){e[e.mainMenu=0]="mainMenu",e[e.customLevel=1]="customLevel",e[e.customLevelSettings=2]="customLevelSettings"}(y||(y={}));var T,w=function(){return(w=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},O=function(e,t){for(var n=0,a=t.length,r=e.length;n<a;n++,r++)e[r]=t[n];return e};!function(e){e[e.last=3]="last",e[e.time=3]="time",e[e.io=2]="io",e[e.transform=1]="transform",e[e.zero=0]="zero",e[e.sprite=-1]="sprite",e[e.draw=-2]="draw"}(T||(T={}));var P=function(e){return e.state},C=function(e){var t=e.state,n=e.tick,a=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}(e,["state","tick"]),r={name:a.name,priority:a.priority||T.zero,initialize:a.initialize||P,create:a.create||P,tick:function(e){var t=e.state,r=e.eventBuffer,o=t.component[a.name];return o?Object.values(o).reduce((function(e,t){var o=function(e){var t=e.entity,n=e.eventBuffer,a=e.state,r=e.eventHandler,o=e.component;return n[t]?n[t].reduce((function(e,n){if(r){var a=g({state:e,entity:t,name:o.name});return a?r({state:e,event:n,component:a}):e}return e}),a):a}({eventHandler:a.event,state:e,eventBuffer:r,entity:t.entity,component:t});return n?n({state:o,component:t}):o}),t):t},update:a.update,remove:a.remove||P,event:a.event||P};return w(w({},t),{system:O(O([],t.system),[r])})},S={},M=function(e){var t=e.textureUrl,n=e.scene,a=new o.Texture(t,n,void 0,void 0,o.Texture.NEAREST_NEAREST_MIPLINEAR);return S[t]=a,a},E=function(){return(E=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},B={emptyBox:50,preferEmptyBoxes:15,advancedAttack:7,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:10,playerLessThanOponent:-10,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:-15,sixToSix:50,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:2,playerLessThanOponent:7,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:0,toBorder:0}},I={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:2,playerLessThanOponent:-2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:1,playerLessThanOponent:2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:0,toBorder:0}},k={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:0,playerLessThanOponent:-2,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:5,playerEqualToOponent:0,playerLessThanOponent:5,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:0,toBorder:0}},L=function(){return(L=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},A=function(e,t,n){return e&&e[n]?e[n][t]:void 0},j=function(e){return[e[1][0],e[0][1],e[1][2],e[2][1]]},R=function(e,t){var n=t[0],a=t[1];return[[A(e,a-1,n-1),A(e,a,n-1),A(e,a+1,n-1)],[A(e,a-1,n),A(e,a,n),A(e,a+1,n)],[A(e,a-1,n+1),A(e,a,n+1),A(e,a+1,n+1)]]};const U=n.p+"57365b6b32a38acad399fa24be970b62.png",q=n.p+"86711768640182ba9774e66c59e43713.png",z=n.p+"d5fd50f6577249e4bd0a6cedc07b855c.png",N=n.p+"1cece826ef3290f02e8ab121defa70e5.png",V=n.p+"04486ea103fd49156ce128e43c00f4af.png",G=n.p+"4c8888485f10730f523694c6ac7449e4.png",Q=n.p+"3bb45fa09a5eb9cd805c7f32aab31591.png",F=n.p+"289b33e3a3e1c125f813747944282bbb.png",D=n.p+"e7015b6db11decc2aa7f722b6eaaa343.png",_=n.p+"7e6aabd8e3d92edca81c0207761816f0.png",W=n.p+"1a202abfbdfbb945f566e890f0e0fa7f.png",Y=n.p+"ad7c3be816ce34c76152ecc6c61d263b.png",H=n.p+"8711d0d55135c6a04bf3e76aa6287504.png",K=n.p+"717e6eb5fb82bedfc88f6dc0c65b6f12.png",J=n.p+"16c7f9cc6c2acada16547b3befe94a91.png",$=n.p+"2d2b2519ce6d9ed0c93cd7ed21aed043.png",X=n.p+"7fa7abdc3e479f97ee5f6b283630df03.png",Z=n.p+"f3941c38549dddc4a8cb586591e36996.png",ee=n.p+"62bd7e3778d77e5ca308fcb5f4b0da78.png",te=n.p+"2f30a46bdc58014e8ba857f895bbe5b8.png",ne=n.p+"de0b87223c2e5708366657b7da01c941.png",ae=n.p+"54b2699e76fca159c5797b2b93b10bd4.png",re=n.p+"3d713800c02422e02fe02e70f53e9771.png",oe=n.p+"2f9682e3f7d362cc3087ef4dcbbdfd2b.png",ie=n.p+"62f6adca2ae3c6e088aac66bc47cb54e.png",ce=n.p+"9bb2d886948bbd78603ec224904774fd.png",se=n.p+"2d9f8ec02b7087dc45bf61208aacf7a8.png",ue=n.p+"4fd5888696b352601fd6c1f7a1420e1f.png",le=n.p+"d62f41f971620bf90529571efed25c8e.png",de=n.p+"2c7434786497b8ccb02757089a53015a.png",pe=n.p+"51f16b6b18086fcc295f8bc02e6c8c45.png",fe=n.p+"0dfd6a6b5e5120be13c81ddc1d84a1df.png",ye=n.p+"301a367840edef78b86808852d0c067e.png",ve=n.p+"d854a7c9f810ebe5be07e17990bd0ee4.png",me=n.p+"777079c111d24a4a0402f5afbc95b175.png",ge=n.p+"e1b39772fd20282e80743b1f04be6795.png",he=n.p+"24075b75ce25b7869e6559cccca76b75.png",be=n.p+"698b6e6ce4fcc13dd8ac2cdb9bb484fe.png",xe=n.p+"38ca2b18556222743ee8778742514d73.png",Te=n.p+"aebe569c1bf5190e0038b7098791359c.png",we=n.p+"d1390ce752b5ee52126d21de796a81f8.png",Oe=n.p+"d54421100963619575d7b3f35876fdfe.png",Pe=n.p+"cde379b0a92320968a3826f29eff20fc.png",Ce=n.p+"d1b88dc4aa017270afbb48ce8c2d93ee.png",Se=n.p+"f07f0db4072406727dc668f8f643b725.png",Me=n.p+"f60fcf550b1112ec6a6bb8c80cc4b142.png",Ee=n.p+"5fded717b6adc588c2dcdedd900f3bea.png",Be=n.p+"ed032e786ebb26ea79c773fd85684876.png",Ie=n.p+"7960efbc05f46d226a4e232b391a79ea.png";var ke=[U,q,z,N,V,G,Q],Le=[U,F,D,_,W,Y,H],Ae=[U,K,J,$,X,Z,ee],je=[U,te,ne,ae,re,oe,ie],Re=[U,ce,se,ue,le,de,pe],Ue=[U,fe,ye,ve,me,ge,he],qe=[U,be,xe,Te,we,Oe,Pe],ze=[U,Ce,Se,Me,Ee,Be,Ie],Ne=function(e){var t=e.mesh,n=e.texture,a=e.scene,r=e.color;t.material.diffuseColor=new o.Color3(r[0],r[1],r[2]);var i=function(e){var t=e.textureUrl,n=e.scene;return S[t]?S[t]:M({textureUrl:t,scene:n})}({textureUrl:n,scene:a});return t.material.diffuseTexture=i,i},Ve=function(e){var t=e.scene,n=e.name,a=e.uniqueId,r=e.position,i=e.color,c=e.state,s=e.ai,u=e.dots,d=e.isClickable,p=new o.TransformNode("box "+n,t);return p.uniqueId=a,p.position.x=r[0],p.position.y=r[1],[[new o.Vector3(0,0,-.5),new o.Vector3(0,0,0)],[new o.Vector3(-.5,0,0),new o.Vector3(0,Math.PI/2,0)],[new o.Vector3(0,0,.5),new o.Vector3(0,Math.PI,0)],[new o.Vector3(.5,0,0),new o.Vector3(0,-Math.PI/2,0)],[new o.Vector3(0,.5,0),new o.Vector3(Math.PI/2,0,0)],[new o.Vector3(0,-.5,0),new o.Vector3(-Math.PI/2,0,0)]].forEach((function(e,n){var r=e[0],f=e[1],y=o.Mesh.CreatePlane("plane"+n,1,t,!1);y.parent=p,y.material=new o.StandardMaterial("mat",t),Ne({mesh:y,color:i,texture:tn({state:c,ai:s})[u],scene:t}),y.material.alpha=1,y.position=r,y.rotation=f,y.setParent(p),d&&(y.actionManager=new o.ActionManager(t),y.actionManager.registerAction(new o.ExecuteCodeAction(o.ActionManager.OnPickUpTrigger,(function(){l({entity:hn,type:ln.Type.playerClick,payload:{boxEntity:a.toString()}})}))))})),p},Ge=function(e){var t=e.getEngine().getRenderingCanvasClientRect();return null!==t?t.height/t.width:1},Qe=function(e){var t=e.value,n=e.min,a=e.max;return t<=n?n:t>=a?a:t},Fe=[.6,.6,.6],De=[.11,.79,.29],_e=[.09,.84,1],We=[1,.73,.29],Ye=[.99,.97,.32],He=[.99,.42,.45],Ke=[.99,.47,.94],Je=[.67,.23,.94],$e=function(e,t){return e+Math.random()*t-Math.random()*t},Xe=function(e){return[Qe({value:$e(e[0],.3),min:0,max:1}),Qe({value:$e(e[1],.3),min:0,max:1}),Qe({value:$e(e[2],.3),min:0,max:1})]},Ze=(Xe(Fe),Xe(Fe),Xe(Fe),Xe(Fe),Xe(Fe),Xe(Fe),Xe(De),Xe(De),Xe(De),Xe(De),Xe(De),Xe(De),[_e,Xe(_e),Xe(_e),_e,Xe(_e),Xe(_e),_e,Xe(_e),Xe(_e),_e]),et=(Xe(We),Xe(We),Xe(We),Xe(We),Xe(We),Xe(We),Xe(Ye),Xe(Ye),Xe(Ye),Xe(Ye),Xe(Ye),Xe(Ye),Xe(He),Xe(He),Xe(He),Xe(He),Xe(He),Xe(He),Xe(Ke),Xe(Ke),Xe(Ke),Xe(Ke),Xe(Ke),Xe(Ke),Xe(Je),Xe(Je),Xe(Je),Xe(Je),Xe(Je),Xe(Je),n(290),function(){return Math.floor(1e17*Math.random())}),tt="localDbKey",nt=function(){localStorage.removeItem(tt)},at=function(e){var t,n=e.entity,a=e.advancedTexture,r=e.onPointerUpObservable,o=null===(t=a.getChildren().find((function(e){return e.name===Ot})))||void 0===t?void 0:t.getChildByName(n);o&&o.onPointerUpObservable.add(r)},rt=et().toString();const ot=n.p+"8b1469fe19d1d6c3811ef4ef5c6df926.png";var it,ct=et().toString(),st=et().toString(),ut=et().toString(),lt=et().toString(),dt=et().toString(),pt=et().toString(),ft=et().toString(),yt=et().toString(),vt=et().toString(),mt=et().toString(),gt=et().toString(),ht=et().toString(),bt=et().toString(),xt=et().toString(),Tt=function(e){switch(e){case bn.disabled:return"Disabled";case bn.random:return"Random";case bn.easy:return"Easy";case bn.medium:return"Medium";case bn.hard:return"Hard";case bn.experimental:return"Experimental"}},wt="23505760496063488",Ot="root",Pt=b({entity:wt,name:a.ui}),Ct=Pt.getComponent,St=Pt.setComponent,Mt=function(e){var t,n=e.state;return null===(t=e.advancedTexture.getChildren().find((function(e){return e.name===Ot})))||void 0===t||t.clearControls(),n=m({state:n,name:a.uiImage}),n=m({state:n,name:a.uiButton}),m({state:n,name:a.uiText})},Et=function(e){var t=e.state,n=e.advancedTexture,r=e.attachEvents,o=Ct({state:t});switch(null==o?void 0:o.type){case y.customLevel:t=function(e){return v({state:e.state,data:{entity:rt,name:a.uiButton,text:"X",size:[[.1,.1],[.1,.1],[.1,.1]],position:[[.95,.05],[.95,.05],[.95,.05]]}})}({state:t}),r&&function(e){at({advancedTexture:e.advancedTexture,entity:rt,onPointerUpObservable:function(){nt(),l({type:ln.Type.cleanScene,entity:hn,payload:{newScene:y.mainMenu}})}})}({advancedTexture:n});break;case y.mainMenu:t=function(e){var t=e.state,n=e.advancedTexture;t=v({state:t,data:{entity:ct,name:a.uiImage,url:ot,size:[[.5,.3],[.5,.3],[.5,.3]],maxSize:[[.5,.3],[.5,.3],[.5,.3]],position:[[.5,.15],[.5,.15],[.5,.15]],aspectRation:1}});var r=[[.6,.1],[.4,.1],[.2,.1]];t=v({state:t,data:{entity:st,name:a.uiButton,text:"Start",size:r,position:[[.5,.4],[.5,.4],[.5,.4]]}}),t=v({state:t,data:{entity:ut,name:a.uiButton,text:"Select level",size:r,position:[[.5,.6],[.5,.6],[.5,.6]]}}),t=v({state:t,data:{entity:lt,name:a.uiButton,text:"Mute",size:r,position:[[.5,.8],[.5,.8],[.5,.8]]}});var o=On({state:t});return t=v({state:t,data:{entity:dt,name:a.uiText,text:"version "+(null==o?void 0:o.version),size:r,color:"#444",fontSize:24,position:[[.9,.9],[.9,.9],[.9,.9]]}}),(null==o?void 0:o.newVersionAvailable)&&(t=v({state:t,data:{entity:pt,name:a.uiButton,text:"New version available. Click here to reload",size:[[.2,.2],[.2,.2],[.2,.2]],position:[[.1,.1],[.1,.1],[.1,.1]]}}),at({advancedTexture:n,entity:pt,onPointerUpObservable:function(){l({type:ln.Type.reload,entity:hn,payload:{}})}})),t}({state:t,advancedTexture:n}),r&&function(e){var t=e.advancedTexture;at({advancedTexture:t,entity:st,onPointerUpObservable:function(){l({type:ln.Type.cleanScene,entity:hn,payload:{newScene:y.customLevelSettings}})}}),at({advancedTexture:t,entity:ut,onPointerUpObservable:function(){l({type:ln.Type.cleanScene,entity:hn,payload:{newScene:y.customLevelSettings}})}}),at({advancedTexture:t,entity:lt,onPointerUpObservable:function(){l({type:ln.Type.cleanScene,entity:hn,payload:{newScene:y.customLevelSettings}})}})}({advancedTexture:n});break;case y.customLevelSettings:t=function(e){var t,n=e.state,r=On({state:n}),o=[[.5,.1],[.4,.1],[.3,.1]];return n=v({state:n,data:{entity:gt,name:a.uiText,text:"Map",size:[[.9,.1],[.4,.1],[.3,.1]],position:[[.5,.05],[.5,.05],[.5,.05]]}}),n=v({state:n,data:{entity:bt,name:a.uiButton,text:"<",size:[[.1,.5],[.2,.5],[.2,.5]],position:[[.1,.25],[.2,.25],[.2,.25]]}}),n=v({state:n,data:{entity:ht,name:a.uiButton,text:">",size:[[.1,.5],[.2,.5],[.2,.5]],position:[[.9,.25],[.8,.25],[.8,.25]]}}),n=v({state:n,data:{entity:xt,name:a.uiButton,text:"Start >",size:o,position:[[.5,.6],[.5,.6],[.5,.6]]}}),n=v({state:n,data:{entity:yt,name:a.uiButton,text:"Difficulty: "+((null==r?void 0:r.customLevelSettings.difficulty)?Tt(null==r?void 0:r.customLevelSettings.difficulty):"-"),size:o,position:[[.25,.75],[.25,.75],[.25,.75]]}}),n=v({state:n,data:{entity:ft,name:a.uiButton,text:"Players: "+(null===(t=null==r?void 0:r.customLevelSettings.players)||void 0===t?void 0:t.length),size:o,position:[[.25,.85],[.25,.85],[.25,.85]]}}),n=v({state:n,data:{entity:vt,name:a.uiButton,text:"["+((null==r?void 0:r.customLevelSettings.quickStart)?"x":" ")+"] Quick Start",size:o,position:[[.75,.75],[.75,.75],[.75,.75]]}}),v({state:n,data:{entity:mt,name:a.uiButton,text:"["+((null==r?void 0:r.colorBlindMode)?"x":" ")+"] Color blind mode",size:o,position:[[.75,.85],[.75,.85],[.75,.85]]}})}({state:t}),r&&function(e){var t=e.advancedTexture;at({advancedTexture:t,entity:ft,onPointerUpObservable:function(){l({type:ln.Type.changePlayers,entity:hn,payload:{}})}}),at({advancedTexture:t,entity:yt,onPointerUpObservable:function(){l({type:ln.Type.changeDifficulty,entity:hn,payload:{}})}}),at({advancedTexture:t,entity:vt,onPointerUpObservable:function(){l({type:ln.Type.changeQuickStart,entity:hn,payload:{}})}}),at({advancedTexture:t,entity:mt,onPointerUpObservable:function(){l({type:ln.Type.changeColorBlindMode,entity:hn,payload:{}})}}),at({advancedTexture:t,entity:gt,onPointerUpObservable:function(){l({type:ln.Type.changeMapType,entity:hn,payload:{}})}}),at({advancedTexture:t,entity:ht,onPointerUpObservable:function(){l({type:ln.Type.changeNextMap,entity:hn,payload:{}})}}),at({advancedTexture:t,entity:bt,onPointerUpObservable:function(){l({type:ln.Type.changePrevMap,entity:hn,payload:{}})}}),at({advancedTexture:t,entity:xt,onPointerUpObservable:function(){l({type:ln.Type.startCustomLevel,entity:hn,payload:{}})}})}({advancedTexture:n})}return t},Bt=null,It=function(){return(It=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},kt=function(e,t,n,r,o){return void 0===r&&(r=!1),void 0===o&&(o=bn.easy),{entity:e,name:a.ai,human:r,level:o,color:t,textureSet:n,active:!0}},Lt=function(){return[kt(Dn,_e,ke,!0,bn.easy),kt("2",He,Le,!1,bn.easy),kt("3",De,Ae,!1,bn.easy),kt("4",Ye,je,!1,bn.easy),kt("5",We,Re,!1,bn.easy),kt("6",Ke,Ue,!1,bn.easy),kt("7",Fe,qe,!1,bn.easy),kt("8",Je,ze,!1,bn.easy)]},At="17818552155683748",jt=b({entity:At,name:a.background}),Rt=(jt.getComponent,jt.setComponent),Ut=function(e){var t=Wn.getMeshByUniqueId(parseFloat(At)),n=Ht({state:e});if(t&&n){var a=Jt(n.distance,Wn);t.position.x=n.position[0],t.position.y=n.position[1],t.scaling=new o.Vector3(Math.abs(a.left)+Math.abs(a.right),Math.abs(a.bottom)+Math.abs(a.top),1)}return e},qt=function(e,t){return void 0===t&&(t={}),Math.random().toString()},zt=function(e){return console.trace("Wrong path",e),e},Nt=function(){return(Nt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Vt="68127445920450266",Gt=b({entity:Vt,name:a.turnIndicator}),Qt=(Gt.getComponent,Gt.setComponent),Ft=function(){return(Ft=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Dt="cameraEntity";!function(e){var t;(t=e.Type||(e.Type={}))[t.resize=0]="resize"}(it||(it={}));var _t,Wt,Yt=b({entity:Dt,name:a.camera}),Ht=Yt.getComponent,Kt=function(e){var t=e.state,n=e.data,a=function(e){var t,n=e.component;n.position&&(Yn.position.x=n.position[1],Yn.position.y=n.position[0],Yn.position.z=-10,Yn.setTarget(new o.Vector3(n.position[1],n.position[0])));var a=Jt(null!==(t=n.distance)&&void 0!==t?t:0,Wn);return Yn.orthoLeft=a.left,Yn.orthoRight=a.right,Yn.orthoBottom=a.bottom,Yn.orthoTop=a.top,a}({component:n});return Yt.setComponent({state:t,data:Ft(Ft({},n),a)})},Jt=function(e,t){var n=Ge(t);return n>1?{left:-e,right:e,bottom:-e*n,top:e*n}:{bottom:-e,top:e,left:-e/n,right:e/n}},$t=1.2,Xt=function(){return(Xt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Zt=function(e,t){for(var n=0,a=t.length,r=e.length;n<a;n++,r++)e[r]=t[n];return e};!function(e){e[e.up=0]="up",e[e.down=1]="down",e[e.left=2]="left",e[e.right=3]="right"}(_t||(_t={})),function(e){var t;(t=e.Type||(e.Type={}))[t.onClick=0]="onClick",t[t.rotationEnd=1]="rotationEnd",t[t.rotate=2]="rotate"}(Wt||(Wt={}));var en=function(e){return e>2*Math.PI||e<-2*Math.PI?-2*Math.PI:e},tn=function(e){var t=e.state,n=e.ai,a=On({state:t});return n&&(null==a?void 0:a.colorBlindMode)?n.textureSet:ke},nn=function(e){var t=e.entity,n=e.state,a=On({state:n});return a?v({state:n,data:Xt(Xt({},a),{boxRotationQueue:Zt(Zt([],a.boxRotationQueue),[t])})}):n},an=function(e){var t=e.entity,n=e.animationEndCallback,a=(e.direction,e.color),r=e.texture,i=Wn.getTransformNodeByUniqueId(parseInt(t));if(i){var c=o.Tools.ToRadians(90)*(Math.random()>.5?1:-1),s=Math.random()>.5?"x":"y",u=i.rotation,l=new o.Vector3("x"===s?c:0,"y"===s?c:0,0).add(u),d=new o.Vector3(en(l.x),en(l.y),en(l.z)),p=new o.Animation("rotateAnimation","rotation",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),f=new o.AnimationEvent(.5,n,!0);p.addEvent(f);var y=[];y.push({frame:0,value:u}),y.push({frame:.5,value:d}),p.setKeys(y),i.animations[i.animations.length]=p,Wn.beginAnimation(i,0,1,!1);var v=i.getChildren();v.slice(1,v.length).forEach((function(e){var t=Wn.getMeshByUniqueId(e.uniqueId);t&&Ne({mesh:t,color:a,texture:r,scene:Wn})}))}},rn=function(e){return 6===e?1:e+1},on=function(e){var t=e.state,n=e.ai,a=e.box,r=a.entity,o=a.dots;return n&&(o=rn(a.dots),an({entity:r,animationEndCallback:function(){l({type:Wt.Type.rotationEnd,entity:r,payload:{ai:n,shouldExplode:6===a.dots}})},texture:tn({state:t,ai:n})[o],color:n.color}),t=nn({entity:r,state:t})),v({state:t,data:Xt(Xt({},a),{isAnimating:!0,player:(null==n?void 0:n.entity)||"",dots:o})})},cn=function(e){var t=e.boxEntity,n=e.texture,a=e.color,r=Wn.getTransformNodeByUniqueId(parseInt(t));r&&(r.rotation.x=0,r.rotation.y=0,r.getChildren().forEach((function(e){var t=Wn.getMeshByUniqueId(e.uniqueId);t&&Ne({mesh:t,color:a,texture:n,scene:Wn})})))},sn=function(e){return C({state:e,name:a.box,create:function(e){var t=e.state,n=e.component,r=n.gridPosition,o=g({state:t,name:a.ai,entity:n.player||""});Ve({scene:Wn,name:r[0]+"-"+r[1],position:[r[0]*$t,r[1]*$t],uniqueId:parseFloat(n.entity),color:(null==o?void 0:o.color)||[1,1,1],ai:o,dots:n.dots,state:t,isClickable:!0});var i=On({state:t});return i?t=v({state:t,data:Xt(Xt({},i),{grid:Zt(Zt([],i.grid),[n.entity])})}):t},remove:function(e){var t=e.state,n=e.component,a=Wn.getTransformNodeByUniqueId(parseInt(n.entity));return null==a||a.dispose(),t},event:function(e){var t=e.state,n=e.component,a=e.event;switch(a.type){case Wt.Type.rotationEnd:return function(e){var t=e.state,n=e.component,a=e.event.payload,r=a.ai,o=a.shouldExplode;t=function(e){var t=e.entity,n=e.state,a=On({state:n});return a?v({state:n,data:Xt(Xt({},a),{boxRotationQueue:a.boxRotationQueue.filter((function(e){return e!==t}))})}):n}({entity:n.entity,state:t}),cn({boxEntity:n.entity,texture:tn({state:t,ai:r})[n.dots],color:r.color});var i=On({state:t});if(!i)return t;o?t=function(e){var t=e.state,n=e.ai,a=e.box.gridPosition,r=a[0],o=a[1],i=Bn({state:t});return[A(i,o,r-1),A(i,o,r+1),A(i,o-1,r),A(i,o+1,r)].filter((function(e){return void 0!==e})).reduce((function(e,t,a){return e=on({ai:n,box:t,state:e}),nn({entity:t.entity,state:e})}),t)}({state:t,box:n,ai:r}):0===i.boxRotationQueue.length&&l({type:ln.Type.nextTurn,entity:hn,payload:{ai:r}});var c=Wn.getTransformNodeByUniqueId(parseInt(n.entity));return c&&(c.animations=[]),v({state:t,data:Xt(Xt({},n),{isAnimating:!1})})}({state:t,component:n,event:a});case Wt.Type.rotate:return function(e){var t=e.state,n=e.component,a=e.event;return an({entity:n.entity,animationEndCallback:function(){cn({boxEntity:n.entity,texture:a.payload.texture,color:a.payload.color})},texture:a.payload.texture,color:a.payload.color}),t}({state:t,component:n,event:a})}}})};const un=n.p+"de1ab0613214552916d369d2014d1d95.png";var ln,dn="38127445920450264",pn=b({entity:dn,name:a.marker}),fn=(pn.getComponent,pn.setComponent),yn=function(){return(yn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},vn=function(){return(vn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},mn=function(e){var t=e.state,n=e.component;t=function(e){var t=e.state,n=e.game;t=function(e){var t=e.state,n=e.ai;t=m({state:t,name:a.ai});var r=On({state:t});return r&&(t=v({state:t,data:yn(yn({},r),{playersQueue:n.map((function(e){return e.entity}))})})),n.reduce((function(e,t){return v({state:e,data:t})}),t)}({state:t=Array.from({length:8}).reduce((function(e,t,n){return Array.from({length:8}).reduce((function(e,t,r){return v({state:e,data:{name:a.box,entity:et().toString(),isAnimating:!1,dots:0,gridPosition:[r,n],player:void 0}})}),e)}),t),ai:n.customLevelSettings.players.map((function(e){return vn(vn({},e),{level:n.customLevelSettings.difficulty})}))});var r,o,i,c=(r=Bn({state:t}),o=r[0]?1.2*r[0].length:1,i=1.2*r.length,{center:[(o-1-.2)/2,(i-1-.2)/2],cameraDistance:(o>i?o:i)/2+.2}),s=c.center,u=c.cameraDistance;return t=Kt({state:t,data:{position:[s[0],s[1]],distance:u}}),St({state:t,data:{type:y.customLevel,cleanControls:!0}})}({state:t,game:n});var r=Sn({state:t});if(!r)return zt(t);t=Pn({state:t,data:{currentPlayer:r.entity}});var o=On({state:t});if(!o)return zt(t);if(o.customLevelSettings.quickStart&&(t=function(e){var t,n=e.state,r=(null===(t=On({state:n}))||void 0===t?void 0:t.grid.length)||1;return Array.from({length:2*r}).reduce((function(e){var t=On({state:e}),n=g({state:e,name:a.ai,entity:(null==t?void 0:t.currentPlayer)||""});if(!t||!n)return zt(e);var r=Ln({state:e,ai:n,preferEmptyBoxes:!0});if(!r)return zt(e);e=v({state:e,data:vn(vn({},r),{player:n.entity,dots:rn(r.dots)})});var o=Sn({state:e});return o?e=v({state:e,data:vn(vn({},t),{currentPlayer:o.entity})}):e}),n)||n}({state:t}),setTimeout((function(){!function(e){var t=e.state,n=On({state:t});n&&n.grid.forEach((function(e){var n=g({state:t,entity:e,name:a.box}),r=g({state:t,entity:(null==n?void 0:n.player)||"",name:a.ai});n&&r&&l({type:Wt.Type.rotate,entity:e,payload:{color:r.color,texture:tn({state:t,ai:r})[n.dots],direction:_t.up}})}))}({state:t})}),500)),t=Pn({state:t,data:{gameStarted:!0}}),!r.human){var i=Ln({state:t,ai:r});i&&(t=on({box:i,state:t,ai:r}))}return t=v({state:t,data:{entity:Vt,name:a.turnIndicator,position:[0,0],boxes:[],texts:[],highlighter:""}})},gn=function(){return(gn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},hn="game";!function(e){var t;(t=e.Type||(e.Type={}))[t.startCustomLevel=0]="startCustomLevel",t[t.nextTurn=1]="nextTurn",t[t.boxExplosion=2]="boxExplosion",t[t.playerClick=3]="playerClick",t[t.cleanScene=4]="cleanScene",t[t.changePlayers=5]="changePlayers",t[t.changeDifficulty=6]="changeDifficulty",t[t.changeQuickStart=7]="changeQuickStart",t[t.changeColorBlindMode=8]="changeColorBlindMode",t[t.changeMapType=9]="changeMapType",t[t.changeNextMap=10]="changeNextMap",t[t.changePrevMap=11]="changePrevMap",t[t.showNewVersion=12]="showNewVersion",t[t.reload=13]="reload"}(ln||(ln={}));var bn,xn,Tn,wn=b({entity:hn,name:a.game}),On=wn.getComponent,Pn=wn.setComponent,Cn=function(e){var t=e.playersQueue,n=e.index,r=e.state,o=g({state:r,name:a.ai,entity:t[n]});return(null==o?void 0:o.active)?o:Cn({playersQueue:t,index:n>=t.length?0:n+1,state:r})},Sn=function(e){var t=e.state,n=On({state:t});if(n){var a=n.playersQueue.findIndex((function(e){return n.currentPlayer===e}));return Cn({playersQueue:n.playersQueue,index:a+1,state:t})}},Mn=function(e){return C({state:e,name:a.game,event:function(e){var t=e.state,n=e.component,r=e.event;switch(r.type){case ln.Type.startCustomLevel:return mn({state:t,component:n,event:r});case ln.Type.nextTurn:return function(e){var t=e.state,n=e.component,r=n.gameStarted,o=n.boxRotationQueue;if(r&&0===o.length){var i=Sn({state:t});if(!i)return t;var c=g({name:a.ai,state:t,entity:i.entity});if(!c)return t;if(t=v({state:t,data:gn(gn({},n),{currentPlayer:c.entity})}),!c.human&&c.active){var s=Ln({state:t,ai:c});if(!s)return function(e){var t=e.state,n=e.ai,r=e.component;t=v({state:t,data:gn(gn({},n),{active:!1})});var o=h({state:t,name:a.ai});return 1===Object.values(o||{}).reduce((function(e,t){return t.active?e+1:e}),0)?(nt(),v({state:t,data:gn(gn({},r),{gameStarted:!1})})):(l({type:ln.Type.nextTurn,entity:hn,payload:{ai:n}}),t)}({state:t,component:n,ai:c});t=fn({state:t,data:{color:c.color,position:[s.gridPosition[0]*$t,s.gridPosition[1]*$t]}}),t=on({box:s,state:t,ai:c}),t=nn({state:t,entity:s.entity})}}return function(e){localStorage.setItem(tt,JSON.stringify(e))}(t),t}({state:t,component:n,event:r});case ln.Type.playerClick:return function(e){var t=e.state,n=e.component,r=e.event,o=n.currentPlayer,i=n.gameStarted,c=n.boxRotationQueue,s=g({state:t,name:a.box,entity:r.payload.boxEntity}),u=void 0===(null==s?void 0:s.player)||(null==s?void 0:s.player)===o;if(i&&0===c.length&&u){var l=g({name:a.ai,state:t,entity:o});s&&(null==l?void 0:l.human)&&(t=fn({state:t,data:{color:l.color,position:[s.gridPosition[0]*$t,s.gridPosition[1]*$t]}}),t=on({box:s,state:t,ai:l}))}return t}({state:t,component:n,event:r});case ln.Type.cleanScene:return function(e){var t=e.state;return t=St({state:t,data:{type:e.event.payload.newScene,cleanControls:!0}}),t=Pn({state:t,data:{round:0,grid:[],currentPlayer:"",playersQueue:[],boxRotationQueue:[],gameStarted:!1}}),t=m({state:t,name:a.box}),m({state:t,name:a.ai})}({state:t,component:n,event:r});case ln.Type.changePlayers:return function(e){var t,n,a=e.state,r=e.component,o=8===(null===(t=r.customLevelSettings.players)||void 0===t?void 0:t.length)?2:(null===(n=r.customLevelSettings.players)||void 0===n?void 0:n.length)+1;return a=Pn({state:a,data:{customLevelSettings:It(It({},r.customLevelSettings),{players:Lt().slice(0,o)})}}),St({state:a,data:{}})}({state:t,component:n,event:r});case ln.Type.changeDifficulty:return function(e){var t,n=e.state,a=e.component,r=[bn.easy,bn.medium,bn.hard,bn.experimental],o=r.findIndex((function(e){return e===a.customLevelSettings.difficulty})),i=-1===o?r[0]:null!==(t=r[o+1])&&void 0!==t?t:r[0];return n=Pn({state:n,data:{customLevelSettings:It(It({},a.customLevelSettings),{difficulty:i})}}),St({state:n,data:{}})}({state:t,component:n,event:r});case ln.Type.changeQuickStart:return function(e){var t=e.state,n=e.component;return t=Pn({state:t,data:{customLevelSettings:It(It({},n.customLevelSettings),{quickStart:!n.customLevelSettings.quickStart})}}),St({state:t,data:{}})}({state:t,component:n,event:r});case ln.Type.changeColorBlindMode:return function(e){var t=e.state;return t=Pn({state:t,data:{colorBlindMode:!e.component.colorBlindMode}}),St({state:t,data:{}})}({state:t,component:n,event:r});case ln.Type.changeMapType:case ln.Type.changeNextMap:case ln.Type.changePrevMap:return function(e){return St({state:e.state,data:{}})}({state:t,component:n,event:r});case ln.Type.showNewVersion:return function(e){var t=e.state;return t=Pn({state:t,data:{newVersionAvailable:!0}}),St({state:t,data:{}})}({state:t,component:n,event:r});case ln.Type.reload:return function(e){var t=e.state;return window.location.reload(),t}({state:t,component:n,event:r})}}})},En=function(){return(En=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Bn=function(e){var t=e.state,n=On({state:t});return n?n.grid.reduce((function(e,n){var r=g({name:a.box,state:t,entity:n});if(r){var o=r.gridPosition[0],i=r.gridPosition[1];e[o]||(e[o]=[]),e[o][i]=En(En({},r),{points:0})}return e}),[]):[]},In=function(){return(In=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},kn=function(){return(kn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};!function(e){e.disabled="disabled",e.random="random",e.easy="easy",e.medium="medium",e.hard="hard",e.experimental="experimental"}(bn||(bn={})),function(e){e.Type||(e.Type={})}(xn||(xn={})),function(e){e[e.less=-1]="less",e[e.equal=0]="equal",e[e.more=1]="more"}(Tn||(Tn={}));var Ln=function(e){var t,n=e.state,a=e.ai,r=e.preferEmptyBoxes,o=a.entity,i=(t={},t[bn.disabled]=k,t[bn.random]=k,t[bn.easy]=k,t[bn.medium]=I,t[bn.hard]=B,t[bn.experimental]=B,t)[a.level],c=Bn({state:n});if(c=function(e){var t=e.dataGrid,n=e.currentPlayer,a=e.preferEmptyBoxes,r=e.aIGridPoints;return t.reduce((function(e,o,i){return e[i]=o.reduce((function(e,o,c){if(o.player!==n.entity&&void 0!==o.player)return e;var s=R(t,[i,c]),u=function(e){var t=e.grid3x3,n=e.preferEmptyBoxes,a=e.currentPlayer,r=e.aIGridPoints,o=t[1][1];return j(t).reduce((function(e,t){if(!t)return e+r.adjacted.toBorder;var i=o.dots===t.dots?Tn.equal:o.dots>t.dots?Tn.more:Tn.less;if(t.player!==o.player&&void 0!==t.player){if(n&&void 0===o.player&&t.player===a.entity)return Math.random()>.5?e+r.preferEmptyBoxes:e;if(i===Tn.more){var c=o.dots-t.dots;return e+r.adjacted.playerMoreThanOponent-c}if(i===Tn.equal)return e+r.adjacted.playerEqualToOponent*o.dots;if(i===Tn.less)return c=o.dots-t.dots-t.dots,e+r.adjacted.playerLessThanOponent*Math.abs(c)}else{if(6===o.dots)return e;if(i===Tn.more)return e+r.adjacted.playerMoreThanPlayer;if(i===Tn.equal)return 6===t.dots&&6===o.dots?e+r.adjacted.sixToSix:e+r.adjacted.playerEqualToPlayer;if(i===Tn.less)return 6===t.dots?e+2*r.adjacted.playerLessThanPlayer:e+r.adjacted.playerLessThanPlayer}return e}),0)}({grid3x3:s,preferEmptyBoxes:a,currentPlayer:n,aIGridPoints:r})+function(e){var t=e.grid3x3,n=e.aIGridPoints,a=t[1][1];return function(e){return[e[0][0],e[0][2],e[2][0],e[2][2]]}(t).reduce((function(e,t){if(!t)return e+n.diagonall.toBorder;var r=a.dots===t.dots?Tn.equal:a.dots>t.dots?Tn.more:Tn.less;if(t.player!==a.player&&void 0!==t.player){if(r===Tn.more)return e+n.diagonall.playerMoreThanOponent;if(r===Tn.equal)return 6===t.dots?e+-10*n.diagonall.playerEqualToOponent:e+n.diagonall.playerEqualToOponent;if(r===Tn.less)return 6===t.dots?e+2*n.diagonall.playerLessThanOponent:e+n.diagonall.playerLessThanOponent}else{if(6===a.dots)return e;if(r===Tn.more)return e+n.diagonall.playerMoreThanPlayer;if(r===Tn.equal)return e+n.diagonall.playerEqualToPlayer;if(r===Tn.less){var o=t.dots-a.dots;return e+n.diagonall.playerLessThanPlayer+Math.pow(o,2)}}return e}),0)}({grid3x3:s,preferEmptyBoxes:a,currentPlayer:n,aIGridPoints:r});return e[c]=L(L({},o),{points:o.points+u}),e}),o),e}),t)}({currentPlayer:a,dataGrid:c=function(e){var t=e.dataGrid,n=e.aIGridPoints;return t.reduce((function(e,t,a){return e[a]=t.reduce((function(e,t,a){var r=void 0===t.player?t.points+n.emptyBox:t.points;return e[a]=In(In({},t),{points:r}),e}),t),e}),t)}({dataGrid:c,aIGridPoints:i}),preferEmptyBoxes:!!r,aIGridPoints:i}),!r)switch(a.level){case bn.disabled:c=function(e){var t=e.dataGrid;return t.reduce((function(e,t,n){return e[n]=t.reduce((function(e,t,n){return e[n].player="-1",e}),t),e}),t)}({dataGrid:c});break;case bn.random:c=function(e){var t=e.dataGrid,n=e.currentPlayer;return t.reduce((function(e,t,a){return e[a]=t.reduce((function(e,t,a){return t.player!==n||void 0===t.player||(e[a]=E(E({},t),{points:100*Math.random()})),e}),t),e}),t)}({dataGrid:c,currentPlayer:o});break;case bn.experimental:c=function(e){var t=e.dataGrid,n=e.currentPlayer;return t.reduce((function(e,a,r){return e[r]=a.reduce((function(e,a,o){if(a.player!==n)return e;var i=R(t,[r,o]),c=j(i);if(c.some((function(e){return 6===(null==e?void 0:e.dots)})))return e;var s=c.reduce((function(e,r){if(!r)return e;var o=void 0!==r.player&&r.player!==n,i=a.dots>=r.dots;if(o&&i&&function(e){var t=e.currentPlayer,n=e.adjactedBox,a=e.dataGrid,r=e.position,o=r[0],i=r[1],c=R(a,[o,i]);return j(c).every((function(e){return void 0===e||e.player===t||void 0===e.player||e.dots<=n.dots}))}({currentPlayer:n,adjactedBox:r,dataGrid:t,position:r.gridPosition})){var c=6/a.dots;e+=r.dots*B.advancedAttack/c}return e}),0);return e[o]=kn(kn({},a),{points:a.points+s}),e}),a),e}),t)}({dataGrid:c,currentPlayer:o})}return function(e){var t=e.currentPlayer,n=-1/0,a=[];e.dataGrid.forEach((function(e){e.forEach((function(e){var r=void 0===e.player,o=e.player===t;(r||o)&&(e.points>n&&(a=[]),e.points>=n&&(n=e.points,a.push(e)))}))}));var r=Math.floor(Math.random()*a.length);return a[r]}({currentPlayer:o,dataGrid:c})},An=[768,1200,1400],jn=function(e,t){return t.find((function(t,n){return e<An[n]}))||t[t.length-1]},Rn=function(e){var t=e.element,n=e.babylonElement,a=e.scene,r=a.getEngine(),o=function(){var e,o=r.getRenderingCanvasClientRect(),i=o?o.width:1,c=t.aspectRation?Ge(a):1,s=[100*((e=jn(i,t.position))[0]-.5)+"%",100*(e[1]-.5)+"%"],u=s[0],l=s[1],d=jn(i,t.size),p=[d[0],d[1]/c],f=t.minSize?jn(i,t.minSize):[0,0],y=t.maxSize?jn(i,t.maxSize):[1,1],v=Qe({value:p[0],min:f[0],max:y[0]}),m=Qe({value:p[1],min:f[1],max:y[1]});n.width=v,n.height=m,n.top=l,n.left=u};return o(),r.onResizeObservable.add(o),n.onDisposeObservable.add((function(){return r.onResizeObservable.removeCallback(o)})),t},Un=function(e){var t,n=e.entity;return null===(t=null==Bt?void 0:Bt.getChildren().find((function(e){return e.name===Ot})))||void 0===t?void 0:t.getChildByName(n)},qn=function(e){var t,n,a=e.component,r=new BABYLON.GUI.TextBlock(a.entity);r.text=a.text,r.color=null!==(t=a.color)&&void 0!==t?t:"#fff",r.fontSize=null!==(n=a.fontSize)&&void 0!==n?n:24,r.textHorizontalAlignment=0,Rn({element:a,babylonElement:r,scene:Wn}),null==Bt||Bt.addControl(r)},zn=function(e){var t=e.entity,n=Un({entity:t});n&&n.dispose()},Nn=function(){return(Nn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Vn=n(155),Gn=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Qn(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}Vn.env.PUBLIC_URL="/kostki";var Fn=document.getElementById("game"),Dn="humanPlayer",_n=new o.Engine(Fn,!0,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1}),Wn=new o.Scene(_n);_n.runRenderLoop((function(){Wn&&Wn.activeCamera&&Wn.render()}));var Yn=new o.UniversalCamera("UniversalCamera",new o.Vector3(0,0,-1),Wn);Yn.mode=o.Camera.ORTHOGRAPHIC_CAMERA;var Hn=new o.HemisphericLight("light",new o.Vector3(0,0,1),Wn);Hn.intensity=1,Hn.diffuse=new BABYLON.Color3(1,1,1),Hn.specular=new BABYLON.Color3(1,1,1),Hn.groundColor=new BABYLON.Color3(1,1,1),"serviceWorker"in navigator&&(function(e){if("serviceWorker"in navigator){if(new URL(Vn.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t=Vn.env.PUBLIC_URL+"/service-worker.js";Gn?(function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Qn(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Qn(t,e)}))}}({onUpdate:function(){},onSuccess:function(){}}),navigator.serviceWorker.addEventListener("message",(function(e){return t=void 0,n=void 0,r=function(){var t,n,a,r;return function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}(this,(function(o){switch(o.label){case 0:return"workbox-broadcast-update"!==e.data.meta?[3,4]:(t=e.data.payload,n=t.cacheName,a=t.updatedURL,[4,caches.open(n)]);case 1:return[4,o.sent().match(a)];case 2:return[4,null==(r=o.sent())?void 0:r.text()];case 3:o.sent(),l({type:ln.Type.showNewVersion,entity:hn,payload:{}}),o.label=4;case 4:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,o){function i(e){try{s(r.next(e))}catch(e){o(e)}}function c(e){try{s(r.throw(e))}catch(e){o(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(i,c)}s((r=r.apply(t,n||[])).next())}));var t,n,a,r})));var Kn=function(){var e,t=x,n="0.0.0";t=function(e){return C({state:e,name:a.ai,create:function(e){var t=e.component,n=e.state;return setTimeout((function(){t.textureSet.forEach((function(e){var t=new Image;t.src=e,t.onload=function(){M({textureUrl:e,scene:Wn})}}))}),2e3*Math.random()+1e3),n}})}(t=sn(t)),t=function(e){return C({state:e,name:a.turnIndicator,create:function(e){var t=e.state,n=e.component,r=On({state:t}),i=Ht({state:t});if(!r||!i)return t;var c=null==r?void 0:r.playersQueue.map((function(e,n){var r=g({state:t,name:a.ai,entity:e}),o=qt(),i=Ve({scene:Wn,name:"turnIndicatorBox-"+n,position:[0,0],uniqueId:parseFloat(o),color:(null==r?void 0:r.color)||[1,1,1],ai:r,dots:1,state:t,isClickable:!1});return i.scaling.x=1/3,i.scaling.y=1/3,o})),s=null==r?void 0:r.playersQueue.map((function(e,n){var r=g({state:t,name:a.ai,entity:e}),o=qt();return t=v({state:t,data:{entity:o,name:a.uiText,text:(null==r?void 0:r.human)?"Player":"Computer",size:[[.1,.1],[.1,.1],[.1,.1]],color:"#444",fontSize:24,position:[[0,0],[0,0],[0,0]]}}),o})),u=qt();return function(e){var t=e.scene,n=e.entity,a=o.Mesh.CreatePlane("highlighter",1,t,!1);a.material=new o.StandardMaterial("mat",t),a.material.diffuseColor=new o.Color3(1,1,1),a.material.alpha=.5,a.uniqueId=parseFloat(n)}({scene:Wn,entity:u}),t=v({state:t,data:Nt(Nt({},n),{boxes:c,texts:s,highlighter:u})})},update:function(e){return function(e){var t=e.state,n=e.component,r=Ht({state:t});if(!r)return zt(t);var o=r.position[0]+r.left,i=r.position[1]+r.top,c=$t/3,s=[2*r.right,2*r.top];return n.boxes.forEach((function(e,r){var u=[o+c,i-r*c-c],l=[(u[0]-o+c)/s[0],(i-u[1])/s[1]],d=[[.1,.1],[.1,.1],[.1,.1]],p=Wn.getTransformNodeByUniqueId(parseFloat(e));p?(p.position.x=u[0],p.position.y=u[1]):zt(t);var f=g({state:t,name:a.uiText,entity:n.texts[r]});f?t=v({state:t,data:Nt(Nt({},f),{position:[[l[0]+d[0][0]/2,l[1]],[l[0]+d[0][0]/2,l[1]],[l[0]+d[0][0]/2,l[1]]]})}):zt(t)})),Wn.getMeshByUniqueId(parseFloat(n.highlighter))?t:zt(t)}({state:e.state,component:e.component})}})}(t=function(e){return C({state:e,name:a.background,create:function(e){var t=e.state;e.component,o.Effect.ShadersStore.customVertexShader=" \n        precision highp float;\n\n        // Attributes\n        attribute vec3 position;\n        attribute vec2 uv;\n\n        // Uniforms\n        uniform mat4 worldViewProjection;\n\n        // Varying\n        varying vec2 vUV;\n\n        void main(void) {\n            gl_Position = worldViewProjection * vec4(position, 1);\n            vUV = uv;\n        }\n      ",o.Effect.ShadersStore.customFragmentShader="\n        precision highp float;\n                \n        uniform float iTime;\n        uniform vec2 iResolution;\n        uniform float[30] iColors;\n\n        // const vec2 iResolution = vec2(512, 512);\n        \n        struct RadialGradient {\n            float radius;\n            vec4 color;\n            vec2 point;\n        };\n      \n        void main(void) {\n            float w = iResolution.x / 2.;\n            float h = iResolution.y / 2.;\n      \n            float fill = max(iResolution.x, iResolution.y);\n            // float contain = min(iResolution.x, iResolution.y);\n\n            vec4 colors[] = vec4[](\n                vec4(iColors[0],iColors[1],iColors[2], .7),\n                vec4(iColors[3],iColors[4],iColors[5], .7),\n                vec4(iColors[6],iColors[7],iColors[8], .7),\n                vec4(iColors[9],iColors[10],iColors[11], .7),\n                vec4(iColors[12],iColors[13],iColors[14], .7),\n                vec4(iColors[15],iColors[16],iColors[17], .7),\n                vec4(iColors[18],iColors[19],iColors[20], .7),\n                vec4(iColors[21],iColors[22],iColors[23], .7),\n                vec4(iColors[24],iColors[25],iColors[26], .7),\n                vec4(iColors[27],iColors[28],iColors[29], .7)\n            );\n      \n            // gradients\n            RadialGradient gradients[] = RadialGradient[](\n                RadialGradient(1.0, colors[0], vec2(0.5 * w * sin(.13 * iTime - 0.44) + w, 0.5 * h * sin(.34 * iTime - 2.41) + h)),\n                RadialGradient(1.0, colors[1], vec2(0.5 * w * sin(.93 * iTime - 5.58) + w, 1.0 * h * sin(.82 * iTime - 3.04) + h)),\n                RadialGradient(1.0, colors[2], vec2(1.0 * w * sin(.45 * iTime - 2.70) + w, 0.5 * h * sin(.94 * iTime - 5.24) + h)),\n                RadialGradient(1.0, colors[3], vec2(1.0 * w * sin(.15 * iTime - 3.59) + w, 1.0 * h * sin(.96 * iTime - 5.11) + h)),\n                RadialGradient(1.0, colors[4], vec2(0.5 * w * sin(.35 * iTime - 4.73) + w, 0.5 * h * sin(.42 * iTime - 3.87) + h)),\n                RadialGradient(1.0, colors[5], vec2(0.5 * w * sin(.62 * iTime - 4.81) + w, 1.0 * h * sin(.19 * iTime - 1.17) + h)),\n                RadialGradient(1.0, colors[6], vec2(1.0 * w * sin(.58 * iTime - 5.13) + w, 0.5 * h * sin(.10 * iTime - 2.08) + h)),\n                RadialGradient(0.5, colors[7], vec2(1.5 * w * sin(.12 * iTime - 4.36) + w * 2., 0.5 * h * sin(.08 * iTime - 1.48) + h * 2.)),\n                RadialGradient(0.6, colors[8], vec2(1.5 * w * sin(.07 * iTime - 3.94) + w * 2., 0.6 * h * sin(.03 * iTime - 2.03) + h * 2.)),\n                RadialGradient(0.5, colors[9], vec2(1.5 * w * sin(.01 * iTime - 3.74) + w * 2., 0.5 * h * sin(.12 * iTime - 0.62) + h * 2.))\n            );\n      \n            vec3 color = vec3(0.);\n      \n            for(int i = 0; i < gradients.length(); ++i) {\n                color = mix(\n                    gradients[i].color.rgb,\n                    color,\n                    gradients[i].color.a * distance(gradients[i].point, gl_FragCoord.xy) / ( fill * gradients[i].radius)\n                );\n            }\n      \n            gl_FragColor = vec4(color,1.0);\n        }\n      ";var n=new o.ShaderMaterial("shader",Wn,{vertex:"custom",fragment:"custom"},{attributes:["position","normal","uv"],uniforms:["worldViewProjection","time","resolution","gridSize","colors","gridColors"]});n.setFloat("time",performance.now()),n.setVector3("resolution",new o.Vector3(window.innerWidth,window.innerHeight,0)),n.backFaceCulling=!1;var a=o.MeshBuilder.CreatePlane(At,{size:1},Wn);a.uniqueId=parseFloat(At),a.material=n;var r=Lt();return a.material.setColor3Array("colors",r.map((function(e){var t=e.color,n=t[0],a=t[1],r=t[2];return new o.Color3(n,a,r)}))),Ut(t)},update:function(e){var t=e.state;return e.component,Ut(t)},tick:function(e){var t=e.state,n=e.component,a=Wn.getMeshByUniqueId(parseFloat(At));return a&&a.material&&(a.material.setFloat("iTime",performance.now()/1e3+n.gradientTime),a.material.setVector2("iResolution",new o.Vector2(window.innerWidth,window.innerHeight)),a.material.setFloats("iColors",Ze.flat())),t}})}(t=function(e){return C({state:e,name:a.uiText,create:function(e){var t=e.state,n=e.component;return qn({component:n}),t},update:function(e){var t=e.state,n=e.component;return zn({entity:n.entity}),qn({component:n}),t},remove:function(e){var t=e.state,n=e.component;return zn({entity:n.entity}),t}})}(t=function(e){return C({state:e,name:a.uiImage,create:function(e){var t=e.state,n=e.component,a=new BABYLON.GUI.Image(n.entity,n.url);return Rn({element:n,babylonElement:a,scene:Wn}),null==Bt||Bt.addControl(a),t},remove:function(e){var t=e.state,n=e.component,a=Un({entity:n.entity});return a&&a.dispose(),t}})}(t=function(e){return C({state:e,name:a.uiButton,create:function(e){var t,n,a,r,o,i=e.state,c=e.component,s=BABYLON.GUI.Button.CreateSimpleButton(c.entity,c.text);return Rn({element:c,babylonElement:s,scene:Wn}),s.color=null!==(t=c.color)&&void 0!==t?t:"white",s.cornerRadius=null!==(n=c.cornerRadius)&&void 0!==n?n:0,s.background=null!==(a=c.background)&&void 0!==a?a:"transparent",s.fontSize=null!==(r=c.fontSize)&&void 0!==r?r:30,s.isPointerBlocker=null===(o=c.isPointerBlocker)||void 0===o||o,null==Bt||Bt.addControl(s),i},update:function(e){var t=e.state,n=e.component,a=Un({entity:n.entity});return a&&a.textBlock&&(a.textBlock.text=n.text),t},remove:function(e){var t=e.state,n=e.component,a=Un({entity:n.entity});return a&&a.dispose(),t}})}(t=function(e){return C({state:e,name:a.ui,create:function(e){var t=e.state;return e.component,Bt=BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI("ui",!0,Wn),t=Mt({advancedTexture:Bt,state:t}),Et({state:t,advancedTexture:Bt,attachEvents:!0})},update:function(e){var t=e.state,n=e.component;return Bt&&(n.cleanControls?(t=Mt({advancedTexture:Bt,state:t}),t=St({state:t,data:{cleanControls:!1}}),t=Et({state:t,advancedTexture:Bt,attachEvents:!0})):t=Et({state:t,advancedTexture:Bt,attachEvents:!1})),t}})}(t=function(e){return C({state:e,name:a.camera,create:function(e){var t=e.state,n=e.component;return Kt({state:t,data:n})},update:function(e){var t=e.state;return t=Rt({state:t,data:{}}),Qt({state:t,data:{}})},event:function(e){var t=e.state,n=e.component,a=e.event;switch(a.type){case it.Type.resize:return function(e){var t=e.state;return Kt({state:t,data:e.component})}({state:t,component:n,event:a})}}})}(t=function(e){return C({state:e,name:a.marker,create:function(e){var t,n,a=e.state,r=e.component,i=o.Mesh.CreatePlane(dn,1.4,Wn,!0);return i.uniqueId=parseInt(r.entity),i.position=new o.Vector3(9999,9999,9999),i.material=new o.StandardMaterial("material",Wn),i.material.useAlphaFromDiffuseTexture=!0,Ne({mesh:i,color:[1,1,1],texture:un,scene:Wn}),i.material.diffuseTexture.hasAlpha=!0,i.animations[0]=(t=new o.Animation("getScaleAnimation","scaling",1,o.Animation.ANIMATIONTYPE_VECTOR3,o.Animation.ANIMATIONLOOPMODE_RELATIVE),(n=[]).push({frame:0,value:new o.Vector3(2,2,1)}),n.push({frame:.5,value:new o.Vector3(.9,.9,1)}),t.setKeys(n),t),i.animations[1]=function(){var e=new o.Animation("getAlphaAnimation","material.alpha",1,o.Animation.ANIMATIONTYPE_FLOAT,o.Animation.ANIMATIONLOOPMODE_RELATIVE),t=[];return t.push({frame:0,value:1}),t.push({frame:.5,value:0}),e.setKeys(t),e}(),a},update:function(e){var t=e.state,n=e.component,a=Wn.getMeshByUniqueId(parseInt(dn));return a&&(a.material.diffuseColor=new o.Color3(n.color[0],n.color[1],n.color[2]),Wn.beginAnimation(a,0,1,!1),a.position.x=n.position[0],a.position.y=n.position[1],a.position.z=-1),t}})}(t=Mn(t))))))))),t=v({state:t,data:{entity:Dn,name:a.ai,human:!0,level:bn.hard,color:[0,0,1],textureSet:["","","","","","",""],active:!0}}),t=v({state:t,data:{version:n,newVersionAvailable:!1,entity:hn,name:a.game,grid:[],round:0,currentPlayer:Dn,gameStarted:!1,playersQueue:[],boxRotationQueue:[],colorBlindMode:!1,customLevelSettings:{players:Lt().slice(0,8),difficulty:bn.easy,quickStart:!0,mapType:""},musicEnabled:!1}}),t=v({state:t,data:{entity:wt,name:a.ui,type:y.mainMenu,cleanControls:!1}}),t=v({state:t,data:Nn({entity:Dt,name:a.camera,position:[0,0],distance:5},Jt(5,Wn))}),t=v({state:t,data:{entity:dn,name:a.marker,color:[1,1,1],position:[0,0]}}),t=v({state:t,data:{entity:At,name:a.background,gradientTime:500*Math.random()}});var r=JSON.parse(localStorage.getItem(tt)||"null"),i=null===(e=On({state:r||x}))||void 0===e?void 0:e.version;return r&&i===n&&(t=Nn(Nn({},t),{entity:r.entity,component:r.component})),nt(),t}();Wn.registerBeforeRender((function(){Kn=function(e){var t=e.state;c="second",u={};var n=t.system.concat().sort((function(e,t){return e>t?-1:1})).reduce((function(e,t){return t.tick({state:e,eventBuffer:s})}),t);return s={},c="first",s=i({},u),n}({state:Kn})})),window.addEventListener("resize",(function(){l({type:it.Type.resize,entity:Dt,payload:{}}),_n.resize()}))}},e=>{e.O(0,[216],(()=>(433,e(e.s=433)))),e.O()}]);