"use strict";(self.webpackChunkkostki=self.webpackChunkkostki||[]).push([[179],{6821:(e,t,n)=>{n.d(t,{$:()=>pa});var a,r,o,i,s,l,c=n(7101);(l=a||(a={})).box="box",l.ai="ai",l.game="game",l.marker="marker",l.background="background",l.logo="logo",function(e){e.mainMenu="mainMenu",e.customLevel="customLevel",e.customLevelSettings="customLevelSettings"}(r||(r={})),function(e){e.mainMenu="mainMenu",e.customLevel="customLevel",e.customLevelSettings="customLevelSettings"}(o||(o={})),function(e){e.disabled="disabled",e.random="random",e.easy="easy",e.medium="medium",e.hard="hard"}(i||(i={})),function(e){e[e.less=-1]="less",e[e.equal=0]="equal",e[e.more=1]="more"}(s||(s={}));var u=n(4804),d=n(4357),f={},p=function(e){var t=e.textureUrl,n=e.scene,a=new d.x(t,n,void 0,void 0,d.x.NEAREST_NEAREST_MIPLINEAR);return f[t]=a,a};const m=n.p+"57365b6b32a38acad399fa24be970b62.png",y=n.p+"86711768640182ba9774e66c59e43713.png",v=n.p+"d5fd50f6577249e4bd0a6cedc07b855c.png",g=n.p+"1cece826ef3290f02e8ab121defa70e5.png",h=n.p+"04486ea103fd49156ce128e43c00f4af.png",b=n.p+"4c8888485f10730f523694c6ac7449e4.png",w=n.p+"3bb45fa09a5eb9cd805c7f32aab31591.png",x=n.p+"289b33e3a3e1c125f813747944282bbb.png",T=n.p+"e7015b6db11decc2aa7f722b6eaaa343.png",C=n.p+"7e6aabd8e3d92edca81c0207761816f0.png",E=n.p+"1a202abfbdfbb945f566e890f0e0fa7f.png",P=n.p+"ad7c3be816ce34c76152ecc6c61d263b.png",S=n.p+"8711d0d55135c6a04bf3e76aa6287504.png",M=n.p+"717e6eb5fb82bedfc88f6dc0c65b6f12.png",k=n.p+"16c7f9cc6c2acada16547b3befe94a91.png",L=n.p+"2d2b2519ce6d9ed0c93cd7ed21aed043.png",R=n.p+"7fa7abdc3e479f97ee5f6b283630df03.png",j=n.p+"f3941c38549dddc4a8cb586591e36996.png",O=n.p+"62bd7e3778d77e5ca308fcb5f4b0da78.png",I=n.p+"2f30a46bdc58014e8ba857f895bbe5b8.png",B=n.p+"de0b87223c2e5708366657b7da01c941.png",q=n.p+"54b2699e76fca159c5797b2b93b10bd4.png",G=n.p+"3d713800c02422e02fe02e70f53e9771.png",U=n.p+"2f9682e3f7d362cc3087ef4dcbbdfd2b.png",A=n.p+"62f6adca2ae3c6e088aac66bc47cb54e.png",F=n.p+"9bb2d886948bbd78603ec224904774fd.png",W=n.p+"2d9f8ec02b7087dc45bf61208aacf7a8.png",V=n.p+"4fd5888696b352601fd6c1f7a1420e1f.png",Q=n.p+"d62f41f971620bf90529571efed25c8e.png",z=n.p+"2c7434786497b8ccb02757089a53015a.png",D=n.p+"51f16b6b18086fcc295f8bc02e6c8c45.png",N=n.p+"0dfd6a6b5e5120be13c81ddc1d84a1df.png",X=n.p+"301a367840edef78b86808852d0c067e.png",H=n.p+"d854a7c9f810ebe5be07e17990bd0ee4.png",$=n.p+"777079c111d24a4a0402f5afbc95b175.png",_=n.p+"e1b39772fd20282e80743b1f04be6795.png",K=n.p+"24075b75ce25b7869e6559cccca76b75.png",Y=n.p+"698b6e6ce4fcc13dd8ac2cdb9bb484fe.png",Z=n.p+"38ca2b18556222743ee8778742514d73.png",J=n.p+"aebe569c1bf5190e0038b7098791359c.png",ee=n.p+"d1390ce752b5ee52126d21de796a81f8.png",te=n.p+"d54421100963619575d7b3f35876fdfe.png",ne=n.p+"cde379b0a92320968a3826f29eff20fc.png",ae=n.p+"d1b88dc4aa017270afbb48ce8c2d93ee.png",re=n.p+"f07f0db4072406727dc668f8f643b725.png",oe=n.p+"f60fcf550b1112ec6a6bb8c80cc4b142.png",ie=n.p+"5fded717b6adc588c2dcdedd900f3bea.png",se=n.p+"ed032e786ebb26ea79c773fd85684876.png",le=n.p+"7960efbc05f46d226a4e232b391a79ea.png";var ce,ue=[m,y,v,g,h,b,w],de=[m,x,T,C,E,P,S],fe=[m,M,k,L,R,j,O],pe=[m,I,B,q,G,U,A],me=[m,F,W,V,Q,z,D],ye=[m,N,X,H,$,_,K],ve=[m,Y,Z,J,ee,te,ne],ge=[m,ae,re,oe,ie,se,le],he=function(e){var t=e.state,n=t.babylonjs.sceneRef;return n?(function(e){setTimeout((function(){ue.forEach((function(t){var n=new Image;n.src=t,n.onload=function(){p({textureUrl:t,scene:e})}}))}),2e3*Math.random()+1e3)}(n),t):t},be="game";!function(e){var t;(t=e.Type||(e.Type={})).startCustomLevel="GameEvent-startCustomLevel",t.boxExplosion="GameEvent-boxExplosion",t.playerClick="GameEvent-playerClick",t.cleanScene="GameEvent-cleanScene",t.shakeAiBoxes="GameEvent-shakeAiBoxes",t.playAgainCustomLevel="GameEvent-playAgainCustomLevel",t.changePlayers="GameEvent-changePlayers",t.changeDifficulty="GameEvent-changeDifficulty",t.changeQuickStart="GameEvent-changeQuickStart",t.changeColorBlindMode="GameEvent-changeColorBlindMode",t.changeMapType="GameEvent-changeMapType",t.showNewVersion="GameEvent-showNewVersion",t.reload="GameEvent-reload"}(ce||(ce={}));var we,xe=(0,u.om)({entity:be,name:a.game}),Te=xe.getComponent,Ce=xe.setComponent,Ee=n(2922),Pe=function(e){var t=e.mesh,n=e.texture,a=e.scene,r=e.color;r&&(t.material.diffuseColor=new Ee.Wo(r[0],r[1],r[2]));var o=function(e){var t=e.textureUrl,n=e.scene;return f[t]?f[t]:p({textureUrl:t,scene:n})}({textureUrl:n,scene:a});return t.material.diffuseTexture=o,o},Se=function(e){var t=e.state,n=e.ai,a=Te({state:t});return n&&(null==a?void 0:a.colorBlindMode)?n.textureSet:ue},Me=n(9028),ke=function(){return(ke=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Le=function(e){return e>2*Math.PI||e<-2*Math.PI?-2*Math.PI:e},Re=Math.PI/2,je=function(e){var t=e.boxUniqueId,n=e.direction,r=void 0===n?_t.random:n,o=e.color,i=e.texture,s=e.state,l=e.nextTurn,c=s.babylonjs.sceneRef;if(!c)return s;var d=c.getTransformNodeByUniqueId(parseInt(t)),f=(0,u.Xr)({state:s,name:a.box,entity:t});if(d&&f){s=(0,u.we)({state:s,data:ke(ke({},f),{isAnimating:!0})});var p=Re*(Math.random()>.5?1:-1),m=Math.random()>.5?"x":"y";switch(r){case _t.down:p=-1*Re,m="x";break;case _t.up:p=1*Re,m="x";break;case _t.right:p=-1*Re,m="y";break;case _t.left:p=1*Re,m="y";break;case _t.random:p=Re*(Math.random()>.5?1:-1),m=Math.random()>.5?"x":"y"}d.rotation.z=0;var y=[d.rotation.x,d.rotation.y,d.rotation.z],v=["x"===m?p:0,"y"===m?p:0,y[2]],g=[Le(v[0]+y[0]),Le(v[1]+y[1]),Le(v[2]+y[2])],h={type:Kt.Type.rotationEnd,payload:{boxEntity:f.entity,texture:i,color:o,nextTurn:l}};s=(0,u.we)({state:s,data:{name:u.fm.animation,entity:t,isPlaying:!0,isFinished:!1,currentTime:0,wrapMode:Me.f.WrapMode.once,timingMode:Me.f.TimingMode.smooth,properties:[{path:"rotation",component:u.fm.transform,entity:t,keyframes:[{duration:500,timingFunction:"Linear",valueRange:[y,g],endFrameEvent:h}]}]}});var b=d.getChildren();b.slice(1,b.length).forEach((function(e){var t=c.getMeshByUniqueId(e.uniqueId);t&&Pe({mesh:t,color:o,texture:i,scene:c})}))}return s},Oe=function(){return(Oe=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Ie=function(){return(Ie=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Be=function(e,t,n){return e&&e[n]?e[n][t]:void 0},qe=function(e){return[e[1][0],e[0][1],e[1][2],e[2][1]]},Ge=function(e,t){var n=t[0],a=t[1];return[[Be(e,a-1,n-1),Be(e,a,n-1),Be(e,a+1,n-1)],[Be(e,a-1,n),Be(e,a,n),Be(e,a+1,n)],[Be(e,a-1,n+1),Be(e,a,n+1),Be(e,a+1,n+1)]]},Ue=function(){return(Ue=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Ae=function(e){var t=e.state,n=Te({state:t});return n?n.grid.reduce((function(e,n){var r=(0,u.Xr)({name:a.box,state:t,entity:n});if(r){var o=r.gridPosition[0],i=r.gridPosition[1];e[o]||(e[o]=[]),e[o][i]=Ue(Ue({},r),{points:0})}return e}),[]):[]},Fe=function(){return(Fe=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},We=function(e,t){for(var n=0,a=t.length,r=e.length;n<a;n++,r++)e[r]=t[n];return e},Ve=function(e){var t=e.entity,n=e.state,a=Te({state:n});return a?(0,u.we)({state:n,data:Fe(Fe({},a),{boxRotationQueue:We(We([],a.boxRotationQueue),[t])})}):n},Qe=function(){return(Qe=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},ze=function(e){return 6===e?1:e+1},De=function(e){var t=e.state,n=e.ai,a=e.box,r=(Te({state:t}),a.entity),o=a.dots;return n&&(o=ze(a.dots),t=je({state:t,boxUniqueId:r,texture:Se({state:t,ai:n})[o],color:n.color,nextTurn:!0}),t=Ve({entity:r,state:t})),(0,u.we)({state:t,data:Qe(Qe({},a),{isAnimating:!0,player:(null==n?void 0:n.entity)||"",dots:o})})},Ne=n(453),Xe=function(e){var t=e.value,n=e.min,a=e.max;return t<=n?n:t>=a?a:t},He=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},$e=[1,1,1],_e=[.6,.6,.6],Ke=[.11,.79,.29],Ye=[.09,.84,1],Ze=[1,.73,.29],Je=[.99,.97,.32],et=[.99,.42,.45],tt=[.99,.47,.94],nt=[.67,.23,.94],at=function(e,t){return e+Math.random()*t-Math.random()*t},rt=function(e){var t=function(e){var t,n,a=e[0],r=e[1],o=e[2],i=Math.max(a,r,o),s=Math.min(a,r,o),l=(i+s)/2;if(i==s)t=n=0;else{var c=i-s;switch(n=l>.5?c/(2-i-s):c/(i+s),i){case a:t=(r-o)/c+(r<o?6:0);break;case r:t=(o-a)/c+2;break;case o:t=(a-r)/c+4}t/=6}return[t,n,l]}(e),n=[t[0],Xe({value:at(t[1],.2),min:.3,max:1}),Xe({value:at(t[2],.2),min:.3,max:.7})];return function(e){var t,n,a,r=e[0],o=e[1],i=e[2];if(0==o)t=n=a=i;else{var s=i<.5?i*(1+o):i+o-i*o,l=2*i-s;t=He(l,s,r+1/3),n=He(l,s,r),a=He(l,s,r-1/3)}return[t,n,a]}([n[0],n[1],n[2]])},ot=function(e){return[rt(e),rt(e),rt(e),rt(e),rt(e),rt(e),rt(e),rt(e),rt(e),rt(e)]},it=(ot(_e),ot(Ke),ot(Ye)),st=(ot(Ze),ot(Je),ot(et),ot(tt),ot(nt),n(4442)),lt=n(7112),ct=n(5412),ut=n(8084),dt=function(e,t){document.dispatchEvent(new CustomEvent(e,{detail:t}))},ft="localDbKey",pt=function(e){var t=Te({state:e});t&&mt({players:t.customLevelSettings.players,difficulty:t.customLevelSettings.difficulty,quickStart:t.customLevelSettings.quickStart,mapType:t.customLevelSettings.mapType,colorBlindMode:t.colorBlindMode})},mt=function(e){localStorage.setItem(ft,JSON.stringify(e))},yt=function(){return(yt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},vt=function(e,t,n,r,o){return void 0===r&&(r=!1),void 0===o&&(o=i.easy),{entity:e,name:a.ai,human:r,level:o,color:t,textureSet:n,active:!0}},gt=function(){return[vt(pa,Ye,ue,!0,i.easy),vt("2",et,de,!1,i.easy),vt("3",Ke,fe,!1,i.easy),vt("4",Je,pe,!1,i.easy),vt("5",Ze,me,!1,i.easy),vt("6",tt,ye,!1,i.easy),vt("7",_e,ve,!1,i.easy),vt("8",nt,ge,!1,i.easy)]},ht=function(e,t){var n=function(e){var t=e.getEngine().getRenderingCanvasClientRect();return null!==t?t.height/t.width:1}(t);return n>1?{left:-e,right:e,bottom:-e*n,top:e*n}:{bottom:-e,top:e,left:-e/n,right:e/n}},bt=function(e){if(e.babylonjs.sceneRef){var t=e.babylonjs.sceneRef.getMeshByUniqueId(parseFloat(xt)),n=(0,Ne.bp)({state:e});if(t&&n&&e.babylonjs.sceneRef){var a=ht(n.distance,e.babylonjs.sceneRef);t.position.x=n.position[0],t.position.y=n.position[1],t.scaling=new ct.P(Math.abs(a.left)+Math.abs(a.right),Math.abs(a.bottom)+Math.abs(a.top),1)}}return e},wt=function(e){var t=e.state;if(e.component,!t.babylonjs.sceneRef)return t;st.Q.ShadersStore.customVertexShader=" \n    precision highp float;\n    precision highp int;\n\n    // Attributes\n    attribute vec3 position;\n    attribute vec2 uv;\n\n    // Uniforms\n    uniform mat4 worldViewProjection;\n\n    // Varying\n    varying vec2 vUV;\n\n    void main(void) {\n        gl_Position = worldViewProjection * vec4(position, 1);\n        vUV = uv;\n    }\n  ",st.Q.ShadersStore.customFragmentShader="\n    precision highp float;\n    precision highp int;\n\n    uniform highp float iTime;\n    uniform vec2 iResolution;\n    uniform highp float[30] iColors;\n\n    // const vec2 iResolution = vec2(512, 512);\n    \n    struct RadialGradient {\n        float radius;\n        vec4 color;\n        vec2 point;\n    };\n  \n    void main(void) {\n        float w = iResolution.x / 2.;\n        float h = iResolution.y / 2.;\n  \n        float fill = max(iResolution.x, iResolution.y);\n        // float contain = min(iResolution.x, iResolution.y);\n\n        highp vec4 colors[10];\n        colors[0] = vec4(iColors[0],iColors[1],iColors[2], 0.7);\n        colors[1] = vec4(iColors[3],iColors[4],iColors[5], 0.7);\n        colors[2] = vec4(iColors[6],iColors[7],iColors[8], 0.7);\n        colors[3] = vec4(iColors[9],iColors[10],iColors[11], 0.7);\n        colors[4] = vec4(iColors[12],iColors[13],iColors[14], 0.7);\n        colors[5] = vec4(iColors[15],iColors[16],iColors[17], 0.7);\n        colors[6] = vec4(iColors[18],iColors[19],iColors[20], 0.7);\n        colors[7] = vec4(iColors[21],iColors[22],iColors[23], 0.7);\n        colors[8] = vec4(iColors[24],iColors[25],iColors[26], 0.7);\n        colors[9] = vec4(iColors[27],iColors[28],iColors[29], 0.7);\n        \n  \n        // gradients\n        RadialGradient gradients[] = RadialGradient[](\n            RadialGradient(1.0, colors[0], vec2(0.5 * w * sin(.13 * iTime - 0.44) + w, 0.5 * h * sin(.34 * iTime - 2.41) + h)),\n            RadialGradient(1.0, colors[1], vec2(0.5 * w * sin(.93 * iTime - 5.58) + w, 1.0 * h * sin(.82 * iTime - 3.04) + h)),\n            RadialGradient(1.0, colors[2], vec2(1.0 * w * sin(.45 * iTime - 2.70) + w, 0.5 * h * sin(.94 * iTime - 5.24) + h)),\n            RadialGradient(1.0, colors[3], vec2(1.0 * w * sin(.15 * iTime - 3.59) + w, 1.0 * h * sin(.96 * iTime - 5.11) + h)),\n            RadialGradient(1.0, colors[4], vec2(0.5 * w * sin(.35 * iTime - 4.73) + w, 0.5 * h * sin(.42 * iTime - 3.87) + h)),\n            RadialGradient(1.0, colors[5], vec2(0.5 * w * sin(.62 * iTime - 4.81) + w, 1.0 * h * sin(.19 * iTime - 1.17) + h)),\n            RadialGradient(1.0, colors[6], vec2(1.0 * w * sin(.58 * iTime - 5.13) + w, 0.5 * h * sin(.10 * iTime - 2.08) + h)),\n            RadialGradient(0.5, colors[7], vec2(1.5 * w * sin(.12 * iTime - 4.36) + w * 2., 0.5 * h * sin(.08 * iTime - 1.48) + h * 2.)),\n            RadialGradient(0.6, colors[8], vec2(1.5 * w * sin(.07 * iTime - 3.94) + w * 2., 0.6 * h * sin(.03 * iTime - 2.03) + h * 2.)),\n            RadialGradient(0.5, colors[9], vec2(1.5 * w * sin(.01 * iTime - 3.74) + w * 2., 0.5 * h * sin(.12 * iTime - 0.62) + h * 2.))\n        );\n  \n        vec3 color = vec3(0.);\n  \n        for(int i = 0; i < gradients.length(); ++i) {\n            color = mix(\n                gradients[i].color.rgb,\n                color,\n                gradients[i].color.a * distance(gradients[i].point, gl_FragCoord.xy) / ( fill * gradients[i].radius)\n            );\n        }\n  \n        gl_FragColor = vec4(color,1.0);\n    }\n  ";var n=new lt.j("shader",t.babylonjs.sceneRef,{vertex:"custom",fragment:"custom"},{attributes:["position","normal","uv"],uniforms:["worldViewProjection","time","resolution","gridSize","colors","gridColors"]});n.setFloat("time",performance.now()),n.setVector3("resolution",new ct.P(window.innerWidth,window.innerHeight,0)),n.backFaceCulling=!1;var a=ut.V.CreatePlane(xt,{size:1},t.babylonjs.sceneRef);a.uniqueId=parseFloat(xt),a.material=n;var r=gt();return a.material.setColor3Array("colors",r.map((function(e){var t=e.color,n=t[0],a=t[1],r=t[2];return new Ee.Wo(n,a,r)}))),bt(t)},xt="17818552155683748",Tt=(0,u.om)({entity:xt,name:a.background}),Ct=(Tt.getComponent,function(e){var t=e.percentage;return e.total*t}),Et=function(){return Math.floor(1e17*Math.random())},Pt=[[1,0,0,1,0,0,1,1,0,0,0,1,1,0,1,1,1,0,1,0,0,1,0,1],[1,0,1,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,1,0,1,0,0,1],[1,1,0,0,0,1,0,0,1,0,1,1,1,0,0,1,0,0,1,1,0,0,0,1],[1,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0,1],[1,0,0,1,0,0,1,1,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,1]].reduce((function(e,t,n){return e[n]=t.reduce((function(e,t,n){if(0===t)e[n]="";else{var a=Et().toString();e[n]=a}return e}),[]),e}),[]),St=function(){return(St=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Mt=function(e){var t=e.state;if(!t.babylonjs.sceneRef)return t;var n=(0,Ne.bp)({state:t});if(!n)return t;var a=function(e){var t=e.state,n=e.boxScaleFactor,a=(0,Ne.bp)({state:t});return a?{leftEdge:a.position[0]+a.left,topEdge:a.position[1]+a.top,boxSize:qt/n,screenSize:[2*a.right,2*a.top]}:{leftEdge:0,topEdge:0,boxSize:0,screenSize:[0,0]}}({state:t,boxScaleFactor:3.2}),r=a.topEdge,o=a.boxSize,i=a.screenSize,s=[Pt[0].length*o,Pt.length*o],l=[n.position[0]-s[0]/2,r-Ct({total:i[1],percentage:.1})];return Pt.reduce((function(e,t,n){return t.reduce((function(e,t,a){if(""===t)return e;var r=[l[0]+a*o,l[1]+-n*o],i=(0,u.Xr)({state:e,name:u.fm.transform,entity:t});return i?(0,u.we)({state:e,data:St(St({},i),{position:[r[0],r[1]],scale:[.3125,.3125,.3125]})}):e}),e)}),t)},kt=function(e){var t=e.state;return t.babylonjs.sceneRef?(t=Pt.reduce((function(e,t,n){return t.reduce((function(e,t,r){return""===t?e:(0,u.we)({state:e,data:{name:a.box,entity:t,isAnimating:!1,dots:0,gridPosition:[r,n],player:""}})}),e)}),t),t=Mt({state:t}),gn({type:we.Type.rotateRandomLogoBox,payload:{}}),t):t},Lt=function(e){var t=e.state,n=t.babylonjs.sceneRef;return n?(Pt.flat().forEach((function(e){var t=n.getTransformNodeByUniqueId(parseFloat(e));null==t||t.dispose()})),t):t},Rt="8523773494048061";!function(e){(e.Type||(e.Type={})).rotateRandomLogoBox="LogoEvent-rotateRandomLogoBox"}(we||(we={}));var jt=(0,u.om)({entity:Rt,name:a.logo}),Ot=jt.getComponent,It=function(){return(It=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Bt=function(e){var t=e.state,n=e.data,a=(0,Ne.bp)({state:t});return function(e){var t=e.state,n=e.data;return bt(t),Tt.setComponent({state:t,data:n})}({state:t=function(e){var t=e.state,n=e.data;return t=Mt({state:t}),jt.setComponent({state:t,data:n})}({state:t=(0,Ne.GR)({state:t,data:It(It({},a),n)}),data:{}}),data:{}})},qt=1.2,Gt={emptyBox:50,preferEmptyBoxes:15,advancedAttack:7,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:10,playerLessThanOponent:-10,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:-15,sixToSix:50,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:2,playerLessThanOponent:7,playerMoreThanPlayer:-5,playerEqualToPlayer:-4,playerLessThanPlayer:0,toBorder:0}},Ut={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:2,playerLessThanOponent:-2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:1,playerEqualToOponent:1,playerLessThanOponent:2,playerMoreThanPlayer:-1,playerEqualToPlayer:-1,playerLessThanPlayer:0,toBorder:0}},At={emptyBox:50,preferEmptyBoxes:15,advancedAttack:0,adjacted:{playerMoreThanOponent:0,playerEqualToOponent:0,playerLessThanOponent:-2,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:-2,sixToSix:2,toBorder:0},diagonall:{playerMoreThanOponent:5,playerEqualToOponent:0,playerLessThanOponent:5,playerMoreThanPlayer:-2,playerEqualToPlayer:0,playerLessThanPlayer:0,toBorder:0}},Ft=function(){return(Ft=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Wt=function(){return(Wt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Vt=function(){return(Vt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Qt=function(e){var t,n=e.state,a=e.ai,r=e.preferEmptyBoxes,o=a.entity,l=(t={},t[i.disabled]=At,t[i.random]=At,t[i.easy]=At,t[i.medium]=Ut,t[i.hard]=Gt,t)[a.level],c=Ae({state:n});if(c=function(e){var t=e.dataGrid,n=e.currentPlayer,a=e.preferEmptyBoxes,r=e.aIGridPoints;return t.reduce((function(e,o,i){return e[i]=o.reduce((function(e,o,l){if(o.player!==n.entity&&void 0!==o.player)return e;var c=Ge(t,[i,l]),u=function(e){var t=e.grid3x3,n=e.preferEmptyBoxes,a=e.currentPlayer,r=e.aIGridPoints,o=t[1][1];return qe(t).reduce((function(e,t){if(!t)return e+r.adjacted.toBorder;var i=o.dots===t.dots?s.equal:o.dots>t.dots?s.more:s.less;if(t.player!==o.player&&void 0!==t.player){if(n&&void 0===o.player&&t.player===a.entity)return Math.random()>.5?e+r.preferEmptyBoxes:e;if(i===s.more){var l=o.dots-t.dots;return e+r.adjacted.playerMoreThanOponent-l}if(i===s.equal)return e+r.adjacted.playerEqualToOponent*o.dots;if(i===s.less)return l=o.dots-t.dots-t.dots,e+r.adjacted.playerLessThanOponent*Math.abs(l)}else{if(6===o.dots)return e;if(i===s.more)return e+r.adjacted.playerMoreThanPlayer;if(i===s.equal)return 6===t.dots&&6===o.dots?e+r.adjacted.sixToSix:e+r.adjacted.playerEqualToPlayer;if(i===s.less)return 6===t.dots?e+2*r.adjacted.playerLessThanPlayer:e+r.adjacted.playerLessThanPlayer}return e}),0)}({grid3x3:c,preferEmptyBoxes:a,currentPlayer:n,aIGridPoints:r})+function(e){var t=e.grid3x3,n=e.aIGridPoints,a=t[1][1];return function(e){return[e[0][0],e[0][2],e[2][0],e[2][2]]}(t).reduce((function(e,t){if(!t)return e+n.diagonall.toBorder;var r=a.dots===t.dots?s.equal:a.dots>t.dots?s.more:s.less;if(t.player!==a.player&&void 0!==t.player){if(r===s.more)return e+n.diagonall.playerMoreThanOponent;if(r===s.equal)return 6===t.dots?e+-10*n.diagonall.playerEqualToOponent:e+n.diagonall.playerEqualToOponent;if(r===s.less)return 6===t.dots?e+2*n.diagonall.playerLessThanOponent:e+n.diagonall.playerLessThanOponent}else{if(6===a.dots)return e;if(r===s.more)return e+n.diagonall.playerMoreThanPlayer;if(r===s.equal)return e+n.diagonall.playerEqualToPlayer;if(r===s.less){var o=t.dots-a.dots;return e+n.diagonall.playerLessThanPlayer+Math.pow(o,2)}}return e}),0)}({grid3x3:c,preferEmptyBoxes:a,currentPlayer:n,aIGridPoints:r});return e[l]=Ie(Ie({},o),{points:o.points+u}),e}),o),e}),t)}({currentPlayer:a,dataGrid:c=function(e){var t=e.dataGrid,n=e.aIGridPoints;return t.reduce((function(e,t,a){return e[a]=t.reduce((function(e,t,a){var r=void 0===t.player?t.points+n.emptyBox:t.points;return e[a]=Wt(Wt({},t),{points:r}),e}),t),e}),t)}({dataGrid:c,aIGridPoints:l}),preferEmptyBoxes:!!r,aIGridPoints:l}),!r)switch(a.level){case i.disabled:c=function(e){var t=e.dataGrid;return t.reduce((function(e,t,n){return e[n]=t.reduce((function(e,t,n){return e[n].player="-1",e}),t),e}),t)}({dataGrid:c});break;case i.random:c=function(e){var t=e.dataGrid,n=e.currentPlayer;return t.reduce((function(e,t,a){return e[a]=t.reduce((function(e,t,a){return t.player!==n||void 0===t.player||(e[a]=Vt(Vt({},t),{points:100*Math.random()})),e}),t),e}),t)}({dataGrid:c,currentPlayer:o});break;case i.hard:c=function(e){var t=e.dataGrid,n=e.currentPlayer;return t.reduce((function(e,a,r){return e[r]=a.reduce((function(e,a,o){if(a.player!==n)return e;var i=Ge(t,[r,o]),s=qe(i);if(s.some((function(e){return 6===(null==e?void 0:e.dots)})))return e;var l=s.reduce((function(e,r){if(!r)return e;var o=void 0!==r.player&&r.player!==n,i=a.dots>=r.dots;if(o&&i&&function(e){var t=e.currentPlayer,n=e.adjactedBox,a=e.dataGrid,r=e.position,o=r[0],i=r[1],s=Ge(a,[o,i]);return qe(s).every((function(e){return void 0===e||e.player===t||void 0===e.player||e.dots<=n.dots}))}({currentPlayer:n,adjactedBox:r,dataGrid:t,position:r.gridPosition})){var s=6/a.dots;e+=r.dots*Gt.advancedAttack/s}return e}),0);return e[o]=Ft(Ft({},a),{points:a.points+l}),e}),a),e}),t)}({dataGrid:c,currentPlayer:o})}return function(e){var t=e.currentPlayer,n=-1/0,a=[];e.dataGrid.forEach((function(e){e.forEach((function(e){var r=void 0===e.player,o=e.player===t;(r||o)&&(e.points>n&&(a=[]),e.points>=n&&(n=e.points,a.push(e)))}))}));var r=Math.floor(Math.random()*a.length);return a[r]}({currentPlayer:o,dataGrid:c})};const zt=n.p+"de1ab0613214552916d369d2014d1d95.png";var Dt,Nt=n(6666),Xt=n(5538),Ht="38127445920450264";!function(e){(e.Type||(e.Type={})).appearAnimationEnd="MarkerEvent-appearAnimationEnd"}(Dt||(Dt={}));var $t,_t,Kt,Yt=(0,u.om)({entity:Ht,name:a.marker}),Zt=(Yt.getComponent,function(e){var t=e.state,n=e.data;if(t.babylonjs.sceneRef){t=(0,u.KL)({state:t,name:u.fm.material,entity:Ht,update:function(e){return{diffuseColor:n.color?[n.color[0],n.color[1],n.color[2],0]:e.diffuseColor}}}),t=(0,u.KL)({state:t,entity:Ht,name:u.fm.transform,update:function(e){return{position:n.position?[n.position[0],n.position[1],-1]:e.position}}});var a={type:Dt.Type.appearAnimationEnd,payload:{}};t=(0,u.we)({state:t,data:{name:u.fm.animation,entity:Ht,isPlaying:!0,isFinished:!1,currentTime:0,wrapMode:Me.f.WrapMode.once,timingMode:Me.f.TimingMode.smooth,properties:[{path:"scale",component:u.fm.transform,entity:Ht,keyframes:[{duration:400,timingFunction:"Linear",valueRange:[[2,2,1],[.9,.9,1]],endFrameEvent:a}]},{path:"alpha",component:u.fm.material,entity:Ht,keyframes:[{duration:400,timingFunction:"Linear",valueRange:[0,1]}]}]}})}return Yt.setComponent({state:t,data:n})}),Jt=function(e){var t=e.playersQueue,n=e.index,r=e.state,o=(0,u.Xr)({state:r,name:a.ai,entity:t[n]});return(null==o?void 0:o.active)?o:Jt({playersQueue:t,index:n>=t.length?0:n+1,state:r})},en=function(e){var t=e.state,n=Te({state:t});if(n){var a=n.playersQueue.findIndex((function(e){return n.currentPlayer===e}));return Jt({playersQueue:n.playersQueue,index:a+1,state:t})}},tn=function(){return(tn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},nn=function(e){var t=e.state,n=e.ai,r=e.component;t=(0,u.we)({state:t,data:tn(tn({},n),{active:!1})});var o=(0,u.Ck)({state:t,name:a.ai});return 1===Object.values(o||{}).reduce((function(e,t){return t.active?e+1:e}),0)?(t=(0,u.we)({state:t,data:tn(tn({},r),{gameStarted:!1})}),dt("setUIState",t),t):t=an({state:t})},an=function(e){var t=e.state,n=Te({state:t});if(!n)return t;var r=n.gameStarted,o=n.boxRotationQueue;if(r&&0===o.length){var i=en({state:t});if(!i)return t;var s=(0,u.Xr)({name:a.ai,state:t,entity:i.entity});if(!s)return t;if(t=(0,u.we)({state:t,data:tn(tn({},n),{currentPlayer:s.entity,moves:n.moves+1})}),s.active)if(s.human)0===function(e){var t=e.state,n=e.ai,r=Te({state:t});return(null==r?void 0:r.grid.reduce((function(e,r){var o=(0,u.Xr)({state:t,name:a.box,entity:r});return(null==o?void 0:o.player)===n.entity?e+1:e}),0))||0}({state:t,ai:s})&&(t=nn({state:t,component:n,ai:s}));else{var l=Qt({state:t,ai:s});l?(t=Zt({state:t,data:{color:s.color,position:[l.gridPosition[0]*qt,l.gridPosition[1]*qt]}}),t=De({box:l,state:t,ai:s}),t=Ve({state:t,entity:l.entity})):t=nn({state:t,component:n,ai:s})}}return dt("setUIState",t),t},rn=function(){return(rn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},on=function(e){var t=e.state,n=e.event;return t=Ce({state:t,data:{page:n.payload.newPage,round:0,grid:[],currentPlayer:"",playersQueue:[],boxRotationQueue:[],gameStarted:!1}}),t=(0,u.V$)({name:a.box,state:t}),t=(0,u.V$)({name:a.ai,state:t}),t=(0,u.V$)({name:a.marker,state:t}),t=(0,u.V$)({name:a.background,state:t}),t=(0,u.V$)({name:a.logo,state:t}),t=sn({state:t,page:n.payload.newPage}),dt("setUIState",t),t},sn=function(e){var t=e.state;return e.page===o.mainMenu&&(t=(0,u.we)({state:t,data:{entity:Rt,name:a.logo}})),t},ln=function(){return(ln=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},cn=Math.PI/3,un=function(e){var t=e.gridMaxSideLength,n=e.maxTime,a=e.direction;return function(e){var r=0,o=_t.up;switch(a){case"down":r=(t-e[1])/t,o=_t.down;break;case"up":r=e[1]/t,o=_t.up;break;case"left":r=(t-e[0])/t,o=_t.left;break;case"right":r=e[0]/t,o=_t.right}return{timeout:Math.sin(r*cn)*n,boxRotationDirection:o}}},dn=function(e){var t=_t.up,n=[Math.abs(e[0]),Math.abs(e[1])],a=n[0]>n[1];return e[0]<0&&e[1]<0?t=a?_t.left:_t.down:e[0]>0&&e[1]<0?t=a?_t.right:_t.down:e[0]<0&&e[1]>0?t=a?_t.left:_t.up:e[0]>0&&e[1]>0&&(t=a?_t.right:_t.up),t},fn=function(e){var t=e.gridMaxSideLength,n=e.maxTime,a=e.direction;return function(e){var r=[t/2,t/2],o=[r[0]-e[0],r[1]-e[1]],i=Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2)),s=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)),l=0,c=_t.up;switch(a){case"center":l=s-i,c=dn([o[0],o[1]]);break;case"outside":l=i,c=dn([-o[0],-o[1]])}return{timeout:Math.sin(l/s*cn)*n,boxRotationDirection:c}}},pn=function(){return(pn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},mn=function(e,t){for(var n=0,a=t.length,r=e.length;n<a;n++,r++)e[r]=t[n];return e},yn=function(e){var t=e.state,n=e.game,r=function(e){var t=e.state,n=Ae({state:t}),a=n[0]?1.2*n[0].length:1,r=1.2*n.length;return{width:a,height:r,center:[(a-1-.2)/2,(r-1-.2)/2],cameraDistance:(a>r?a:r)/2+.2}}({state:t=function(e){var t=e.state,n=e.ai;t=(0,u.V$)({state:t,name:a.ai});var r=Te({state:t});return r&&(t=(0,u.we)({state:t,data:ln(ln({},r),{playersQueue:n.map((function(e){return e.entity}))})})),n.reduce((function(e,t){return(0,u.we)({state:e,data:t})}),t)}({state:t=Array.from({length:8}).reduce((function(e,t,n){return Array.from({length:8}).reduce((function(e,t,r){var o=Et().toString();e=(0,u.we)({state:e,data:{name:a.box,entity:o,isAnimating:!1,dots:0,gridPosition:[r,n],player:void 0}});var i=Te({state:e});return i?Ce({state:e,data:pn(pn({},i),{grid:mn(mn([],i.grid),[o])})}):e}),e)}),t),ai:n.customLevelSettings.players.map((function(e){return pn(pn({},e),{level:n.customLevelSettings.difficulty})}))})}),o=r.center,i=r.cameraDistance;return Bt({state:t,data:{position:[o[0],o[1]],distance:i}})},vn=function(e){var t,n,r=e.state,i=Te({state:r});if(!i)return r;r=yn({state:r,game:i}),r=Ce({state:r,data:{currentPlayer:null===(t=en({state:r}))||void 0===t?void 0:t.entity}});var s=Te({state:r});(null==s?void 0:s.customLevelSettings.quickStart)&&(r=function(e){var t=e.state,n=Te({state:t}),r=(null==n?void 0:n.grid.length)||1,o=r-r%((null==n?void 0:n.customLevelSettings.players.length)||1);return Array.from({length:2*o}).reduce((function(e){var t=Te({state:e}),n=(0,u.Xr)({state:e,name:a.ai,entity:(null==t?void 0:t.currentPlayer)||""});if(!t||!n)return e;var r=Qt({state:e,ai:n,preferEmptyBoxes:!0});if(!r)return e;e=(0,u.we)({state:e,data:pn(pn({},r),{player:n.entity,dots:ze(r.dots)})});var o=en({state:e});return(0,u.we)({state:e,data:pn(pn({},t),{currentPlayer:(null==o?void 0:o.entity)||""})})}),t)||t}({state:r})),function(e){var t=e.state,n=Te({state:t}),r=Math.sqrt((null==n?void 0:n.grid.length)||1)-1,o=2e3,i=[fn({gridMaxSideLength:r,maxTime:o,direction:"center"}),fn({gridMaxSideLength:r,maxTime:o,direction:"outside"}),un({gridMaxSideLength:r,maxTime:o,direction:"left"}),un({gridMaxSideLength:r,maxTime:o,direction:"right"}),un({gridMaxSideLength:r,maxTime:o,direction:"down"}),un({gridMaxSideLength:r,maxTime:o,direction:"up"})],s=i[Math.floor(i.length*Math.random())];null==n||n.grid.forEach((function(e){var n=(0,u.Xr)({state:t,entity:e,name:a.box}),r=(0,u.Xr)({state:t,entity:(null==n?void 0:n.player)||"",name:a.ai});if(n&&r){var o=s(n.gridPosition),i=o.timeout+500*Math.random();setTimeout((function(){gn({type:Kt.Type.rotateStart,payload:{color:r.color,texture:Se({state:t,ai:r})[n.dots],direction:o.boxRotationDirection,boxEntity:e}})}),i)}}))}({state:r}),r=Ce({state:r,data:{gameStarted:!0,page:o.customLevel}});var l=(0,u.Xr)({state:r,name:a.ai,entity:(null===(n=Te({state:r}))||void 0===n?void 0:n.currentPlayer)||""});if(l&&!l.human){var c=Qt({state:r,ai:l});c&&(r=De({box:c,state:r,ai:l}))}return r=(0,u.we)({state:r,data:{entity:Ht,name:a.marker,color:[1,1,1],position:[0,0]}}),dt("setUIState",r),l&&setTimeout((function(){var e;gn({type:ce.Type.shakeAiBoxes,payload:{moves:(null===(e=Te({state:r}))||void 0===e?void 0:e.moves)||0,ai:l}})}),2e3),r},gn=($t=(0,n(2802).t)({eventHandler:function(e){var t=e.state,n=e.event;switch(n.type){case Ne.tP.Type.resize:return function(e){return Bt({state:e.state,data:{}})}({state:t,event:n});case we.Type.rotateRandomLogoBox:return function(e){var t=e.state,n=t.babylonjs.sceneRef;if(!Ot({state:t})||!n)return t;var a,r,o,i=(a=Pt.flat().filter((function(e){return""!==e})))[Math.floor(a.length*Math.random())],s=(r=Math.floor(ue.length*Math.random()),ue[r]),l=(o=function(e,t){for(var n=0,a=t.length,r=e.length;n<a;n++,r++)e[r]=t[n];return e}([$e],gt().map((function(e){return e.color}))))[Math.floor(o.length*Math.random())];return t=je({state:t,boxUniqueId:i,texture:s,color:l,nextTurn:!1}),setTimeout((function(){gn({type:we.Type.rotateRandomLogoBox,payload:{}})}),500*Math.random()+500),t}({state:t,event:n});case ce.Type.startCustomLevel:return vn({state:t,event:n});case ce.Type.playerClick:return function(e){var t=e.state,n=e.event,r=Te({state:t});if(!r)return t;var o=r.currentPlayer,i=r.gameStarted,s=r.boxRotationQueue,l=(0,u.Xr)({state:t,name:a.box,entity:n.payload.boxEntity}),c=void 0===(null==l?void 0:l.player)||(null==l?void 0:l.player)===o;if(i&&0===s.length&&c){var d=(0,u.Xr)({name:a.ai,state:t,entity:o});l&&(null==d?void 0:d.human)&&(t=Zt({state:t,data:{color:d.color,position:[l.gridPosition[0]*qt,l.gridPosition[1]*qt]}}),t=De({box:l,state:t,ai:d}))}return t}({state:t,event:n});case ce.Type.cleanScene:return on({state:t,event:n});case ce.Type.changePlayers:return function(e){var t,n,a=e.state,r=Te({state:a});if(!r)return a;var o=8===(null===(t=r.customLevelSettings.players)||void 0===t?void 0:t.length)?2:(null===(n=r.customLevelSettings.players)||void 0===n?void 0:n.length)+1;return a=Ce({state:a,data:{customLevelSettings:yt(yt({},r.customLevelSettings),{players:gt().slice(0,o)})}}),dt("setUIState",a),pt(a),a}({state:t,event:n});case ce.Type.changeDifficulty:return function(e){var t,n=e.state,a=Te({state:n});if(!a)return n;var r=[i.easy,i.medium,i.hard],o=r.findIndex((function(e){return e===a.customLevelSettings.difficulty})),s=-1===o?r[0]:null!==(t=r[o+1])&&void 0!==t?t:r[0];return n=Ce({state:n,data:{customLevelSettings:yt(yt({},a.customLevelSettings),{difficulty:s})}}),dt("setUIState",n),pt(n),n}({state:t,event:n});case ce.Type.changeQuickStart:return function(e){var t=e.state,n=Te({state:t});return n?(t=Ce({state:t,data:{customLevelSettings:yt(yt({},n.customLevelSettings),{quickStart:!n.customLevelSettings.quickStart})}}),dt("setUIState",t),pt(t),t):t}({state:t,event:n});case ce.Type.changeColorBlindMode:return function(e){var t=e.state,n=Te({state:t});return n?(t=Ce({state:t,data:{colorBlindMode:!n.colorBlindMode}}),dt("setUIState",t),pt(t),t):t}({state:t,event:n});case ce.Type.changeMapType:return function(e){var t=e.state;return dt("setUIState",t),pt(t),t}({state:t,event:n});case ce.Type.showNewVersion:return function(e){return Ce({state:e.state,data:{newVersionAvailable:!0}})}({state:t,event:n});case ce.Type.reload:return function(e){var t=e.state;return window.location.reload(),t}({state:t,event:n});case ce.Type.shakeAiBoxes:return function(e){var t=e.state,n=e.event.payload,r=n.ai,o=(n.moves,Te({state:t}));return null==o||o.grid.forEach((function(e){var n=(0,u.Xr)({state:t,name:a.box,entity:e});(null==n?void 0:n.player)===r.entity&&(0,u.Xr)({state:t,name:u.fm.transform,entity:e})&&Math.PI})),t}({state:t,event:n});case ce.Type.playAgainCustomLevel:return t=on({state:t,event:{type:ce.Type.cleanScene,payload:{newPage:o.customLevel}}}),vn({state:t,event:{type:ce.Type.startCustomLevel,payload:{}}});case Kt.Type.rotationEnd:return function(e){var t=e.state,n=e.event,r=t.babylonjs.sceneRef,o=n.payload,i=o.boxEntity,s=o.texture,l=o.color,c=o.nextTurn,d=(0,u.Xr)({state:t,name:a.box,entity:i}),f=(0,u.Xr)({state:t,name:u.fm.transform,entity:i});if(!d||!r||!f)return t;t=function(e){var t=e.entity,n=e.state,a=Te({state:n});return a?(0,u.we)({state:n,data:Oe(Oe({},a),{boxRotationQueue:a.boxRotationQueue.filter((function(e){return e!==t}))})}):n}({entity:d.entity,state:t}),t=(0,u.we)({state:t,data:rn(rn({},f),{rotation:[0,0,0]})});var p=r.getTransformNodeByUniqueId(parseInt(d.entity));p&&p.getChildren().forEach((function(e){var t=r.getMeshByUniqueId(e.uniqueId);t&&Pe({mesh:t,color:l,texture:s,scene:r})})),t=(0,u.we)({state:t,data:rn(rn({},d),{isAnimating:!1})});var m=Te({state:t}),y=(0,u.Xr)({state:t,name:a.ai,entity:(null==d?void 0:d.player)||""});return c&&y&&m&&d&&(1===d.dots?t=function(e){var t=e.state,n=e.ai,a=e.box.gridPosition,r=a[0],o=a[1],i=Ae({state:t});return[Be(i,o,r-1),Be(i,o,r+1),Be(i,o-1,r),Be(i,o+1,r)].filter((function(e){return void 0!==e})).reduce((function(e,t,a){return e=De({ai:n,box:t,state:e}),Ve({entity:t.entity,state:e})}),t)}({state:t,box:d,ai:y}):0===m.boxRotationQueue.length&&(t=an({state:t}))),t}({state:t,event:n});case Kt.Type.rotateStart:return function(e){var t=e.event;return je({state:e.state,boxUniqueId:t.payload.boxEntity,texture:t.payload.texture,color:t.payload.color,direction:t.payload.direction,nextTurn:!1})}({state:t,event:n});case Dt.Type.appearAnimationEnd:return function(e){var t=e.state;return(0,u.KL)({state:t,entity:Ht,name:u.fm.transform,update:function(){return{position:[9999,9999,1]}}})}({state:t,event:n})}}})).emitEvent,hn=$t.eventSystem,bn=n(4179),wn=n(5367),xn=n(8125),Tn=n(9798),Cn=function(e){var t=e.state,n=e.component,r=t.babylonjs.sceneRef;if(!r)return t;var o=n.gridPosition,i=(0,u.Xr)({state:t,name:a.ai,entity:n.player||""});return t=(0,u.we)({state:t,data:{name:u.fm.transform,entity:n.entity,rotation:[0,0,0],fromParentRotation:[0,0,0],scale:[1,1,1],fromParentScale:[1,1,1],position:[o[0]*qt,o[1]*qt],fromParentPosition:[0,0]}}),function(e){var t=e.scene,n=e.name,a=e.uniqueId,r=e.color,o=e.state,i=e.ai,s=e.dots,l=e.isClickable,c=e.scaleFactor,u=1/(void 0===c?1:c),d=new bn.Y("box "+n,t);d.uniqueId=a,[[new ct.P(0,0,-u/2),new ct.P(0,0,0)],[new ct.P(-u/2,0,0),new ct.P(0,Math.PI/2,0)],[new ct.P(0,0,u/2),new ct.P(0,Math.PI,0)],[new ct.P(u/2,0,0),new ct.P(0,-Math.PI/2,0)],[new ct.P(0,u/2,0),new ct.P(Math.PI/2,0,0)],[new ct.P(0,-u/2,0),new ct.P(-Math.PI/2,0,0)]].forEach((function(e,n){var c=e[0],f=e[1],p=ut.V.CreatePlane("plane"+n,{size:u});p.parent=d,p.material=new wn.K("mat",t),Pe({mesh:p,color:r,texture:Se({state:o,ai:i})[s],scene:t}),p.material.alpha=1,p.position=c,p.rotation=f,l&&(p.actionManager=new xn.k(t),p.actionManager.registerAction(new Tn.fQ(xn.k.OnPickUpTrigger,(function(){gn({type:ce.Type.playerClick,payload:{boxEntity:a.toString()}})}))))}))}({scene:r,name:o[0]+"-"+o[1],position:[o[0]*qt,o[1]*qt],uniqueId:parseFloat(n.entity),color:(null==i?void 0:i.color)||[1,1,1],ai:i,dots:n.dots,state:t,isClickable:!0}),t},En=function(e){var t=e.state,n=e.component;if(t.babylonjs.sceneRef){var a=t.babylonjs.sceneRef.getTransformNodeByUniqueId(parseInt(n.entity));null==a||a.dispose()}return t};!function(e){e.up="up",e.down="down",e.left="left",e.right="right",e.random="random"}(_t||(_t={})),function(e){var t;(t=e.Type||(e.Type={})).onClick="BoxEvent-onClick",t.rotationEnd="BoxEvent-rotationEnd",t.rotateStart="BoxEvent-rotate"}(Kt||(Kt={}));var Pn=n(8074),Sn=function(){return(Sn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Mn=n(4155),kn=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ln(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}Mn.env.PUBLIC_URL="/kostki";var Rn,jn,On=n(3935),In=n(7294),Bn=n(6744),qn=(Rn=(0,Bn.Th)({theme:{colors:{outline:"#595cff"},space:{},fontSizes:{},fonts:{},fontWeights:{},lineHeights:{},letterSpacings:{},sizes:{},borderWidths:{},borderStyles:{},radii:{},shadows:{},zIndices:{modal:1},transitions:{}},media:{bp1:"(min-width: 1024px)"}})).styled,Gn=(Rn.css,qn("button",{border:"5px solid black",background:"white",padding:"20px 15px",fontSize:"1.5rem",whiteSpace:"nowrap",cursor:"pointer",transition:"0.2s transform",pointerEvents:"auto","&:hover":{transform:"scale(1.05)"},"&:focus":{transform:"scale(0.98)"}})),Un=qn("div",{display:"flex"}),An=qn("div",{display:"grid",maxWidth:"1920px",margin:"0 auto",padding:"0.5rem"}),Fn=qn("div",{color:"Black",fontSize:"1.5rem"}),Wn=void 0,Vn=function(){var e=(0,In.useState)(void 0),t=e[0],n=e[1];return(0,In.useEffect)((function(){var e=function(e){e&&(Wn=e,n(e))};return function(e,t){document.addEventListener("setUIState",(function(e){return t(e.detail)}))}(0,e),function(){!function(e,t){document.removeEventListener("setUIState",t)}(0,e)}}),[]),t||Wn},Qn=function(){var e=Vn(),t=e&&Te({state:e});return In.createElement(An,{css:{gridTemplateRows:"20% 70% 10%",gridTemplateColumns:"20% 60% 20%",flex:1}},In.createElement(Un,{css:{flexDirection:"column",justifyContent:"center",alignItems:"center",gridRow:"2 / 2",gridColumn:"2 / 3"}},In.createElement(Gn,{css:{maxWidth:"500px",width:"100%"},onClick:function(){gn({type:ce.Type.cleanScene,payload:{newPage:o.customLevelSettings}})}},"Start"),In.createElement(Gn,{css:{marginTop:"100px",maxWidth:"500px",width:"100%"},onClick:function(){gn({type:ce.Type.cleanScene,payload:{newPage:o.customLevelSettings}})}},"Custom Level")),In.createElement(Fn,{css:{flexDirection:"column",justifyContent:"center",gridRow:"3 / 4",gridColumn:"3 / 3",color:"white",fontSize:"1rem"}},null==t?void 0:t.version))},zn=function(e){var t;"Tab"===e.key&&(null===(t=document.body)||void 0===t||t.classList.add("enable-outline"))},Dn=function(){var e;null===(e=document.body)||void 0===e||e.classList.remove("enable-outline")},Nn=qn("div",{display:"grid"}),Xn=function(){return In.createElement("svg",{width:"40",height:"40",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{margin:"-9px"}},In.createElement("path",{d:"M11.4669 3.72684C11.7558 3.91574 11.8369 4.30308 11.648 4.59198L7.39799 11.092C7.29783 11.2452 7.13556 11.3467 6.95402 11.3699C6.77247 11.3931 6.58989 11.3355 6.45446 11.2124L3.70446 8.71241C3.44905 8.48022 3.43023 8.08494 3.66242 7.82953C3.89461 7.57412 4.28989 7.55529 4.5453 7.78749L6.75292 9.79441L10.6018 3.90792C10.7907 3.61902 11.178 3.53795 11.4669 3.72684Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))},Hn=function(){return In.createElement("svg",{width:"40",height:"40",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{margin:"-9px"}},In.createElement("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))},$n=function(){var e,t=Vn(),n=t&&Te({state:t});return n?In.createElement(An,{css:{gridTemplateRows:"3fr 1fr 1fr",gridTemplateColumns:"1fr 1fr",gridGap:"1rem",flex:1}},In.createElement(Un,{css:{flexDirection:"column",justifyContent:"center",gridRow:"1 / 1",gridColumn:"1 / 3"}},"Select level (todo)"),In.createElement(Nn,{css:{gridTemplateRows:"1fr 1fr 1fr 1fr",gridTemplateColumns:"1fr","@bp1":{gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr 1fr"},gridGap:"1rem",gridRow:"2 / 2",gridColumn:"1 / 3"}},In.createElement(Gn,{css:{display:"flex",justifyContent:"space-between",gridRow:"1 / 1",gridColumn:"1 / 1",alignSelf:"center"},onClick:function(){return gn({type:ce.Type.changeDifficulty,payload:{}})}},In.createElement("div",null,"Difficulty"),In.createElement("div",null,function(e){switch(e){case i.disabled:return"Disabled";case i.random:return"Random";case i.easy:return"Easy";case i.medium:return"Medium";case i.hard:return"Hard"}}(n.customLevelSettings.difficulty))),In.createElement(Gn,{css:{display:"flex",justifyContent:"space-between",gridRow:"2 / 2",gridColumn:"1 / 1",alignSelf:"center","@bp1":{gridRow:"1 / 1",gridColumn:"2 / 2"}},onClick:function(){return gn({type:ce.Type.changePlayers,payload:{}})}},In.createElement("div",null,"Players"),In.createElement("div",null,null===(e=n.customLevelSettings.players)||void 0===e?void 0:e.length)),In.createElement(Gn,{css:{display:"flex",justifyContent:"space-between",gridRow:"3 / 3",gridColumn:"1 / 1",alignSelf:"center","@bp1":{gridRow:"2 / 2",gridColumn:"1 / 1"}},onClick:function(){return gn({type:ce.Type.changeQuickStart,payload:{}})}},In.createElement("div",null,"Quick Start"),In.createElement("div",null,n.customLevelSettings.quickStart?In.createElement(Xn,null):In.createElement(Hn,null))),In.createElement(Gn,{css:{display:"flex",justifyContent:"space-between",gridRow:"4 / 4",gridColumn:"1 / 1",alignSelf:"center","@bp1":{gridRow:"2 / 2",gridColumn:"2 / 2"}},onClick:function(){return gn({type:ce.Type.changeColorBlindMode,payload:{}})}},In.createElement("div",null,"Color Blind Mode"),In.createElement("div",null,n.colorBlindMode?In.createElement(Xn,null):In.createElement(Hn,null)))),In.createElement(Un,{css:{flexDirection:"column",justifyContent:"center",gridRow:"3 / 3",gridColumn:"1 / 1"}},In.createElement(Gn,{onClick:function(){return gn({type:ce.Type.cleanScene,payload:{newPage:o.mainMenu}})}},"Back")),In.createElement(Un,{css:{flexDirection:"column",justifyContent:"center",gridRow:"3 / 3",gridColumn:"2 / 2"}},In.createElement(Gn,{onClick:function(){return gn({type:ce.Type.startCustomLevel,payload:{}})}},"Start"))):null},_n=function(){return In.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},In.createElement("path",{d:"M1.5 3C1.22386 3 1 3.22386 1 3.5C1 3.77614 1.22386 4 1.5 4H13.5C13.7761 4 14 3.77614 14 3.5C14 3.22386 13.7761 3 13.5 3H1.5ZM1 7.5C1 7.22386 1.22386 7 1.5 7H13.5C13.7761 7 14 7.22386 14 7.5C14 7.77614 13.7761 8 13.5 8H1.5C1.22386 8 1 7.77614 1 7.5ZM1 11.5C1 11.2239 1.22386 11 1.5 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7761 13.7761 12 13.5 12H1.5C1.22386 12 1 11.7761 1 11.5Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))},Kn=qn("div",{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"auto"}),Yn=qn("div",{border:"5px solid black",background:"white"}),Zn=function(e){var t=e.children,n=e.css;return In.createElement(Kn,null,In.createElement(Yn,{css:n},t))},Jn=function(e){var t=e.ai;return In.createElement(Un,{css:{flexDirection:"column"}},t.map((function(e){var t=e.entity,n=e.name,a=e.color,r=e.hasCurrentTurn,o=e.active;return In.createElement(Un,{key:t,css:{alignItems:"center",padding:"0.125rem",paddingRight:"1rem",backgroundColor:r?"rgba(255,255,255,0.6)":""}},In.createElement(Un,{css:{position:"relative",width:"0.5rem",height:"0.5rem",border:"0.125rem solid black","@bp1":{width:"2rem",height:"2rem",border:"0.25rem solid black"},marginRight:"0.5rem",backgroundColor:"rgb("+255*a[0]+", "+255*a[1]+", "+255*a[2]+")"}}),In.createElement(Fn,{css:{fontSize:"0.75rem",textDecoration:o?"":"line-through","@bp1":{fontSize:"1.5rem"}}},n))})))},ea=function(e){var t=e.onClose;return In.createElement(Zn,{css:{width:"70%",height:"40%",display:"flex",flexDirection:"column",justifyContent:"space-around"}},In.createElement(Fn,{css:{textAlign:"center"}},"Are you sure you want to finish the game?"),In.createElement(Un,{css:{justifyContent:"space-evenly"}},In.createElement(Gn,{onClick:function(){t(!1)}},"No"),In.createElement(Gn,{onClick:function(){gn({type:ce.Type.cleanScene,payload:{newPage:o.mainMenu}})}},"Yes")))},ta=function(){return In.createElement(Zn,{css:{width:"70%",height:"40%",display:"flex",flexDirection:"column",justifyContent:"space-around"}},In.createElement(Fn,{css:{textAlign:"center"}},"You lost"),In.createElement(Un,{css:{justifyContent:"space-evenly"}},In.createElement(Gn,{onClick:function(){gn({type:ce.Type.cleanScene,payload:{newPage:o.mainMenu}})}},"Back to main menu"),In.createElement(Gn,{onClick:function(){gn({type:ce.Type.playAgainCustomLevel,payload:{}})}},"Play again")))},na=function(){return In.createElement(Zn,{css:{width:"70%",height:"40%",display:"flex",flexDirection:"column",justifyContent:"space-around"}},In.createElement(Fn,{css:{textAlign:"center"}},"You won"),In.createElement(Un,{css:{justifyContent:"space-evenly"}},In.createElement(Gn,{onClick:function(){gn({type:ce.Type.cleanScene,payload:{newPage:o.mainMenu}})}},"Back to main menu"),In.createElement(Gn,{onClick:function(){gn({type:ce.Type.playAgainCustomLevel,payload:{}})}},"Play again")))};!function(e){e.playerWon="playerWon",e.playerLost="playerLost",e.gameInProgress="gameInProgress"}(jn||(jn={}));var aa=function(){var e=Vn(),t=e&&Te({state:e}),n=e?function(e){var t=Te({state:e});return(null==t?void 0:t.playersQueue.map((function(t){return(0,u.Xr)({state:e,name:a.ai,entity:t})})).filter((function(e){return!!e}))).map((function(e){return{entity:e.entity,color:e.color,active:e.active,human:e.human,hasCurrentTurn:(null==t?void 0:t.currentPlayer)===e.entity,name:e.human?"Player":"Computer"}}))}(e):[],r=(0,In.useState)(!1),o=r[0],i=r[1],s=t&&e?function(e){var t=e.aiList,n=e.game,r=e.state;if(!0===n.gameStarted)return jn.gameInProgress;var o=t.find((function(e){return e.human})),i=n.grid.reduce((function(e,t){var n=(0,u.Xr)({state:r,name:a.box,entity:t});return(null==n?void 0:n.player)===(null==o?void 0:o.entity)?e+1:e}),0);return 0===i||i===n.grid.length?jn.playerLost:jn.gameInProgress}({game:t,aiList:n,state:e}):jn.gameInProgress;return In.createElement(An,{css:{gridTemplateRows:"4rem 1fr",gridTemplateColumns:"1fr 4rem",flex:1}},o&&In.createElement(ea,{onClose:function(){return i(!1)}}),s===jn.playerWon&&In.createElement(na,null),s===jn.playerLost&&In.createElement(ta,null),In.createElement(Un,{css:{gridRow:"1 / 3",gridColumn:"1 / 1"}},In.createElement(Jn,{ai:n})),In.createElement(Gn,{css:{gridRow:"1 / 1",gridColumn:"2 / 2",display:"flex",alignContent:"center",alignItems:"center",padding:"0.75rem"},onClick:function(){i(!0)}},In.createElement(_n,null)))},ra=(0,Bn.zY)({"*":{fontFamily:"Sans-serif",userSelect:"none"},".enable-outline *:focus":{outlineWidth:"10px",outlineStyle:"solid",outlineColor:"$outline"}}),oa=function(e){var t,n=e.state;(0,In.useEffect)((function(){return window.addEventListener("keydown",zn),function(){window.removeEventListener("keydown",zn)}}),[]),(0,In.useEffect)((function(){return window.addEventListener("click",Dn),function(){window.removeEventListener("click",Dn)}}),[]),ra();var a=Vn();switch(null===(t=Te({state:a||n}))||void 0===t?void 0:t.page){case o.mainMenu:return In.createElement(Qn,null);case o.customLevelSettings:return In.createElement($n,null);case o.customLevel:return In.createElement(aa,null);case void 0:return null}},ia=n(7307),sa=(n(2920),n(2031)),la=n(9469),ca=n(3607),ua=n(2587),da=n(5190),fa=document.getElementById("game"),pa="humanPlayer",ma=new ia.D(fa,!0,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1}),ya=new sa.x(ma);ma.runRenderLoop((function(){ya&&ya.activeCamera&&ya.render()}));var va=new la.x("UniversalCamera",new ct.P(0,0,-1),ya);va.mode=ca.V.ORTHOGRAPHIC_CAMERA;var ga=new ua.e("light",new ct.P(0,0,1),ya);ga.intensity=1,ga.diffuse=new Ee.Wo(1,1,1),ga.specular=new Ee.Wo(1,1,1),ga.groundColor=new Ee.Wo(1,1,1),"serviceWorker"in navigator&&(function(e){if("serviceWorker"in navigator){if(new URL(Mn.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t=Mn.env.PUBLIC_URL+"/service-worker.js";kn?(function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ln(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Ln(t,e)}))}}({onUpdate:function(){},onSuccess:function(){}}),navigator.serviceWorker.addEventListener("message",(function(e){return t=void 0,n=void 0,r=function(){var t,n,a,r;return function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(o){switch(o.label){case 0:return"workbox-broadcast-update"!==e.data.meta?[3,4]:(t=e.data.payload,n=t.cacheName,a=t.updatedURL,[4,caches.open(n)]);case 1:return[4,o.sent().match(a)];case 2:return[4,null==(r=o.sent())?void 0:r.text()];case 3:o.sent(),gn({type:ce.Type.showNewVersion,payload:{}}),o.label=4;case 4:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,o){function i(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(i,s)}l((r=r.apply(t,n||[])).next())}));var t,n,a,r})));var ha=function(e){var t=e.scene,n=e.camera,r=e.Vector3,s=(0,Pn.y0)({scene:t,camera:n,Vector3:r,StandardMaterial:wn.K,MeshBuilder:ut.V,Texture:d.x,Color3:Ee.Wo,emitEvent:gn});s=function(e){return(0,c.FI)({state:e,name:a.logo,componentName:a.logo,create:kt,remove:Lt})}(s=function(e){return(0,c.FI)({state:e,name:a.background,componentName:a.background,create:wt,tick:function(e){var t=e.state,n=e.component;if(!t.babylonjs.sceneRef)return t;var a=t.babylonjs.sceneRef.getMeshByUniqueId(parseFloat(xt));return a&&a.material&&(a.material.setFloat("iTime",performance.now()/1e3+n.gradientTime),a.material.setVector2("iResolution",new ct.FM(window.innerWidth,window.innerHeight)),a.material.setFloats("iColors",it.flat())),t}})}(s=function(e){return(0,c.FI)({state:e,name:a.marker,componentName:a.marker,create:function(e){var t=e.state,n=e.component;if(!t.babylonjs.sceneRef)return t;var a=1.4;t=(0,u.we)({state:t,data:Nt.vs({entity:n.entity,position:[9999,9999,9999],scale:[a,a,1]})});var r=Et();return t=(0,u.we)({state:t,data:{entity:n.entity,name:u.fm.material,uniqueId:r,diffuseTexture:zt,diffuseColor:[1,0,1,0]}}),(0,u.we)({state:t,data:{entity:n.entity,name:u.fm.mesh,type:Me.o.plane,uniqueId:r,width:a,height:a,updatable:!1,sideOrientation:0,materialEntity:[n.entity]}})},remove:function(e){var t=e.state;return(0,Xt.Sx)({state:t,entity:Ht})}})}(s=function(e){return(0,c.FI)({state:e,name:a.game,componentName:a.game,create:he})}(s=function(e){return(0,c.FI)({state:e,name:a.ai,componentName:a.ai})}(s=function(e){return(0,c.FI)({state:e,name:a.box,componentName:a.box,create:Cn,remove:En})}(s=hn(s))))))),s=(0,u.we)({state:s,data:{entity:pa,name:a.ai,human:!0,level:i.hard,color:[0,0,1],textureSet:["","","","","","",""],active:!0}});var l=JSON.parse(localStorage.getItem(ft)||"null");return s=(0,u.we)({state:s,data:{version:"0.0.12",page:o.mainMenu,newVersionAvailable:!1,entity:be,name:a.game,moves:0,grid:[],round:0,currentPlayer:pa,gameStarted:!1,playersQueue:[],boxRotationQueue:[],colorBlindMode:(null==l?void 0:l.colorBlindMode)||!1,customLevelSettings:{players:(null==l?void 0:l.players)||gt().slice(0,4),difficulty:(null==l?void 0:l.difficulty)||i.medium,quickStart:(null==l?void 0:l.quickStart)||!0,mapType:(null==l?void 0:l.mapType)||""}}}),t&&(s=(0,u.we)({state:s,data:Sn({entity:Ne.lw,name:u.fm.camera,position:[0,0],distance:5},ht(5,t))})),s=(0,u.we)({state:s,data:{entity:xt,name:a.background,gradientTime:5e4*Math.random()}}),sn({state:s,page:o.mainMenu})}({scene:ya,camera:va,Vector3:ct.P});(function(e){var t=e.state;On.render(In.createElement(In.StrictMode,null,In.createElement(oa,{state:t})),document.getElementById("gameUi"))})({state:ha}),ha.babylonjs.sceneRef&&ha.babylonjs.sceneRef.registerBeforeRender((function(){ha=(0,da.P)({state:ha})})),window.addEventListener("resize",(function(){gn({type:Ne.tP.Type.resize,payload:{}}),ma.resize()}))}},e=>{e.O(0,[216],(()=>(6821,e(e.s=6821)))),e.O()}]);